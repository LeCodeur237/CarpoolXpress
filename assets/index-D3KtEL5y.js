import{_ as e}from"./VButton.vue_vue_type_style_index_0_lang-BOJu42_j.js";import{_ as s}from"./VField.vue_vue_type_script_setup_true_lang-CWrb41Pw.js";import{_ as a}from"./VControl-CsOLD0Mp.js";import{_ as t}from"./VInput.vue_vue_type_script_setup_true_lang-mIaEB-6s.js";import{e as l,t as r,v as o,x as i,y as n,z as u,A as d,B as c,C as p,D as m,E as g,r as h,F as f,G as v,m as _,H as y,I as b,J as x,K as w,L as k}from"./index-DCVzCXGO.js";import{_ as V}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as j}from"./data-CcDN9YvH.js";import{u as C}from"./useNotyf-1WfirvEN.js";import{a as L,u as z}from"./useFetch-DTVXwznz.js";import"./notyf-CueL1e6X.js";const $={class:"txt-title"},A={key:0,class:"sub mt-4"},I=V(l({__name:"AlertText",props:{txt:{default:void 0},sub:{default:void 0},type:{default:"primary"}},setup(e){const s=e;return(e,a)=>(r(),o("p",{class:d(["is-alert_txt",[`is-${s.type}`,s.sub&&"has-sub"]])},[i("span",$,n(s.txt),1),s.sub?(r(),o("span",A,n(s.sub),1)):u("",!0)],2))}}),[["__scopeId","data-v-5fe8e5c3"]]),U=c("loginRessources",(()=>{const e=C(),s=L(),a=z();return{authenticate:async t=>{try{const l=await s("/ConsoleUser/Authentification",{method:"GET",params:t});return l?(a.setLogger(l),e.success("Login successful!"),!0):(e.error("Invalid credentials."),!1)}catch(l){const s=`Authentication failed: ${l.message} - ${l.response?.data?.message}`;return e.error(s),!1}}}})),T={class:"auth-wrapper-inner columns is-gapless"},X=i("div",{class:"column login-column is-8 h-hidden-mobile h-hidden-tablet-p hero-banner",style:{"background-image":'url("/images/monaco.jpg")',"background-size":"cover"}},null,-1),F={class:"column is-4 is-wrapper_elt"},G={class:"hero is-fullheight"},M={class:"hero-heading"},B={class:"switch-wrapper"},D={class:"night-toggle night-toggle--daynight"},E=["checked"],N=i("label",{class:"night-toggle--btn",for:"night-toggle--daynight",tabindex:"0"},[i("span",{class:"night-toggle--feature"})],-1),P={class:"hero-body"},R={class:"container"},S={class:"columns"},q={class:"column is-12 is-center"},H={class:"is-flex is-flex-direction-column is-justify-content-center is-align-items-center"},J=i("img",{src:"/images/Corporate-logo-Main-1-2048x740.png",style:{height:"60px","border-radius":"1rem"},alt:"Carpool Xpress"},null,-1),K=i("h1",{class:"is-font-alt mt-6",style:{"font-weight":"bold","font-size":"2.8rem","font-family":"var(--font-alt)"}}," Carpool Xpress ",-1),W=i("p",null,"Login there !",-1),Y={class:"auth-form-wrapper mt-4"},O={class:"login-form"},Q={key:0,class:"help is-danger"},Z={class:"login"},ee=l({__name:"index",setup(l){const d=p(),c=m(),V=g(),L=U(),$=z(),A=C(),ee=h(!1),se=h(!0),ae=h(""),te=h(V.query?.msg),le=h(j);$.isLoggedIn&&(se.value=!1,c.push("/app/dashboard")),console.log(se.value);const re=async()=>{if(ae.value="",!le.value.email)return A.error("Veuillez entrer une adresse e-mail."),!1;if(!le.value.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))return A.error("Veuillez entrer une adresse e-mail valide."),!1;if(!le.value.password)return A.error("Le mot de passe est obligatoire."),!1;ee.value=!0;try{await L.authenticate(le.value)&&c.push("/app/dashboard")}catch(e){return ae.value=`Une erreur s'est produite lors de la connexion.${e.message} - ${e.response?.data?.message}`,A.error(ae.value),!1}finally{ee.value=!1}};return f({title:"Auth Login - Carpool Xpress"}),(l,c)=>{const p=v("RouterLink"),m=I,g=t,h=a,f=s,V=e;return r(),o("div",T,[X,i("div",F,[i("div",G,[i("div",M,[i("div",B,[i("div",D,[i("input",{id:"night-toggle--daynight","data-cy":"dark-mode-toggle",type:"checkbox",class:"night-toggle--checkbox",checked:!_(d).isDark,"aria-label":"Toggle dark mode",onChange:c[0]||(c[0]=(...e)=>_(d).onChange&&_(d).onChange(...e))},null,40,E),N])])]),i("div",P,[i("div",R,[i("div",S,[i("div",q,[i("div",H,[y(p,{to:"/",class:"header-item"},{default:b((()=>[J])),_:1}),K,_(te)?(r(),x(m,{key:0,txt:_(te),sub:"Veuillez vous connecter pour acceder aux pages demandees",class:"my-4"},null,8,["txt"])):u("",!0),W]),i("div",Y,[_(ae)?(r(),x(m,{key:0,txt:_(ae),class:"mb-4"},null,8,["txt"])):u("",!0),i("form",{style:{width:"90%",margin:"auto"},onSubmit:w(re,["prevent"])},[i("div",O,[y(f,null,{default:b((()=>[y(h,{icon:"feather:mail"},{default:b((()=>[y(g,{modelValue:_(le).email,"onUpdate:modelValue":c[1]||(c[1]=e=>_(le).email=e),type:"text",placeholder:"Pseudo or email-address"},null,8,["modelValue"])])),_:1})])),_:1}),y(f,{id:"password"},{default:b((({field:e})=>[y(h,{icon:"feather:lock"},{default:b((()=>[y(g,{modelValue:_(le).password,"onUpdate:modelValue":c[2]||(c[2]=e=>_(le).password=e),type:"password",placeholder:"Password",autocomplete:"current-password"},null,8,["modelValue"]),e?.errorMessage?(r(),o("p",Q,n(e.errorMessage),1)):u("",!0)])),_:2},1024)])),_:1}),i("div",Z,[y(V,{loading:_(ee),color:"warning",type:"submit",bold:"",fullwidth:"",raised:""},{default:b((()=>[k(" Login ")])),_:1},8,["loading"])])])],32)])])])])])])])])}}});export{ee as default};
