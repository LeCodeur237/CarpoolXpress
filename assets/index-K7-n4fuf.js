import{_ as e}from"./VButton.vue_vue_type_style_index_0_lang-B-ef5zKO.js";import{_ as s}from"./VField.vue_vue_type_script_setup_true_lang-jWif5Yex.js";import{_ as a}from"./VControl-CBcic6uR.js";import{_ as t}from"./VInput.vue_vue_type_script_setup_true_lang-C64DPPCo.js";import{e as r,t as l,v as o,x as i,y as n,z as u,A as d,B as c,C as p,D as m,E as g,r as h,F as f,G as v,m as _,H as y,I as b,J as x,K as w,L as k}from"./index-t9U-pc91.js";import{_ as V}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as j}from"./Corporate-logo-Main-1-2048x740-Bh6N2_UN.js";import{_ as C}from"./data-CuoDe91C.js";import{u as L}from"./useNotyf-CMZ2FBRq.js";import{a as z,u as A}from"./useFetch-r6-7WS48.js";import"./notyf-YfXYPISH.js";const $={class:"txt-title"},I={key:0,class:"sub mt-4"},U=V(r({__name:"AlertText",props:{txt:{default:void 0},sub:{default:void 0},type:{default:"primary"}},setup(e){const s=e;return(e,a)=>(l(),o("p",{class:d(["is-alert_txt",[`is-${s.type}`,s.sub&&"has-sub"]])},[i("span",$,n(s.txt),1),s.sub?(l(),o("span",I,n(s.sub),1)):u("",!0)],2))}}),[["__scopeId","data-v-5fe8e5c3"]]),T=c("loginRessources",(()=>{const e=L(),s=z(),a=A();return{authenticate:async t=>{try{const r=await s("/ConsoleUser/Authentification",{method:"GET",params:t});return r?!0===r.isActive?(a.setLogger(r),e.success("Login successful!"),!0):(e.error("Your account is inactive."),!1):(e.error("Invalid credentials."),!1)}catch(r){const s=`Authentication failed: ${r.message} - ${r.response?.data?.message}`;return e.error(s),!1}}}})),X={class:"auth-wrapper-inner columns is-gapless"},F=i("div",{class:"column login-column is-8 h-hidden-mobile h-hidden-tablet-p hero-banner",style:{"background-image":'url("/images/monaco.jpg")',"background-size":"cover"}},null,-1),M={class:"column is-4 is-wrapper_elt"},B={class:"hero is-fullheight"},D={class:"hero-heading"},E={class:"switch-wrapper"},G={class:"night-toggle night-toggle--daynight"},H=["checked"],P=i("label",{class:"night-toggle--btn",for:"night-toggle--daynight",tabindex:"0"},[i("span",{class:"night-toggle--feature"})],-1),R={class:"hero-body"},Y={class:"container"},q={class:"columns"},J={class:"column is-12 is-center"},K={class:"is-flex is-flex-direction-column is-justify-content-center is-align-items-center"},N=i("img",{src:j,style:{height:"60px","border-radius":"1rem"},alt:"Carpool Xpress"},null,-1),O=i("h1",{class:"is-font-alt mt-6",style:{"font-weight":"bold","font-size":"2.8rem","font-family":"var(--font-alt)"}}," Carpool Xpress ",-1),S=i("p",null,"Login there !",-1),W={class:"auth-form-wrapper mt-4"},Z={class:"login-form"},Q={key:0,class:"help is-danger"},ee={class:"login"},se=r({__name:"index",setup(r){const d=p(),c=m(),V=g(),j=T(),z=A(),$=L(),I=h(!1),se=h(!0),ae=h(""),te=h(V.query?.msg),re=h(C);z.isLoggedIn&&(se.value=!1,c.push("/app/dashboard"));const le=async()=>{if(ae.value="",!re.value.email)return $.error("Veuillez entrer une adresse e-mail."),!1;if(!re.value.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))return $.error("Veuillez entrer une adresse e-mail valide."),!1;if(!re.value.password)return $.error("Le mot de passe est obligatoire."),!1;I.value=!0;try{await j.authenticate(re.value)&&c.push("/app/dashboard")}catch(e){return ae.value=`Une erreur s'est produite lors de la connexion.${e.message} - ${e.response?.data?.message}`,$.error(ae.value),!1}finally{I.value=!1}};return f({title:"Auth Login - Carpool Xpress"}),(r,c)=>{const p=v("RouterLink"),m=U,g=t,h=a,f=s,V=e;return l(),o("div",X,[F,i("div",M,[i("div",B,[i("div",D,[i("div",E,[i("div",G,[i("input",{id:"night-toggle--daynight","data-cy":"dark-mode-toggle",type:"checkbox",class:"night-toggle--checkbox",checked:!_(d).isDark,"aria-label":"Toggle dark mode",onChange:c[0]||(c[0]=(...e)=>_(d).onChange&&_(d).onChange(...e))},null,40,H),P])])]),i("div",R,[i("div",Y,[i("div",q,[i("div",J,[i("div",K,[y(p,{to:"/",class:"header-item"},{default:b((()=>[N])),_:1}),O,_(te)?(l(),x(m,{key:0,txt:_(te),sub:"Veuillez vous connecter pour acceder aux pages demandees",class:"my-4"},null,8,["txt"])):u("",!0),S]),i("div",W,[_(ae)?(l(),x(m,{key:0,txt:_(ae),class:"mb-4"},null,8,["txt"])):u("",!0),i("form",{style:{width:"90%",margin:"auto"},onSubmit:w(le,["prevent"])},[i("div",Z,[y(f,null,{default:b((()=>[y(h,{icon:"feather:mail"},{default:b((()=>[y(g,{modelValue:_(re).email,"onUpdate:modelValue":c[1]||(c[1]=e=>_(re).email=e),type:"text",placeholder:"Pseudo or email-address"},null,8,["modelValue"])])),_:1})])),_:1}),y(f,{id:"password"},{default:b((({field:e})=>[y(h,{icon:"feather:lock"},{default:b((()=>[y(g,{modelValue:_(re).password,"onUpdate:modelValue":c[2]||(c[2]=e=>_(re).password=e),type:"password",placeholder:"Password",autocomplete:"current-password"},null,8,["modelValue"]),e?.errorMessage?(l(),o("p",Q,n(e.errorMessage),1)):u("",!0)])),_:2},1024)])),_:1}),i("div",ee,[y(V,{loading:_(I),color:"warning",type:"submit",bold:"",fullwidth:"",raised:""},{default:b((()=>[k(" Login ")])),_:1},8,["loading"])])])],32)])])])])])])])])}}});export{se as default};
