import{_ as e}from"./VButton.vue_vue_type_style_index_0_lang-ChQG4uz7.js";import{_ as s}from"./VField.vue_vue_type_script_setup_true_lang-DaS4v5xb.js";import{_ as a}from"./VControl-p2ZM4MbM.js";import{_ as t}from"./VInput.vue_vue_type_script_setup_true_lang-DScCmNrG.js";import{e as r,t as l,v as o,x as i,y as n,z as u,A as d,B as c,C as p,D as m,E as g,r as h,F as f,G as v,m as _,H as y,I as b,J as x,K as w,L as k}from"./index-BmU4ZD6R.js";import{_ as V}from"./_plugin-vue_export-helper-BCo6x5W8.js";import{_ as j}from"./data-vh7Bnkft.js";import{u as C}from"./useNotyf-C4Q0if2M.js";import{a as L,u as z}from"./useFetch-BNEmLZ4H.js";import"./notyf-CBduEkA9.js";const A={class:"txt-title"},$={key:0,class:"sub mt-4"},I=V(r({__name:"AlertText",props:{txt:{default:void 0},sub:{default:void 0},type:{default:"primary"}},setup(e){const s=e;return(e,a)=>(l(),o("p",{class:d(["is-alert_txt",[`is-${s.type}`,s.sub&&"has-sub"]])},[i("span",A,n(s.txt),1),s.sub?(l(),o("span",$,n(s.sub),1)):u("",!0)],2))}}),[["__scopeId","data-v-5fe8e5c3"]]),U=c("loginRessources",(()=>{const e=C(),s=L(),a=z();return{authenticate:async t=>{try{const r=await s("/ConsoleUser/Authentification",{method:"GET",params:t});return r?!0===r.isActive?(a.setLogger(r),e.success("Login successful!"),!0):(e.error("Your account is inactive."),!1):(e.error("Invalid credentials."),!1)}catch(r){const s=`Authentication failed: ${r.message} - ${r.response?.data?.message}`;return e.error(s),!1}}}})),T={class:"auth-wrapper-inner columns is-gapless"},X=i("div",{class:"column login-column is-8 h-hidden-mobile h-hidden-tablet-p hero-banner",style:{"background-image":'url("/images/monaco.jpg")',"background-size":"cover"}},null,-1),F={class:"column is-4 is-wrapper_elt"},G={class:"hero is-fullheight"},M={class:"hero-heading"},B={class:"switch-wrapper"},D={class:"night-toggle night-toggle--daynight"},E=["checked"],N=i("label",{class:"night-toggle--btn",for:"night-toggle--daynight",tabindex:"0"},[i("span",{class:"night-toggle--feature"})],-1),P={class:"hero-body"},R={class:"container"},S={class:"columns"},Y={class:"column is-12 is-center"},q={class:"is-flex is-flex-direction-column is-justify-content-center is-align-items-center"},H=i("img",{src:"/images/Corporate-logo-Main-1-2048x740.png",style:{height:"60px","border-radius":"1rem"},alt:"Carpool Xpress"},null,-1),J=i("h1",{class:"is-font-alt mt-6",style:{"font-weight":"bold","font-size":"2.8rem","font-family":"var(--font-alt)"}}," Carpool Xpress ",-1),K=i("p",null,"Login there !",-1),W={class:"auth-form-wrapper mt-4"},O={class:"login-form"},Q={key:0,class:"help is-danger"},Z={class:"login"},ee=r({__name:"index",setup(r){const d=p(),c=m(),V=g(),L=U(),A=z(),$=C(),ee=h(!1),se=h(!0),ae=h(""),te=h(V.query?.msg),re=h(j);A.isLoggedIn&&(se.value=!1,c.push("/app/dashboard"));const le=async()=>{if(ae.value="",!re.value.email)return $.error("Veuillez entrer une adresse e-mail."),!1;if(!re.value.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/))return $.error("Veuillez entrer une adresse e-mail valide."),!1;if(!re.value.password)return $.error("Le mot de passe est obligatoire."),!1;ee.value=!0;try{await L.authenticate(re.value)&&c.push("/app/dashboard")}catch(e){return ae.value=`Une erreur s'est produite lors de la connexion.${e.message} - ${e.response?.data?.message}`,$.error(ae.value),!1}finally{ee.value=!1}};return f({title:"Auth Login - Carpool Xpress"}),(r,c)=>{const p=v("RouterLink"),m=I,g=t,h=a,f=s,V=e;return l(),o("div",T,[X,i("div",F,[i("div",G,[i("div",M,[i("div",B,[i("div",D,[i("input",{id:"night-toggle--daynight","data-cy":"dark-mode-toggle",type:"checkbox",class:"night-toggle--checkbox",checked:!_(d).isDark,"aria-label":"Toggle dark mode",onChange:c[0]||(c[0]=(...e)=>_(d).onChange&&_(d).onChange(...e))},null,40,E),N])])]),i("div",P,[i("div",R,[i("div",S,[i("div",Y,[i("div",q,[y(p,{to:"/",class:"header-item"},{default:b((()=>[H])),_:1}),J,_(te)?(l(),x(m,{key:0,txt:_(te),sub:"Veuillez vous connecter pour acceder aux pages demandees",class:"my-4"},null,8,["txt"])):u("",!0),K]),i("div",W,[_(ae)?(l(),x(m,{key:0,txt:_(ae),class:"mb-4"},null,8,["txt"])):u("",!0),i("form",{style:{width:"90%",margin:"auto"},onSubmit:w(le,["prevent"])},[i("div",O,[y(f,null,{default:b((()=>[y(h,{icon:"feather:mail"},{default:b((()=>[y(g,{modelValue:_(re).email,"onUpdate:modelValue":c[1]||(c[1]=e=>_(re).email=e),type:"text",placeholder:"Pseudo or email-address"},null,8,["modelValue"])])),_:1})])),_:1}),y(f,{id:"password"},{default:b((({field:e})=>[y(h,{icon:"feather:lock"},{default:b((()=>[y(g,{modelValue:_(re).password,"onUpdate:modelValue":c[2]||(c[2]=e=>_(re).password=e),type:"password",placeholder:"Password",autocomplete:"current-password"},null,8,["modelValue"]),e?.errorMessage?(l(),o("p",Q,n(e.errorMessage),1)):u("",!0)])),_:2},1024)])),_:1}),i("div",Z,[y(V,{loading:_(ee),color:"warning",type:"submit",bold:"",fullwidth:"",raised:""},{default:b((()=>[k(" Login ")])),_:1},8,["loading"])])])],32)])])])])])])])])}}});export{ee as default};
