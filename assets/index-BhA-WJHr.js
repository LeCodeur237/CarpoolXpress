import{_ as e}from"./VLoader.vue_vue_type_style_index_0_lang-z6CWX0dI.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-DRRY7dtM.js";import{_ as s}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-B_FLCEd8.js";import{_ as i}from"./VButton.vue_vue_type_style_index_0_lang-BOJu42_j.js";import{e as l,r as a,Q as r,o as n,t as o,v as d,x as u,Y as c,a4 as m,m as h,j as y,R as v,S as p,H as _,I as f,A as g,y as w,L as P,J as x}from"./index-DCVzCXGO.js";import{_ as b,a as j}from"./search-1-dark-DV4mRi9_.js";import{u as D}from"./viewWrapper-B2fmsTqy.js";import{u as R}from"./defaultResource-BKcbMEp6.js";import{_ as k}from"./VTag.vue_vue_type_style_index_0_lang-EAZmVvoA.js";import{f as C}from"./common-CvuSpKng.js";import{D as z}from"./datetime-xmklhC0O.js";import{b as N}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useNotyf-1WfirvEN.js";import"./notyf-CueL1e6X.js";import"./useFetch-DTVXwznz.js";const S={class:"list-view-toolbar"},I={class:"search-widget",style:{width:"300px"}},A={class:"field"},E={class:"control"},F=["disabled"],O=[u("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:search"},null,-1)],T={class:"is-profile_tabs"},V=["onClick"],U={class:"buttons"},J={class:"page-content-inner"},L=u("img",{class:"light-image",src:b,alt:""},null,-1),M=u("img",{class:"dark-image",src:j,alt:""},null,-1),W={key:1,class:"is-list_view"},Y=u("div",{class:"is-list_header"},[u("div",{class:"is-list_header-item",style:{width:"15%"}},"Driver"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"Itinerary"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"DateTime"),u("div",{class:"is-list_header-item",style:{width:"5%"}},"Nbr"),u("div",{class:"is-list_header-item",style:{width:"5%"}},"Type"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"PU"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"PT"),u("div",{class:"is-list_header-item",style:{width:"5%"}},"Canc?"),u("div",{class:"is-list_header-item",style:{width:"5%"}},"Paid?"),u("div",{class:"is-list_header-item",style:{width:"5%"}},"Fund?"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"Profit"),u("div",{class:"is-list_header-item",style:{width:"10%"}},"Due Date")],-1),$={class:"is-list_line-item is-user",style:{width:"15%"}},B={class:"is-user_metadata"},G={class:"has-text-primary is-underlined"},H={class:"is-list_line-item",style:{width:"10%"}},Q={class:"is-list_line-item",style:{width:"10%"}},q={class:"is-list_line-item",style:{width:"5%"}},K={class:"is-list_line-item",style:{width:"5%"}},X={style:{"font-size":"0.75rem"}},Z={class:"is-list_line-item",style:{width:"10%"}},ee={style:{"font-size":"0.85rem"}},te={class:"is-list_line-item",style:{width:"10%"}},se={style:{"font-size":"0.85rem"}},ie={class:"is-list_line-item",style:{width:"5%"}},le={style:{"font-size":"0.75rem"}},ae={class:"is-list_line-item",style:{width:"5%"}},re=u("small",{style:{"font-size":"0.75rem"}},"soon",-1),ne={class:"is-list_line-item",style:{width:"5%"}},oe=u("small",{style:{"font-size":"0.75rem"}},"soon",-1),de={class:"is-list_line-item",style:{width:"10%"}},ue={style:{"font-size":"0.85rem"}},ce={class:"is-list_line-item",style:{width:"10%"}},me=l({__name:"index",setup(l){const b=D(),j=R(),N=["All","Pending","Completed","Canceled"],me=a(""),he=a(!1);a("list");const ye=a({currentPage:1,perPage:9,total:0}),ve=a("All"),pe=a([]),_e=e=>{const t=z.fromISO(e).plus({hours:6});return z.now()>t},fe=e=>{ye.value.currentPage=e},ge=r((()=>{let e=pe.value.filter((e=>e.user)).filter((e=>"All"===ve.value||("Pending"===ve.value?"1"===e.status&&!_e(e.travelingDate):"Completed"===ve.value?"2"===e.status||_e(e.travelingDate):"Canceled"===ve.value?"0"===e.status:void 0)));!me.value||me.value.length<1||(e=e.filter((e=>e.user?.userDetail?.firstName?.match(new RegExp(me.value,"i"))||e.user?.userDetail?.lastName?.match(new RegExp(me.value,"i"))||e.user?.email?.match(new RegExp(me.value,"i"))||e.departurePoint?.city?.match(new RegExp(me.value,"i"))||e.departurePoint?.address?.match(new RegExp(me.value,"i"))||e.destinationPoint?.city?.match(new RegExp(me.value,"i"))||e.destinationPoint?.address?.match(new RegExp(me.value,"i"))))),ye.value.total=e.length;const t=(ye.value.currentPage-1)*ye.value.perPage,s=t+ye.value.perPage;return e.slice(t,s)})),we=e=>e.listOfReservations?C(e.listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,t)=>e+t.totalAmount),0)):C(0);return n((async()=>{b.setPageTitle("List of Journeys"),await(async()=>{try{he.value=!0;const e=await j.list("/DriverJourney/GetAllJourney");if(ye.value.total=e.length,e){const t=await Promise.all(e.map((async e=>{const t=await j.list(`/User/FindUserById?userid=${e.userId}`);return{...e,user:t}})));pe.value=t}}catch(e){console.error("An error has occurred: ",e)}finally{he.value=!1}})()})),(l,a)=>{const r=i,n=s,b=t,j=e;return o(),d("div",null,[u("div",S,[u("div",I,[u("div",A,[u("div",E,[c(u("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>y(me)?me.value=e:null),type:"text",class:"input",placeholder:"Rechercher..."},null,512),[[m,h(me)]]),u("button",{class:"search-button",disabled:h(me).length<1},O,8,F)])])]),u("ul",T,[(o(),d(v,null,p(N,((e,t)=>u("li",{key:t,class:g([e===h(ve)&&"is-active_tab","is-p_tab"]),onClick:t=>ve.value=e},w(e),11,V))),64))]),u("div",U,[_(r,{color:"primary",icon:"feather:refresh-ccw",elevated:"",rounded:""},{default:f((()=>[P(" Refresh ")])),_:1})])]),_(j,{active:h(he)},{default:f((()=>[u("div",J,[0===h(ge).length?(o(),x(n,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\r\n              filter terms you've entered. Please try different filter terms or\r\n              criteria.",larger:""},{image:f((()=>[L,M])),_:1})):(o(),d("div",W,[Y,(o(!0),d(v,null,p(h(ge),(e=>(o(),d("div",{key:e.id,class:"is-list_line"},[u("div",$,[u("div",B,[u("h3",null,w(`${e.user?.userDetail?.lastName} ${e.user?.userDetail?.firstName}`),1),u("p",null,w(e.user?.email),1),u("p",G,w(e.user?.phoneNumber),1)])]),u("div",H,[u("p",null,"from "+w(e?.departurePoint?.city??"City"),1),u("p",null,"to "+w(e?.destinationPoint?.city??"City"),1)]),u("div",Q,[u("p",null,w(h(z).fromISO(e.travelingDate).toFormat("dd/MM/yy")),1),u("p",null,[u("small",null,[u("b",null,w(h(z).fromISO(e.travelingDate).toFormat("hh:mm a")),1)])])]),u("div",q,[u("span",null,w(e.maxSeats-e.avalableSeets),1)]),u("div",K,[_(k,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:e.isPaiementCash?"success":"info"},{default:f((()=>[u("small",X,w(e.isPaiementCash?"cash":"in-app"),1)])),_:2},1032,["color"])]),u("div",Z,[u("b",ee,w(h(C)(e.amountPerSeet)),1)]),u("div",te,[u("b",se,w(we(e)),1)]),u("div",ie,[_(k,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"1"===e.status?"success":"warning"},{default:f((()=>[u("small",le,w("1"===e.status?"No":"Yes"),1)])),_:2},1032,["color"])]),u("div",ae,[_(k,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"warning"},{default:f((()=>[re])),_:1})]),u("div",ne,[_(k,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"warning"},{default:f((()=>[oe])),_:1})]),u("div",de,[u("b",ue,w(we(e)),1)]),u("div",ce,[u("p",null,[u("b",null,w(h(z).fromISO(e.travelingDate).plus({days:5}).toFormat("dd/MM/yy")),1)])])])))),128))])),_(b,{"current-page":h(ye).currentPage,"onUpdate:currentPage":[a[1]||(a[1]=e=>h(ye).currentPage=e),fe],"item-per-page":h(ye).perPage,"total-items":h(ye).total,"max-links-displayed":7,"no-router":""},null,8,["current-page","item-per-page","total-items"])])])),_:1},8,["active"])])}}});"function"==typeof N&&N(me);export{me as default};
