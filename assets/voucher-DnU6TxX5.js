import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-BltQe-xz.js";import{c as l,_ as a,a as t,v as s,b as o,d as i}from"./v4-BJchhVAI.js";import{_ as r}from"./VIcon.vue_vue_type_script_setup_true_lang-BPVH29wv.js";import{_ as u}from"./VLoader.vue_vue_type_style_index_0_lang-C7-GgvIg.js";import{_ as n}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-DSmAfiUP.js";import{_ as c,a as d}from"./VOption.vue_vue_type_style_index_0_lang-DriEITPH.js";import{_ as v}from"./VInput.vue_vue_type_script_setup_true_lang-C64DPPCo.js";import{_ as p}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-Cw9ZBBgT.js";import{a as m,_ as f}from"./VFlexTable.vue_vue_type_style_index_0_lang-B05RnJ2_.js";import{_ as y}from"./VIconButton-CtCxSKsr.js";import{_ as g}from"./VTag.vue_vue_type_style_index_0_lang-CfiYdP3K.js";import{_}from"./VAvatarStack.vue_vue_type_script_setup_true_lang-ENDlJGik.js";import{_ as h}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-DK1cPkHB.js";import{_ as b}from"./VButtons.vue_vue_type_script_setup_true_lang-m0U9ppn7.js";import{_ as C}from"./VButton.vue_vue_type_style_index_0_lang-B-ef5zKO.js";import{_ as k}from"./VField.vue_vue_type_script_setup_true_lang-jWif5Yex.js";import{_ as x}from"./VControl-CBcic6uR.js";import{e as D,D as w,r as V,f as U,Q as P,o as N,w as L,G as A,t as S,J as E,I as T,x as j,H as F,Y as I,a4 as O,L as $,z as M,A as z,v as q,S as R,y as B,R as J,a7 as G,ar as H,a5 as W,K}from"./index-t9U-pc91.js";import{u as Q}from"./viewWrapper-Yjs2_JvI.js";import{u as X}from"./defaultResource-C1sSR1bb.js";import{D as Y}from"./datetime-xmklhC0O.js";import{u as Z}from"./useNotyf-CMZ2FBRq.js";import{b as ee}from"./route-block-B_A1xBdJ.js";import"./VFlex.vue_vue_type_style_index_0_lang-C5rz8FA7.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./VAvatar.vue_vue_type_style_index_0_lang-Bxz39T17.js";import"./useFetch-r6-7WS48.js";import"./notyf-YfXYPISH.js";const le={style:{"margin-top":"1rem","margin-bottom":"4rem"}},ae={class:"list-flex-toolbar flex-list-v1"},te={class:"page-content-inner",style:{"margin-top":"5rem"}},se={class:"flex-list-wrapper flex-list-v1"},oe=j("img",{class:"light-image",src:a,alt:"",style:{"max-width":"280px"}},null,-1),ie=j("img",{class:"dark-image",src:t,alt:"",style:{"max-width":"280px"}},null,-1),re={class:"item-name dark-inverted"},ue={key:1,class:"light-text"},ne={key:2,class:"light-text"},ce={class:"light-text"},de={class:"light-text"},ve=j("br",null,null,-1),pe={class:"modal-form"},me={class:"modal-nav"},fe=j("h3",{class:"modal-step-title"}," Coupon Information ",-1),ye={class:"columns is-multiline"},ge={class:"column is-6"},_e={class:"column is-6"},he={class:"modal-nav"},be=j("h3",{class:"modal-step-title"}," Select Users (Passengers) ",-1),Ce={class:"row mt-4"},ke={class:"col-12 mb-4"},xe={class:"userSelection"},De=j("p",null,"Available Passengers:",-1),we={key:0,class:"list-placeholder"},Ve={key:1,class:"list-placeholder"},Ue=["onClick"],Pe={key:3,class:"list-placeholder"},Ne={class:"col-12"},Le={class:"userSelection"},Ae={class:"userlist scrollable-list selected-items-list"},Se={key:0,class:"list-placeholder"},Ee={class:"modal-nav"},Te=j("h3",{class:"modal-step-title"}," Select Drivers ",-1),je={class:"row mt-4"},Fe={class:"col-12"},Ie={class:"userSelection"},Oe=j("p",null,"Available Drivers:",-1),$e={key:0,class:"list-placeholder"},Me={key:1,class:"list-placeholder"},ze=["onClick"],qe={key:3,class:"list-placeholder"},Re={class:"col-12"},Be={class:"userSelection"},Je={class:"userlist scrollable-list selected-items-list"},Ge={key:0,class:"list-placeholder"},He={class:"modal-nav"},We=j("h3",{class:"modal-step-title"}," Select Applicable Trip Locations ",-1),Ke=j("div",{style:{width:"40px"}},null,-1),Qe={class:"rower mt-4"},Xe={class:"col-6"},Ye={class:"userSelection"},Ze=j("p",null,"Departure Towns/Cities:",-1),el={key:0,class:"list-placeholder"},ll=["onClick"],al={class:"userSelection mt-4"},tl={class:"userlist selected-items-list",style:{height:"60px"}},sl={key:0,class:"list-placeholder"},ol={class:"col-6"},il={class:"userSelection"},rl=j("p",null,"Destination Towns/Cities:",-1),ul={key:0,class:"list-placeholder"},nl=["onClick"],cl={class:"userSelection mt-4"},dl={class:"userlist selected-items-list",style:{height:"60px"}},vl={key:0,class:"list-placeholder"},pl={class:"col-6",style:{"margin-top":"1rem"}},ml={class:"col-14"},fl=j("h1",null,"List of trips",-1),yl={class:"userlist scrollable-list"},gl={key:0,class:"list-placeholder"},_l=j("b",null,"Departure : ",-1),hl=j("b",null,"Destination : ",-1),bl=j("p",{class:"help is-info mt-4 has-text-centered"},[$(" The coupon will apply if the trip starts in a selected departure location "),j("b",null,"OR"),$(" ends in a selected destination location. Leave a list empty to not restrict by it. ")],-1),Cl=D({__name:"voucher",setup(a){const t=Q(),D=X(),ee=Z(),Cl=w(),kl=V(""),xl=V([]),Dl=V(!1),wl=V(!1),Vl=V(!1),Ul=V(!1),Pl=V({page:1,itemsPerPage:5,totalItems:0,totalPages:0}),Nl=V("index"),Ll=V([]),Al=V([]),Sl=V(!1),El=V([...l].sort()),Tl=V(""),jl=V(""),Fl=V(""),Il=V(""),Ol=V([]),$l=V([]),Ml=V([]),zl=V([]),ql=V([]),Rl=U({couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Bl=P((()=>{const e=Tl.value.toLowerCase().trim();return e?Ll.value.filter((l=>(l.email??"").toLowerCase().includes(e))):Ll.value})),Jl=P((()=>{const e=jl.value.toLowerCase().trim();return e?Al.value.filter((l=>(l.email??"").toLowerCase().includes(e))):Al.value})),Gl=P((()=>{if(!kl.value)return xl.value;const e=kl.value.toLowerCase().trim();return e?xl.value.filter((l=>l.couponCode?.toLowerCase().includes(e)||l.description?.toLowerCase().includes(e)||l.discount.toString().includes(e))):xl.value})),Hl=P((()=>{const e=Fl.value.toLowerCase().trim();return e?El.value.filter((l=>l.toLowerCase().includes(e))):El.value})),Wl=P((()=>{const e=Il.value.toLowerCase().trim();return e?El.value.filter((l=>l.toLowerCase().includes(e))):El.value})),Kl=()=>{Object.assign(Rl,{couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Ol.value=[],$l.value=[],Ml.value=[],zl.value=[],Tl.value="",jl.value="",Fl.value="",Il.value="",Nl.value="index"},Ql=()=>{Kl(),Dl.value=!0},Xl=()=>{Dl.value=!1,Kl()},Yl=e=>{"userlist"===e&&Tl.value.trim()&&0===Ll.value.length?Zl(Tl.value.trim()):"driverlist"===e&&jl.value.trim()&&0===Al.value.length&&Zl(jl.value.trim()),Nl.value=e},Zl=async e=>{if(!e.trim())return Ll.value=[],void(Al.value=[]);if(!Sl.value){Sl.value=!0;try{const l=await D.find("/User",`FindListOfUsersByEmail?email=${encodeURIComponent(e.trim())}`);l&&Array.isArray(l)?(Ll.value=l,Al.value=l):(ee.warning("Could not fetch user/driver list for selection."),Ll.value=[],Al.value=[])}catch(l){console.error("Error fetching data for select inputs:",l),ee.error("Could not load data needed for coupon targeting."),Ll.value=[],Al.value=[]}finally{Sl.value=!1}}},ea=((e,l)=>{let a;return(...t)=>{clearTimeout(a),a=setTimeout((()=>e(...t)),l)}})(Zl,500),la=async()=>{Vl.value=!0;try{if(!Rl.couponCode.trim()||!Rl.description.trim()||Rl.discount<=0)return ee.error("Please fill in code, description, and provide a valid positive discount."),void(Vl.value=!1);if(!Rl.startDate||!Rl.endDate)return ee.error("Please select both start and end dates."),void(Vl.value=!1);if(Rl.startDate>=Rl.endDate)return ee.error("End date must be after start date."),void(Vl.value=!1);if(Rl.maxNumberOfUsePerUser<=0||Rl.maxNumberOfUse<=0)return ee.error("Usage limits must be positive numbers."),void(Vl.value=!1);if(!Rl.isForEverybody&&0===Ol.value.length&&0===$l.value.length)return ee.error("Please select at least one user, driver, or trip when not applying to everybody."),void(Vl.value=!1);const e={couponCode:Rl.couponCode.trim(),description:Rl.description.trim(),isDiscountPourcentage:Rl.isDiscountPourcentage,...Rl.isDiscountPourcentage?{discount:Rl.discount/100}:{discount:Rl.discount},startDate:Rl.startDate,endDate:Rl.endDate,maxNumberOfUsePerUser:Rl.maxNumberOfUsePerUser,maxNumberOfUse:Rl.maxNumberOfUse,isForEverybody:Rl.isForEverybody,...Rl.isForEverybody?{userList:[],driverEmailList:[],couponTripList:[],passengerEmailList:[]}:{userList:Ol.value,driverEmailList:$l.value,couponTripList:ql.value,passengerEmailList:[]}},l=await D.add("/Coupon/CreateCoupon",e);l?(ee.success(`Coupon "${Rl.couponCode}" created successfully!`),Pl.value.page=1,await aa(),Xl()):(ee.error("Failed to create coupon. API response indicated failure."),console.warn("Coupon creation API call returned falsy or unexpected response:",l))}catch(e){console.error("Error creating coupon:",e);const l=e?.response?.data?.errors?JSON.stringify(e.response.data.errors):e?.response?.data?.message||e.message||"Unknown error";ee.error(`Failed to create coupon: ${l}`)}finally{Vl.value=!1}},aa=async()=>{wl.value=!0;try{const e=`/Coupon/GetAllCoupon?pageNumber=${Pl.value.page}&pageSize=${Pl.value.itemsPerPage}`,l=await D.list(e,!0);l&&Array.isArray(l.data)?(xl.value=l.data,Pl.value.totalItems=l.total,Pl.value.totalPages=Math.ceil(l.total/Pl.value.itemsPerPage)):(xl.value=[],Pl.value.totalItems=0,Pl.value.totalPages=0,console.warn("Received invalid response for coupons:",l),ee.warning("Could not fetch coupons or data format is incorrect."))}catch(e){console.error("Error fetching coupons:",e),ee.error(`Failed to load coupons: ${e.message||"Unknown error"}`),xl.value=[],Pl.value.totalItems=0,Pl.value.totalPages=0}finally{wl.value=!1}},ta=async e=>{Pl.value.page=e,await aa()},sa=e=>{if(!e)return"N/A";try{const l=e instanceof Date?Y.fromJSDate(e):Y.fromISO(e);return l.isValid?l.toFormat("dd MMM yyyy"):"Invalid Date"}catch(l){return console.warn("Date formatting error:",l),"Invalid Date"}};N((async()=>{t.setPageTitle("Voucher & Coupons"),await aa()})),L((()=>Rl.isForEverybody),(e=>{e&&(Ol.value=[],$l.value=[],Ml.value=[],zl.value=[],Nl.value="index")})),L(Tl,(e=>{e.trim().length>0?ea(e.trim()):Ll.value=[]})),L(jl,(e=>{e.trim().length>0?ea(e.trim()):Al.value=[]}));const oa={couponCode:{label:"Coupon code",grow:!0,sortable:!0},appliesTo:{label:"Applies To",align:"center"},discount:{label:"Discount",align:"center"},dates:{label:"Validity",align:"center"},status:{label:"Status",align:"center"},actions:{label:"Actions",align:"end"}};return(l,a)=>{const t=x,w=k,V=C,U=b,P=h,N=m,L=_,Q=g,X=y,Y=A("Tippy"),Z=f,xl=p,Ll=v,Al=c,El=d,Kl=o,Zl=n,ea=u,ia=r,ra=i,ua=e;return S(),E(ea,{size:"xl",active:wl.value&&!Vl.value,class:"full-height",overlay:!0},{default:T((()=>[j("div",le,[j("div",ae,[F(w,null,{default:T((()=>[F(t,{icon:"feather:search"},{default:T((()=>[I(j("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>kl.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[O,kl.value]])])),_:1})])),_:1}),F(U,null,{default:T((()=>[F(V,{color:"primary",icon:"fas fa-plus",elevated:"",onClick:Ql},{default:T((()=>[$(" Add coupon ")])),_:1}),F(V,{color:"warning",icon:"fas fa-print",elevated:"",disabled:""},{default:T((()=>[$(" Print ")])),_:1})])),_:1})])]),j("div",te,[j("div",se,[wl.value||Gl.value.length?M("",!0):(S(),E(P,{key:0,title:"No coupons found.",subtitle:"No coupons matched your search criteria, or no coupons have been created yet."},{image:T((()=>[oe,ie])),action:T((()=>[kl.value?(S(),E(V,{key:0,color:"primary",outlined:"",onClick:a[1]||(a[1]=e=>kl.value="")},{default:T((()=>[$(" Clear Search ")])),_:1})):M("",!0),F(V,{color:"primary",icon:"lucide:plus",raised:"",class:z({"ml-2":kl.value}),onClick:Ql},{default:T((()=>[$(" Add Coupon ")])),_:1},8,["class"])])),_:1})),Gl.value.length?(S(),E(Z,{key:1,data:Gl.value,columns:oa,rounded:"",reactive:""},{body:T((()=>[F(G,{name:"list",tag:"div",class:"flex-list-inner"},{default:T((()=>[(S(!0),q(J,null,R(Gl.value,(e=>(S(),q("div",{key:e.id,class:"flex-table-item"},[F(N,{column:{media:!0,grow:!0},"data-th":"Coupon Code",style:{"padding-left":"1.5%"}},{default:T((()=>[j("span",re,B(e.couponCode),1)])),_:2},1024),F(N,{column:oa.appliesTo,"data-th":"Applies To"},{default:T((()=>{return[!e.isForEverybody&&e.userList?.length>0?(S(),E(L,{key:0,limit:3,size:"small",avatars:(l=e.userList,l&&Array.isArray(l)&&0!==l.length?l.map((e=>({initials:`${e.firstName?.[0]??""}${e.lastName?.[0]??""}`.toUpperCase()}))):[])},null,8,["avatars"])):e.isForEverybody?(S(),q("span",ue,"All Users")):(S(),q("span",ne,"-"))];var l})),_:2},1032,["column"]),F(N,{column:oa.discount,"data-th":"Discount"},{default:T((()=>[j("span",ce,B(e.isDiscountPourcentage?100*e.discount:e.discount)+" "+B(e.isDiscountPourcentage?"%":"$"),1)])),_:2},1032,["column"]),F(N,{column:oa.dates,"data-th":"Validity"},{default:T((()=>[j("span",de,[$(B(sa(e.startDate))+" ",1),ve,$(" "+B(sa(e.endDate)),1)])])),_:2},1032,["column"]),F(N,{column:oa.status,"data-th":"Status"},{default:T((()=>[F(Q,{color:e.isActive?"success":"danger",label:e.isActive?"Active":"Inactive",rounded:""},null,8,["color","label"])])),_:2},1032,["column"]),F(N,{column:oa.actions,"data-th":"Actions"},{default:T((()=>[F(U,null,{default:T((()=>[F(Y,{style:{"margin-right":"1px"}},{content:T((()=>[$(" View coupon detail ")])),default:T((()=>[F(X,{icon:"lucide:eye",elevated:"",color:"info",title:`View coupon details for ${e.couponCode}`,onClick:()=>(e=>{if(!e||!e.id)return void ee.error("Invalid coupon data.");const l=e.id;try{Cl.push({name:"/app/settings/referral/[voucher_id]",params:{voucher_id:l}})}catch(a){console.error("Failed to navigate to coupon details:",a),ee.error("Could not open coupon details. Route may be misconfigured.")}})(e)},null,8,["title","onClick"])])),_:2},1024),F(Y,{style:{"margin-left":"1px"}},{content:T((()=>[$(B(e.isActive?"Deactivate coupon":"Activate coupon"),1)])),default:T((()=>[F(X,{icon:e.isActive?"lucide:circle-slash-2":"lucide:circle",color:e.isActive?"danger":"success",title:e.isActive?"Deactivate coupon (not implemented)":"Activate coupon (not implemented)",onClick:l=>(async e=>{if(e&&e.id)try{const l={couponCode:e.couponCode,isActive:!e.isActive,description:e.description,isDiscountPourcentage:e.isDiscountPourcentage,discount:e.discount,startDate:e.startDate,endDate:e.endDate,maxNumberOfUsePerUser:e.maxNumberOfUsePerUser,maxNumberOfUse:e.maxNumberOfUse,isForEverybody:e.isForEverybody,...e.isForEverybody?{userList:[],driverEmailList:[],couponTripList:[],passengerEmailList:[]}:{userList:e.userList,driverEmailList:e.driverEmailList,couponTripList:(()=>{const l=[],a=e.couponTripList.map((e=>e.departureTown)),t=e.couponTripList.map((e=>e.destinationTown));if(a.length>0&&t.length>0)for(const e of a)for(const a of t)l.push({departureTown:e,destinationTown:a});return l})(),passengerEmailList:[]}};await D.edit("/Coupon/UpdateCoupon?Id="+e.id,l)?(ee.success(`Coupon "${e}" statut updated successfully!`),await aa()):ee.error("Failed to update coupon statut.")}catch(l){console.error("Error updating coupon status:",l),ee.error(`Failed to update coupon status: ${l.message||"Unknown error"}`)}else ee.error("Invalid coupon ID.")})(e)},null,8,["icon","color","title","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["column"])])))),128))])),_:1})])),_:1},8,["data"])):M("",!0),!wl.value&&Pl.value.totalItems>Pl.value.itemsPerPage?(S(),E(xl,{key:2,"current-page":Pl.value.page,"onUpdate:currentPage":[a[2]||(a[2]=e=>Pl.value.page=e),ta],"item-per-page":Pl.value.itemsPerPage,"total-items":Pl.value.totalItems,"max-links-displayed":3,"no-router":""},null,8,["current-page","item-per-page","total-items"])):M("",!0)])]),F(ua,{open:Dl.value,size:"large",actions:"center",title:"Create a new coupon",noclose:"",onClose:Xl},{content:T((()=>[F(ea,{active:Vl.value,card:"regular"},{default:T((()=>[j("form",{onSubmit:K(la,["prevent"])},[j("div",pe,[I(j("div",null,[j("div",me,[fe,F(X,{icon:"lucide:move-right",circle:"",disabled:Rl.isForEverybody,onClick:a[3]||(a[3]=e=>Yl("userlist"))},null,8,["disabled"])]),j("div",ye,[j("div",ge,[F(w,{label:"Coupon code *"},{default:T((()=>[F(t,null,{default:T((()=>[F(Ll,{modelValue:Rl.couponCode,"onUpdate:modelValue":a[4]||(a[4]=e=>Rl.couponCode=e),modelModifiers:{trim:!0},placeholder:"e.g., SUMMER20",required:""},null,8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"Type of discount *"},{default:T((()=>[F(t,null,{default:T((()=>[F(El,{modelValue:Rl.isDiscountPourcentage,"onUpdate:modelValue":a[5]||(a[5]=e=>Rl.isDiscountPourcentage=e)},{default:T((()=>[F(Al,{value:!0},{default:T((()=>[$(" Percentage ")])),_:1}),F(Al,{value:!1},{default:T((()=>[$(" Amount ")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"Discount Value *"},{default:T((()=>[F(t,null,{default:T((()=>[F(Ll,{modelValue:Rl.discount,"onUpdate:modelValue":a[6]||(a[6]=e=>Rl.discount=e),modelModifiers:{number:!0},type:"number",placeholder:Rl.isDiscountPourcentage?"e.g., 10":"e.g., 5.00",min:"0.01",step:"any",required:""},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),F(w,{label:"Start date *"},{default:T((()=>[F(t,{icon:"lucide:calendar-days"},{default:T((()=>[F(Ll,{modelValue:Rl.startDate,"onUpdate:modelValue":a[7]||(a[7]=e=>Rl.startDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"End date *"},{default:T((()=>[F(t,{icon:"lucide:calendar-days"},{default:T((()=>[F(Ll,{modelValue:Rl.endDate,"onUpdate:modelValue":a[8]||(a[8]=e=>Rl.endDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),j("div",_e,[F(w,{label:"Description *"},{default:T((()=>[F(t,null,{default:T((()=>[F(Kl,{modelValue:Rl.description,"onUpdate:modelValue":a[9]||(a[9]=e=>Rl.description=e),modelModifiers:{trim:!0},placeholder:"Brief description...",rows:"4",required:""},null,8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"Max uses per user *"},{default:T((()=>[F(t,{icon:"lucide:user-check"},{default:T((()=>[F(Ll,{modelValue:Rl.maxNumberOfUsePerUser,"onUpdate:modelValue":a[10]||(a[10]=e=>Rl.maxNumberOfUsePerUser=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 1",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"Max total uses *"},{default:T((()=>[F(t,{icon:"lucide:tag"},{default:T((()=>[F(Ll,{modelValue:Rl.maxNumberOfUse,"onUpdate:modelValue":a[11]||(a[11]=e=>Rl.maxNumberOfUse=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 100",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),F(w,{label:"Applies To"},{default:T((()=>[F(t,null,{default:T((()=>[F(Zl,{modelValue:Rl.isForEverybody,"onUpdate:modelValue":a[12]||(a[12]=e=>Rl.isForEverybody=e),label:"Apply to all users",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})])])],512),[[H,"index"===Nl.value]]),I(j("div",null,[j("div",he,[F(X,{icon:"lucide:move-left",circle:"",onClick:a[13]||(a[13]=e=>Yl("index"))}),be,F(X,{icon:"lucide:move-right",circle:"",onClick:a[14]||(a[14]=e=>Yl("driverlist"))})]),j("div",Ce,[j("div",ke,[j("div",xe,[De,F(w,{class:"mb-3",style:{width:"100%"}},{default:T((()=>[F(t,{icon:"feather:search"},{default:T((()=>[F(Ll,{modelValue:Tl.value,"onUpdate:modelValue":a[15]||(a[15]=e=>Tl.value=e),placeholder:"Search by email..."},null,8,["modelValue"])])),_:1})])),_:1}),j("div",{class:"userlist scrollable-list",style:W({display:Tl.value.length>0?"block":"none"})},[Sl.value?(S(),q("div",we," Loading... ")):0===Bl.value.length?(S(),q("div",Ve,' No passengers found matching "'+B(Tl.value)+'". ',1)):M("",!0),Sl.value?Sl.value?M("",!0):(S(),q("div",Pe," Start typing to search for passengers. ")):(S(),E(ea,{key:2},{default:T((()=>[Bl.value.length>0?(S(!0),q(J,{key:0},R(Bl.value,(e=>(S(),q("ul",{key:e.id,class:"list-item",onClick:l=>(e=>{if(e&&e.id)try{if(Ol.value.some((l=>l.userId===e.id)))return void ee.info(`${e.userDetail?.firstName??"User"} is already selected.`);const l={id:e.id,userId:e.userDetail?.userId,firstName:e.userDetail?.firstName??"",lastName:e.userDetail?.lastName??"",email:e.email??"",phoneNumber:e.phoneNumber??"",couponCode:Rl.couponCode,discount:Rl.discount,maxPersonalUseNumber:Rl.maxNumberOfUsePerUser,currentPersonalUsesNumber:0,couponStartDate:Rl.startDate,couponEndDate:Rl.endDate,couponId:s()};Ol.value.push(l),Tl.value=""}catch(l){ee.error("An error occurred while selecting the user."),console.error("Error in selectUser:",l)}else ee.error("Cannot select invalid user data.")})(e)},[j("li",null,B(e.email),1)],8,Ue)))),128)):M("",!0)])),_:1}))],4)])]),j("div",Ne,[j("div",Le,[j("p",null,"Passengers Selected ("+B(Ol.value.length)+"):",1),j("div",Ae,[0===Ol.value.length?(S(),q("div",Se," Click passengers on the left to select. ")):M("",!0),(S(!0),q(J,null,R(Ol.value,(e=>(S(),E(ra,{key:e.userId,title:e.email,white:"",icon:"fas fa-user",onClick:l=>{var a;(a=e.userId)&&(Ol.value=Ol.value.filter((e=>e.userId!==a)),ee.info("User removed from selection."))}},{default:T((()=>[F(ia,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[H,"userlist"===Nl.value]]),I(j("div",null,[j("div",Ee,[F(X,{icon:"lucide:move-left",circle:"",onClick:a[16]||(a[16]=e=>Yl("userlist"))}),Te,F(X,{icon:"lucide:move-right",circle:"",onClick:a[17]||(a[17]=e=>Yl("triplist"))})]),j("div",je,[j("div",Fe,[j("div",Ie,[Oe,F(w,{class:"mb-3"},{default:T((()=>[F(t,{icon:"feather:search"},{default:T((()=>[F(Ll,{modelValue:jl.value,"onUpdate:modelValue":a[18]||(a[18]=e=>jl.value=e),placeholder:"Search by email..."},null,8,["modelValue"])])),_:1})])),_:1}),j("div",{class:"userlist scrollable-list",style:W({display:jl.value.length>0?"block":"none"})},[Sl.value?(S(),q("div",$e," Loading... ")):0===Jl.value.length?(S(),q("div",Me,' No drivers found matching "'+B(jl.value)+'". ',1)):M("",!0),Sl.value?Sl.value?M("",!0):(S(),q("div",qe," Start typing to search for passengers. ")):(S(),E(ea,{key:2},{default:T((()=>[Jl.value.length>0?(S(!0),q(J,{key:0},R(Jl.value,(e=>(S(),q("ul",{key:e.id,class:"list-item",onClick:l=>(e=>{if(e&&e.email)try{const l=e.email;if($l.value.includes(l))return void ee.info(`${e.userDetail?.firstName??"Driver"} is already selected.`);$l.value.push(l),jl.value=""}catch(l){ee.error("An error occurred while selecting the driver."),console.error("Error in selectDriver:",l)}else ee.error("Cannot select invalid driver data (missing email).")})(e)},[j("li",null,B(e.email),1)],8,ze)))),128)):M("",!0)])),_:1}))],4)])]),j("div",Re,[j("div",Be,[j("p",null," Drivers Selected ("+B($l.value.length)+"): ",1),j("div",Je,[0===$l.value.length?(S(),q("div",Ge," Click drivers on the left to select. ")):M("",!0),(S(!0),q(J,null,R($l.value,((e,l)=>(S(),E(ra,{key:l,title:e,white:"",icon:"fas fa-user",class:"font-size:6px",onClick:l=>{var a;(a=e)&&($l.value=$l.value.filter((e=>e!==a)),ee.info("Driver removed from selection."))}},{default:T((()=>[F(ia,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[H,"driverlist"===Nl.value]]),I(j("div",null,[j("div",He,[F(X,{icon:"lucide:move-left",circle:"",onClick:a[19]||(a[19]=e=>Yl("driverlist"))}),We,Ke]),j("div",Qe,[j("div",Xe,[j("div",Ye,[Ze,F(w,{class:"mb-3"},{default:T((()=>[F(t,{icon:"feather:search"},{default:T((()=>[F(Ll,{modelValue:Fl.value,"onUpdate:modelValue":a[20]||(a[20]=e=>Fl.value=e),placeholder:"Search departure..."},null,8,["modelValue"])])),_:1})])),_:1}),j("div",{class:"userlist scrollable-list",style:W({display:Fl.value.length>0?"block":"none"})},[0===Hl.value.length?(S(),q("div",el,' No locations found matching "'+B(Fl.value)+'". ',1)):M("",!0),Fl.value.length>0?(S(!0),q(J,{key:1},R(Hl.value,(e=>(S(),q("ul",{key:`dep-${e}`,class:"list-item",onClick:l=>{var a;(a=e)&&(Ml.value.length>=1?ee.info("Only one town can be added"):Ml.value.includes(a)?ee.info(`${a} is already selected for departure.`):(Ml.value.push(a),Fl.value=""))}},[j("li",null,B(e),1)],8,ll)))),128)):M("",!0)],4),j("div",al,[j("p",null," Selected Departures ("+B(Ml.value.length)+"): ",1),j("div",tl,[0===Ml.value.length?(S(),q("div",sl," Click locations above to select. ")):M("",!0),(S(!0),q(J,null,R(Ml.value,(e=>(S(),E(ra,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:l=>{var a;(a=e)&&(Ml.value=Ml.value.filter((e=>e!==a)),ee.info("Departure location removed."))}},{default:T((()=>[F(ia,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])]),j("div",ol,[j("div",il,[rl,F(w,{class:"mb-3"},{default:T((()=>[F(t,{icon:"feather:search"},{default:T((()=>[F(Ll,{modelValue:Il.value,"onUpdate:modelValue":a[21]||(a[21]=e=>Il.value=e),placeholder:"Search destination..."},null,8,["modelValue"])])),_:1})])),_:1}),j("div",{class:"userlist scrollable-list",style:W({display:Il.value.length>0?"block":"none"})},[0===Wl.value.length?(S(),q("div",ul,' No locations found matching "'+B(Il.value)+'". ',1)):M("",!0),Il.value.length>0?(S(!0),q(J,{key:1},R(Wl.value,(e=>(S(),q("ul",{key:`dest-${e}`,class:"list-item",onClick:l=>{var a;(a=e)&&(zl.value.length>=1?ee.info("Only one town can be added"):Ml.value.includes(a)?ee.info(`${a} is already selected for departure.`):zl.value.includes(a)?ee.info(`${a} is already selected for destination.`):(zl.value.push(a),Il.value=""))}},[j("li",null,B(e),1)],8,nl)))),128)):M("",!0)],4),j("div",cl,[j("p",null," Selected Destinations ("+B(zl.value.length)+"): ",1),j("div",dl,[0===zl.value.length?(S(),q("div",vl," Click locations above to select. ")):M("",!0),(S(!0),q(J,null,R(zl.value,(e=>(S(),E(ra,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:l=>{var a;(a=e)&&(zl.value=zl.value.filter((e=>e!==a)),ee.info("Destination location removed."))}},{default:T((()=>[F(ia,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])]),j("div",pl,[F(V,{color:"info",raised:"",loading:Ul.value,disabled:0===Ml.value.length||0===zl.value.length,onClick:a[22]||(a[22]=e=>((e,l)=>{if(!e||!l)return;if(0===e.length||0===l.length)return void ee.error("Please select at least one departure and one destination location.");const a=e,t=l,o={id:s(),departureTown:a[0],destinationTown:t[0]};ql.value.push(o),Ml.value=[],zl.value=[],console.log("Trips added:",ql.value),Ul.value=!1})(Ml.value,zl.value))},{default:T((()=>[$(" Add Trip ")])),_:1},8,["loading","disabled"])]),j("div",ml,[fl,j("div",yl,[0===ql.value.length?(S(),q("div",gl," No trips added yet. ")):M("",!0),ql.value.length>0?(S(!0),q(J,{key:1},R(ql.value,(e=>(S(),q("ul",{key:e.id,class:"list-item-trip"},[j("li",null,[_l,$(B(e.departureTown)+" - ",1),hl,$(B(e.destinationTown),1)]),F(X,{icon:"lucide:x",class:"ml-2",onClick:l=>{var a;(a=e.id)&&(ql.value=ql.value.filter((e=>e.id!==a)),ee.info("Trip removed from selection."))}},null,8,["onClick"])])))),128)):M("",!0)])]),bl])],512),[[H,"triplist"===Nl.value]])])],32)])),_:1},8,["active"])])),action:T((()=>[Rl.isForEverybody||"triplist"===Nl.value?(S(),E(V,{key:0,color:"primary",raised:"",loading:Vl.value,disabled:Vl.value||Sl.value,onClick:la},{default:T((()=>[$(" Create Coupon ")])),_:1},8,["loading","disabled"])):M("",!0)])),_:1},8,["open"])])),_:1},8,["active"])}}});"function"==typeof ee&&ee(Cl);export{Cl as default};
