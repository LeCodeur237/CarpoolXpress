import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-BekG8VLR.js";import{_ as a}from"./VLoader.vue_vue_type_style_index_0_lang-Dhf66N_2.js";import{e as l,Q as t,t as o,v as i,A as s,m as r,x as n,z as u,M as c,L as d,y as v,an as m,ao as p,r as f,Y as h,a4 as y,j as g,f as _,o as b,w as C,G as k,J as w,I as S,H as V,S as D,R as x,a6 as P,aq as U,ar as N,K as L}from"./index-9E-GM-ra.js";import{_ as A}from"./VIcon.vue_vue_type_script_setup_true_lang-C_k57Jfv.js";import{_ as M}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-SRMvAbcX.js";import{u as E,_ as B}from"./VControl-CtTfKoLz.js";import{_ as O,a as T}from"./VOption.vue_vue_type_style_index_0_lang-C1FpliNh.js";import{_ as I}from"./VInput.vue_vue_type_script_setup_true_lang-D-OakKu6.js";import{_ as j}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-C9SkWjaR.js";import{a as F,_ as R}from"./VFlexTable.vue_vue_type_style_index_0_lang-CFi8J12_.js";import{_ as $}from"./VIconButton-BMA-ETBV.js";import{_ as G}from"./VTag.vue_vue_type_style_index_0_lang-etj_z69o.js";import{_ as W}from"./VAvatarStack.vue_vue_type_script_setup_true_lang-Dc4JdJ8J.js";import{_ as z}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-BjJPvU_c.js";import{_ as q}from"./VButtons.vue_vue_type_script_setup_true_lang-hhep-j-V.js";import{_ as H}from"./VButton.vue_vue_type_style_index_0_lang-Ct3-45wW.js";import{_ as J}from"./VField.vue_vue_type_script_setup_true_lang-CL_bc036.js";import{u as K}from"./viewWrapper-CXL7cLXa.js";import{u as Q}from"./defaultResource-Bdsg8Ykk.js";import{D as Y}from"./datetime-xmklhC0O.js";import{u as Z}from"./useNotyf-BOmkemzM.js";import{b as X}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./VAvatar.vue_vue_type_style_index_0_lang-8I4quGGY.js";import"./useFetch-CdhACbSq.js";import"./notyf-WVWeOSLR.js";const ee=["data-icon"],ae={key:1,class:"snack-media"},le=["src"],te={class:"snack-text"},oe={class:"snack-action"},ie=l({__name:"VSnack",props:{title:{},icon:{default:void 0},image:{default:void 0},placeholder:{default:"https://via.placeholder.com/50x50"},color:{default:void 0},size:{default:void 0},solid:{type:Boolean},white:{type:Boolean}},setup(e){const a=e;function l(e){e.target.src=a.placeholder}const m=t((()=>a.icon&&-1!==a.icon.indexOf(":")));return(e,t)=>(o(),i("div",{class:s(["snack",[a.white&&"is-white",a.size&&`is-${a.size}`]])},[a.icon?(o(),i("div",{key:0,class:s(["snack-media is-icon",[a.color&&`is-${a.color}`,a.solid&&"is-solid"]])},[r(m)?(o(),i("i",{key:0,"aria-hidden":"true",class:"iconify snack-icon","data-icon":e.icon},null,8,ee)):(o(),i("i",{key:1,"aria-hidden":"true",class:s(["snack-icon",a.icon])},null,2))],2)):a.image?(o(),i("div",ae,[n("img",{class:"avatar",src:a.image,alt:"",onErrorOnce:l},null,40,le)])):u("",!0),n("span",te,[c(e.$slots,"title",{},(()=>[d(v(a.title),1)]))]),n("span",oe,[c(e.$slots,"default")])],2))}}),se=["id","name"],re=l({__name:"VTextarea",props:m({raw:{type:Boolean},autogrow:{type:Boolean}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=p(e,"modelValue"),l=e,{field:n,id:u}=E({create:!1,help:"VTextarea"}),c=f(),d=t({get:()=>n?.value?n.value.value:a.value,set(e){n?.value&&n.value.setValue(e),a.value=e}});function v(){c.value&&l.autogrow&&(c.value.style.height="auto",c.value.style.height=c.value.scrollHeight+"px")}const m=t((()=>l.raw?[]:["textarea"]));return(e,a)=>h((o(),i("textarea",{id:r(u),ref_key:"textareaRef",ref:c,"onUpdate:modelValue":a[0]||(a[0]=e=>g(d)?d.value=e:null),class:s(r(m)),name:r(u),onChange:a[1]||(a[1]=(...e)=>r(n)?.handleChange&&r(n)?.handleChange(...e)),onBlur:a[2]||(a[2]=(...e)=>r(n)?.handleBlur&&r(n)?.handleBlur(...e)),onInput:v},null,42,se)),[[y,r(d)]])}}),ne=["Abbotsford","Airdrie","Ajax","Alma","Amos","Aurora","Barrie","Beaconsfield","Belleville","Blainville","Boisbriand","Boucherville","Bradford West Gwillimbury","Brampton","Brandon","Brantford","Brockville","Brossard","Burlington","Burnaby","Caledon","Calgary","Cambridge","Campbell River","Camrose","Candiac","Cape Breton","Chambly","Charlottetown","Châteauguay","Chatham-Kent","Chilliwack","Clarence-Rockland","Clarington","Cobourg","Cochrane","Coquitlam","Cornwall","Côte Saint-Luc","Courtenay","Cranbrook","Dartmouth","Delta","Deux-Montagnes","Dieppe","Dollard-des-Ormeaux","Dorval","Drummondville","Duncan","East Gwillimbury","Edmonton","Edmundston","Etobicoke","Fort Erie","Fort McMurray","Fort Saskatchewan","Fort St. John","Fredericton","Gatineau","Georgina","Glace Bay","Granby","Grande Prairie","Greater Sudbury","Grimsby","Guelph","Halifax","Halton Hills","Hamilton","Huntsville","Innisfil","Joliette","Kamloops","Kawartha Lakes","Kelowna","Kenora","Kingston","Kirkland","Kitchener","La Prairie","Lachute","Lacombe","Ladysmith","Lake Country","Langford","Langley (City)","Langley (District)","Laval","Leamington","Leduc","Lethbridge","Lévis","Lincoln","Lloydminster","London","Longueuil","Magog","Maple Ridge","Markham","Mascouche","Medicine Hat","Midland","Milton","Mirabel","Miramichi","Mississauga","Moncton","Mont-Royal","Mont-Saint-Hilaire","Montreal","Moose Jaw","Mount Pearl","Nanaimo","New Glasgow","New Tecumseth","New Westminster","Newmarket","Niagara Falls","Norfolk County","North Battleford","North Bay","North Cowichan","North Vancouver (City)","North Vancouver (District)","Oak Bay","Oakville","Okotoks","Orangeville","Orillia","Oshawa","Ottawa","Owen Sound","Parksville","Pembroke","Penticton","Peterborough","Pickering","Pitt Meadows","Pointe-Claire","Port Alberni","Port Colborne","Port Coquitlam","Port Moody","Powell River","Prince Albert","Prince Edward County","Prince George","Prince Rupert","Quinte West","Quebec City","Red Deer","Regina","Repentigny","Richmond","Richmond Hill","Rimouski","Rivière-du-Loup","Rouyn-Noranda","Saguenay","Saint-Augustin-de-Desmaures","Saint-Basile-le-Grand","Saint-Bruno-de-Montarville","Saint-Constant","Saint-Eustache","Saint-Georges","Saint-Hyacinthe","Saint-Jean-sur-Richelieu","Saint-Jérôme","Saint John","Saint-Lambert","Saint-Lazare","Sainte-Adèle","Sainte-Anne-des-Plaines","Sainte-Catherine","Sainte-Julie","Sainte-Marthe-sur-le-Lac","Sainte-Thérèse","Salaberry-de-Valleyfield","Salmon Arm","Sarnia","Saskatoon","Sault Ste. Marie","Scarborough","Sept-Îles","Shawinigan","Sherbrooke","Sherwood Park","Sorel-Tracy","Spruce Grove","St. Albert","St. Catharines","St. John's","St. Thomas","Stratford","Strathcona County","Strathroy-Caradoc","Summerside","Surrey","Swift Current","Sydney","Tecumseh","Terrebonne","Thorold","Thunder Bay","Timmins","Toronto","Trois-Rivières","Truro","Val-d'Or","Vancouver","Varennes","Vaudreuil-Dorion","Vaughan","Vernon","Victoria","Victoriaville","Waterloo","Welland","West Kelowna","West Vancouver","Westmount","Weyburn","Whitby","White Rock","Whitchurch-Stouffville","Williams Lake","Windsor","Winnipeg","Wood Buffalo","Woodstock","Yellowknife","Yorkton"],ue=[];for(let Na=0;Na<256;++Na)ue.push((Na+256).toString(16).slice(1));let ce;const de=new Uint8Array(16);const ve={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function me(e,a,l){if(ve.randomUUID&&!a&&!e)return ve.randomUUID();const t=(e=e||{}).random??e.rng?.()??function(){if(!ce){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ce=crypto.getRandomValues.bind(crypto)}return ce(de)}();if(t.length<16)throw new Error("Random bytes length must be >= 16");return t[6]=15&t[6]|64,t[8]=63&t[8]|128,function(e,a=0){return(ue[e[a+0]]+ue[e[a+1]]+ue[e[a+2]]+ue[e[a+3]]+"-"+ue[e[a+4]]+ue[e[a+5]]+"-"+ue[e[a+6]]+ue[e[a+7]]+"-"+ue[e[a+8]]+ue[e[a+9]]+"-"+ue[e[a+10]]+ue[e[a+11]]+ue[e[a+12]]+ue[e[a+13]]+ue[e[a+14]]+ue[e[a+15]]).toLowerCase()}(t)}const pe={style:{"margin-top":"1rem","margin-bottom":"4rem"}},fe={class:"list-flex-toolbar flex-list-v1"},he={class:"page-content-inner",style:{"margin-top":"5rem"}},ye={class:"flex-list-wrapper flex-list-v1"},ge=n("img",{class:"light-image",src:"/assets/search-7-BRepkZ0T.svg",alt:"",style:{"max-width":"280px"}},null,-1),_e=n("img",{class:"dark-image",src:"/assets/search-7-dark-Cu_2bQnD.svg",alt:"",style:{"max-width":"280px"}},null,-1),be={class:"item-name dark-inverted"},Ce={key:1,class:"light-text"},ke={key:2,class:"light-text"},we={class:"light-text"},Se={class:"light-text"},Ve=n("br",null,null,-1),De={class:"modal-form"},xe={class:"modal-nav"},Pe=n("h3",{class:"modal-step-title"}," Coupon Information ",-1),Ue={class:"columns is-multiline"},Ne={class:"column is-6"},Le={class:"column is-6"},Ae={class:"modal-nav"},Me=n("h3",{class:"modal-step-title"}," Select Users (Passengers) ",-1),Ee={class:"row mt-4"},Be={class:"col-12 mb-4"},Oe={class:"userSelection"},Te=n("p",null,"Available Passengers:",-1),Ie={key:0,class:"list-placeholder"},je={key:1,class:"list-placeholder"},Fe=["onClick"],Re={class:"list-item-email"},$e={key:3,class:"list-placeholder"},Ge={class:"col-12"},We={class:"userSelection"},ze={class:"userlist scrollable-list selected-items-list"},qe={key:0,class:"list-placeholder"},He={class:"modal-nav"},Je=n("h3",{class:"modal-step-title"}," Select Drivers ",-1),Ke={class:"row mt-4"},Qe={class:"col-12"},Ye={class:"userSelection"},Ze=n("p",null,"Available Drivers:",-1),Xe={key:0,class:"list-placeholder"},ea={key:1,class:"list-placeholder"},aa=["onClick"],la={class:"list-item-email"},ta={key:3,class:"list-placeholder"},oa={class:"col-12"},ia={class:"userSelection"},sa={class:"userlist scrollable-list selected-items-list"},ra={key:0,class:"list-placeholder"},na={class:"modal-nav"},ua=n("h3",{class:"modal-step-title"}," Select Applicable Trip Locations ",-1),ca=n("div",{style:{width:"40px"}},null,-1),da={class:"rower mt-4"},va={class:"col-6"},ma={class:"userSelection"},pa=n("p",null,"Departure Towns/Cities:",-1),fa={key:0,class:"list-placeholder"},ha=["onClick"],ya={class:"userSelection mt-4"},ga={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},_a={key:0,class:"list-placeholder"},ba={class:"col-6"},Ca={class:"userSelection"},ka=n("p",null,"Destination Towns/Cities:",-1),wa={key:0,class:"list-placeholder"},Sa=["onClick"],Va={class:"userSelection mt-4"},Da={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},xa={key:0,class:"list-placeholder"},Pa=n("p",{class:"help is-info mt-4 has-text-centered"},[d(" The coupon will apply if the trip starts in a selected departure location "),n("b",null,"OR"),d(" ends in a selected destination location. Leave a list empty to not restrict by it. ")],-1),Ua=l({__name:"voucher",setup(l){const r=K(),c=Q(),m=Z(),p=f(""),g=f([]),E=f(!1),X=f(!1),ee=f(!1),ae=f({page:1,itemsPerPage:5,totalItems:0,totalPages:0}),le=f("index"),te=f([]),oe=f([]),se=f(!1),ue=f([...ne].sort()),ce=f(""),de=f(""),ve=f(""),Ua=f(""),Na=f([]),La=f([]),Aa=f([]),Ma=f([]),Ea=_({couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Ba=t((()=>{const e=ce.value.toLowerCase().trim();return e?te.value.filter((a=>{if(!0===a.isCodeVerified)return!1;const l=`${a.userDetail?.firstName??""} ${a.userDetail?.lastName??""}`.toLowerCase(),t=(a.email??"").toLowerCase();return l.includes(e)||t.includes(e)})):te.value})),Oa=t((()=>{const e=de.value.toLowerCase().trim();return e?oe.value.filter((a=>{if(!0!==a.isCodeVerified)return!1;const l=`${a.userDetail?.firstName??""} ${a.userDetail?.lastName??""}`.toLowerCase(),t=(a.email??"").toLowerCase();return l.includes(e)||t.includes(e)})):oe.value})),Ta=t((()=>{if(!p.value)return g.value;const e=p.value.toLowerCase().trim();return e?g.value.filter((a=>a.couponCode?.toLowerCase().includes(e)||a.description?.toLowerCase().includes(e)||a.discount.toString().includes(e))):g.value})),Ia=t((()=>{const e=ve.value.toLowerCase().trim();return e?ue.value.filter((a=>a.toLowerCase().includes(e))):ue.value})),ja=t((()=>{const e=Ua.value.toLowerCase().trim();return e?ue.value.filter((a=>a.toLowerCase().includes(e))):ue.value})),Fa=()=>{Object.assign(Ea,{couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Na.value=[],La.value=[],Aa.value=[],Ma.value=[],ce.value="",de.value="",ve.value="",Ua.value="",le.value="index"},Ra=()=>{Fa(),E.value=!0,Ea.isForEverybody||0!==te.value.length||Wa()},$a=()=>{E.value=!1,Fa()},Ga=e=>{le.value=e},Wa=async()=>{if(!(te.value.length>0&&oe.value.length>0||se.value)){se.value=!0;try{const e=await c.list("/User/GetAllUsers",!0);e&&Array.isArray(e.data)?(te.value=e.data,oe.value=e.data):m.warning("Could not fetch user/driver list for selection.")}catch(e){console.error("Error fetching data for select inputs:",e),m.error("Could not load data needed for coupon targeting.")}finally{se.value=!1}}},za=async()=>{ee.value=!0;try{if(!Ea.couponCode.trim()||!Ea.description.trim()||Ea.discount<=0)return m.error("Please fill in code, description, and provide a valid positive discount."),void(ee.value=!1);if(!Ea.startDate||!Ea.endDate)return m.error("Please select both start and end dates."),void(ee.value=!1);if(Ea.startDate>=Ea.endDate)return m.error("End date must be after start date."),void(ee.value=!1);if(Ea.maxNumberOfUsePerUser<=0||Ea.maxNumberOfUse<=0)return m.error("Usage limits must be positive numbers."),void(ee.value=!1);if(!Ea.isForEverybody&&0===Na.value.length&&0===La.value.length)return m.error("Please select at least one user, driver, or trip when not applying to everybody."),void(ee.value=!1);const e={couponCode:Ea.couponCode.trim(),description:Ea.description.trim(),isDiscountPourcentage:Ea.isDiscountPourcentage,discount:Ea.discount,startDate:Ea.startDate,endDate:Ea.endDate,maxNumberOfUsePerUser:Ea.maxNumberOfUsePerUser,maxNumberOfUse:Ea.maxNumberOfUse,isForEverybody:Ea.isForEverybody,...Ea.isForEverybody?{userList:[],driverEmailList:[],couponTripList:[],passengerEmailList:[]}:{userList:Na.value,driverEmailList:La.value,couponTripList:(()=>{const e=[],a=Aa.value,l=Ma.value;if(a.length>0&&l.length>0)for(const t of a)for(const a of l)e.push({departureTown:t,destinationTown:a});return e})(),passengerEmailList:[]}},a=await c.add("/Coupon/CreateCoupon",e);a?(m.success(`Coupon "${Ea.couponCode}" created successfully!`),ae.value.page=1,await qa(),$a()):(m.error("Failed to create coupon. API response indicated failure."),console.warn("Coupon creation API call returned falsy or unexpected response:",a))}catch(e){console.error("Error creating coupon:",e);const a=e?.response?.data?.errors?JSON.stringify(e.response.data.errors):e?.response?.data?.message||e.message||"Unknown error";m.error(`Failed to create coupon: ${a}`)}finally{ee.value=!1}},qa=async()=>{X.value=!0;try{const e=`/Coupon/GetAllCoupon?pageNumber=${ae.value.page}&pageSize=${ae.value.itemsPerPage}`,a=await c.list(e,!0);a&&Array.isArray(a.data)?(g.value=a.data,ae.value.totalItems=a.total,ae.value.totalPages=Math.ceil(a.total/ae.value.itemsPerPage)):(g.value=[],ae.value.totalItems=0,ae.value.totalPages=0,console.warn("Received invalid response for coupons:",a),m.warning("Could not fetch coupons or data format is incorrect."))}catch(e){console.error("Error fetching coupons:",e),m.error(`Failed to load coupons: ${e.message||"Unknown error"}`),g.value=[],ae.value.totalItems=0,ae.value.totalPages=0}finally{X.value=!1}},Ha=async e=>{ae.value.page=e,await qa()},Ja=e=>{if(!e)return"N/A";try{const a=e instanceof Date?Y.fromJSDate(e):Y.fromISO(e);return a.isValid?a.toFormat("dd MMM yyyy"):"Invalid Date"}catch(a){return console.warn("Date formatting error:",a),"Invalid Date"}};b((async()=>{r.setPageTitle("Voucher & Coupons"),await qa()})),C((()=>Ea.isForEverybody),(e=>{e||0!==te.value.length||Wa(),e&&(Na.value=[],La.value=[],Aa.value=[],Ma.value=[],le.value="index")}));const Ka={couponCode:{label:"Coupon code",grow:!0,sortable:!0},appliesTo:{label:"Applies To",align:"center"},discount:{label:"Discount",align:"center"},dates:{label:"Validity",align:"center"},status:{label:"Status",align:"center"},actions:{label:"Actions",align:"end"}};return(l,t)=>{const r=B,c=J,f=H,g=q,_=z,b=F,C=W,K=G,Q=$,Y=k("Tippy"),Z=R,te=j,oe=I,ne=O,ue=T,Fa=re,Wa=M,qa=A,Qa=ie,Ya=a,Za=e;return o(),w(Ya,{size:"xl",active:X.value&&!ee.value,class:"full-height",overlay:!0},{default:S((()=>[n("div",pe,[n("div",fe,[V(c,null,{default:S((()=>[V(r,{icon:"feather:search"},{default:S((()=>[h(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,p.value]])])),_:1})])),_:1}),V(g,null,{default:S((()=>[V(f,{color:"primary",icon:"fas fa-plus",elevated:"",onClick:Ra},{default:S((()=>[d(" Add coupon ")])),_:1}),V(f,{color:"warning",icon:"fas fa-print",elevated:"",disabled:""},{default:S((()=>[d(" Print ")])),_:1})])),_:1})])]),n("div",he,[n("div",ye,[X.value||Ta.value.length?u("",!0):(o(),w(_,{key:0,title:"No coupons found.",subtitle:"No coupons matched your search criteria, or no coupons have been created yet."},{image:S((()=>[ge,_e])),action:S((()=>[p.value?(o(),w(f,{key:0,color:"primary",outlined:"",onClick:t[1]||(t[1]=e=>p.value="")},{default:S((()=>[d(" Clear Search ")])),_:1})):u("",!0),V(f,{color:"primary",icon:"lucide:plus",raised:"",class:s({"ml-2":p.value}),onClick:Ra},{default:S((()=>[d(" Add Coupon ")])),_:1},8,["class"])])),_:1})),Ta.value.length?(o(),w(Z,{key:1,data:Ta.value,columns:Ka,rounded:"",reactive:""},{body:S((()=>[V(P,{name:"list",tag:"div",class:"flex-list-inner"},{default:S((()=>[(o(!0),i(x,null,D(Ta.value,(e=>(o(),i("div",{key:e.id,class:"flex-table-item"},[V(b,{column:{media:!0,grow:!0},"data-th":"Coupon Code",style:{"padding-left":"1.5%"}},{default:S((()=>[n("span",be,v(e.couponCode),1)])),_:2},1024),V(b,{column:Ka.appliesTo,"data-th":"Applies To"},{default:S((()=>{return[!e.isForEverybody&&e.userList?.length>0?(o(),w(C,{key:0,limit:3,size:"small",avatars:(a=e.userList,a&&Array.isArray(a)&&0!==a.length?a.map((e=>({initials:`${e.firstName?.[0]??""}${e.lastName?.[0]??""}`.toUpperCase()}))):[])},null,8,["avatars"])):e.isForEverybody?(o(),i("span",Ce,"All Users")):(o(),i("span",ke,"-"))];var a})),_:2},1032,["column"]),V(b,{column:Ka.discount,"data-th":"Discount"},{default:S((()=>[n("span",we,v(e.discount)+v(e.isDiscountPourcentage?"%":"$"),1)])),_:2},1032,["column"]),V(b,{column:Ka.dates,"data-th":"Validity"},{default:S((()=>[n("span",Se,[d(v(Ja(e.startDate))+" ",1),Ve,d(" "+v(Ja(e.endDate)),1)])])),_:2},1032,["column"]),V(b,{column:Ka.status,"data-th":"Status"},{default:S((()=>[V(K,{color:e.isActive?"success":"danger",label:e.isActive?"Active":"Inactive",rounded:""},null,8,["color","label"])])),_:2},1032,["column"]),V(b,{column:Ka.actions,"data-th":"Actions"},{default:S((()=>[V(g,null,{default:S((()=>[V(Y,{style:{"margin-right":"1px"}},{content:S((()=>[d(" View coupon detail ")])),default:S((()=>[V(Q,{icon:"lucide:eye",color:"info",disabled:"",title:"View detail (not implemented)"})])),_:1}),V(Y,{style:{"margin-left":"1px"}},{content:S((()=>[d(v(e.isActive?"Deactivate coupon":"Activate coupon"),1)])),default:S((()=>[V(Q,{icon:e.isActive?"lucide:circle-slash-2":"lucide:circle",color:e.isActive?"danger":"success",disabled:"",title:e.isActive?"Deactivate coupon (not implemented)":"Activate coupon (not implemented)"},null,8,["icon","color","title"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["column"])])))),128))])),_:1})])),_:1},8,["data"])):u("",!0),!X.value&&ae.value.totalItems>ae.value.itemsPerPage?(o(),w(te,{key:2,"current-page":ae.value.page,"onUpdate:currentPage":[t[2]||(t[2]=e=>ae.value.page=e),Ha],"item-per-page":ae.value.itemsPerPage,"total-items":ae.value.totalItems,"max-links-displayed":3,"no-router":""},null,8,["current-page","item-per-page","total-items"])):u("",!0)])]),V(Za,{open:E.value,size:"large",actions:"center",title:"Create a new coupon",noclose:"",onClose:$a},{content:S((()=>[V(Ya,{active:ee.value||se.value,card:"regular"},{default:S((()=>[n("form",{onSubmit:L(za,["prevent"])},[n("div",De,[h(n("div",null,[n("div",xe,[Pe,V(Q,{icon:"lucide:move-right",circle:"",disabled:Ea.isForEverybody,onClick:t[3]||(t[3]=e=>Ga("userlist"))},null,8,["disabled"])]),n("div",Ue,[n("div",Ne,[V(c,{label:"Coupon code *"},{default:S((()=>[V(r,null,{default:S((()=>[V(oe,{modelValue:Ea.couponCode,"onUpdate:modelValue":t[4]||(t[4]=e=>Ea.couponCode=e),modelModifiers:{trim:!0},placeholder:"e.g., SUMMER20",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Type of discount *"},{default:S((()=>[V(r,null,{default:S((()=>[V(ue,{modelValue:Ea.isDiscountPourcentage,"onUpdate:modelValue":t[5]||(t[5]=e=>Ea.isDiscountPourcentage=e)},{default:S((()=>[V(ne,{value:!0},{default:S((()=>[d(" Percentage ")])),_:1}),V(ne,{value:!1},{default:S((()=>[d(" Amount ")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Discount Value *"},{default:S((()=>[V(r,null,{default:S((()=>[V(oe,{modelValue:Ea.discount,"onUpdate:modelValue":t[6]||(t[6]=e=>Ea.discount=e),modelModifiers:{number:!0},type:"number",placeholder:Ea.isDiscountPourcentage?"e.g., 10":"e.g., 5.00",min:"0.01",step:"any",required:""},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),V(c,{label:"Start date *"},{default:S((()=>[V(r,{icon:"lucide:calendar-days"},{default:S((()=>[V(oe,{modelValue:Ea.startDate,"onUpdate:modelValue":t[7]||(t[7]=e=>Ea.startDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"End date *"},{default:S((()=>[V(r,{icon:"lucide:calendar-days"},{default:S((()=>[V(oe,{modelValue:Ea.endDate,"onUpdate:modelValue":t[8]||(t[8]=e=>Ea.endDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",Le,[V(c,{label:"Description *"},{default:S((()=>[V(r,null,{default:S((()=>[V(Fa,{modelValue:Ea.description,"onUpdate:modelValue":t[9]||(t[9]=e=>Ea.description=e),modelModifiers:{trim:!0},placeholder:"Brief description...",rows:"4",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Max uses per user *"},{default:S((()=>[V(r,{icon:"lucide:user-check"},{default:S((()=>[V(oe,{modelValue:Ea.maxNumberOfUsePerUser,"onUpdate:modelValue":t[10]||(t[10]=e=>Ea.maxNumberOfUsePerUser=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 1",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Max total uses *"},{default:S((()=>[V(r,{icon:"lucide:tag"},{default:S((()=>[V(oe,{modelValue:Ea.maxNumberOfUse,"onUpdate:modelValue":t[11]||(t[11]=e=>Ea.maxNumberOfUse=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 100",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Applies To"},{default:S((()=>[V(r,null,{default:S((()=>[V(Wa,{modelValue:Ea.isForEverybody,"onUpdate:modelValue":t[12]||(t[12]=e=>Ea.isForEverybody=e),label:"Apply to all users",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})])])],512),[[U,"index"===le.value]]),h(n("div",null,[n("div",Ae,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[13]||(t[13]=e=>Ga("index"))}),Me,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[14]||(t[14]=e=>Ga("driverlist"))})]),n("div",Ee,[n("div",Be,[n("div",Oe,[Te,V(c,{class:"mb-3",style:{width:"100%"}},{default:S((()=>[V(r,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:ce.value,"onUpdate:modelValue":t[15]||(t[15]=e=>ce.value=e),placeholder:"Search by name or email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:N({display:ce.value.length>0?"block":"none"})},[se.value?(o(),i("div",Ie," Loading... ")):0===Ba.value.length?(o(),i("div",je,' No passengers found matching "'+v(ce.value)+'". ',1)):u("",!0),ce.value.length>0?(o(!0),i(x,{key:2},D(Ba.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.id)try{const a=Na.value.some((a=>a.userId===e.id));if(ce.value="",a)return void m.info(`${e.userDetail?.firstName??"User"} is already selected.`);const l={id:e.id,userId:e.userDetail?.userId,firstName:e.userDetail?.firstName??"",lastName:e.userDetail?.lastName??"",email:e.email??"",phoneNumber:e.phoneNumber??"",couponCode:Ea.couponCode,discount:Ea.discount,maxPersonalUseNumber:Ea.maxNumberOfUsePerUser,currentPersonalUsesNumber:0,couponStartDate:Ea.startDate,couponEndDate:Ea.endDate,couponId:me()};Na.value.push(l)}catch(a){m.error("An error occurred while selecting the user."),console.error("Error in selectUser:",a)}else m.error("Cannot select invalid user data.")})(e)},[n("li",null,[d(v(e.userDetail?.firstName)+" "+v(e.userDetail?.lastName)+" ",1),n("span",Re,"("+v(e.email)+")",1)])],8,Fe)))),128)):se.value?u("",!0):(o(),i("div",$e," Start typing to search for passengers. "))],4)])]),n("div",Ge,[n("div",We,[n("p",null,"Passengers Selected ("+v(Na.value.length)+"):",1),n("div",ze,[0===Na.value.length?(o(),i("div",qe," Click passengers on the left to select. ")):u("",!0),(o(!0),i(x,null,D(Na.value,(e=>(o(),w(Qa,{key:e.userId,title:e.email,white:"",icon:"fas fa-user",onClick:a=>{var l;(l=e.userId)&&(Na.value=Na.value.filter((e=>e.userId!==l)),m.info("User removed from selection."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[U,"userlist"===le.value]]),h(n("div",null,[n("div",He,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[16]||(t[16]=e=>Ga("userlist"))}),Je,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[17]||(t[17]=e=>Ga("triplist"))})]),n("div",Ke,[n("div",Qe,[n("div",Ye,[Ze,V(c,{class:"mb-3"},{default:S((()=>[V(r,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:de.value,"onUpdate:modelValue":t[18]||(t[18]=e=>de.value=e),placeholder:"Search by name or email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:N({display:de.value.length>0?"block":"none"})},[se.value?(o(),i("div",Xe," Loading... ")):0===Oa.value.length?(o(),i("div",ea,' No drivers found matching "'+v(de.value)+'". ',1)):u("",!0),de.value.length>0?(o(!0),i(x,{key:2},D(Oa.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.email)try{const a=e.email;if(La.value.includes(a))return void m.info(`${e.userDetail?.firstName??"Driver"} is already selected.`);La.value.push(a)}catch(a){m.error("An error occurred while selecting the driver."),console.error("Error in selectDriver:",a)}else m.error("Cannot select invalid driver data (missing email).")})(e)},[n("li",null,[d(v(e.userDetail?.firstName)+" "+v(e.userDetail?.lastName)+" ",1),n("span",la,"("+v(e.email)+")",1)])],8,aa)))),128)):se.value?u("",!0):(o(),i("div",ta," Start typing to search for passengers. "))],4)])]),n("div",oa,[n("div",ia,[n("p",null,"Drivers Selected ("+v(La.value.length)+"):",1),n("div",sa,[0===La.value.length?(o(),i("div",ra," Click drivers on the left to select. ")):u("",!0),(o(!0),i(x,null,D(La.value,((e,a)=>(o(),w(Qa,{key:a,title:e,white:"",icon:"fas fa-user",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(La.value=La.value.filter((e=>e!==l)),m.info("Driver removed from selection."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[U,"driverlist"===le.value]]),h(n("div",null,[n("div",na,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[19]||(t[19]=e=>Ga("driverlist"))}),ua,ca]),n("div",da,[n("div",va,[n("div",ma,[pa,V(c,{class:"mb-3"},{default:S((()=>[V(r,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:ve.value,"onUpdate:modelValue":t[20]||(t[20]=e=>ve.value=e),placeholder:"Search departure..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:N({display:ve.value.length>0?"block":"none"})},[0===Ia.value.length?(o(),i("div",fa,' No locations found matching "'+v(ve.value)+'". ',1)):u("",!0),ve.value.length>0?(o(!0),i(x,{key:1},D(Ia.value,(e=>(o(),i("ul",{key:`dep-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(Aa.value.length>=1?m.info("Only one town can be added"):Aa.value.includes(l)?m.info(`${l} is already selected for departure.`):Aa.value.push(l))}},[n("li",null,v(e),1)],8,ha)))),128)):u("",!0)],4),n("div",ya,[n("p",null,"Selected Departures ("+v(Aa.value.length)+"):",1),n("div",ga,[0===Aa.value.length?(o(),i("div",_a," Click locations above to select. ")):u("",!0),(o(!0),i(x,null,D(Aa.value,(e=>(o(),w(Qa,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Aa.value=Aa.value.filter((e=>e!==l)),m.info("Departure location removed."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])]),n("div",ba,[n("div",Ca,[ka,V(c,{class:"mb-3"},{default:S((()=>[V(r,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:Ua.value,"onUpdate:modelValue":t[21]||(t[21]=e=>Ua.value=e),placeholder:"Search destination..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:N({display:Ua.value.length>0?"block":"none"})},[0===ja.value.length?(o(),i("div",wa,' No locations found matching "'+v(Ua.value)+'". ',1)):u("",!0),Ua.value.length>0?(o(!0),i(x,{key:1},D(ja.value,(e=>(o(),i("ul",{key:`dest-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(Ma.value.length>=1?m.info("Only one town can be added"):Ma.value.includes(l)?m.info(`${l} is already selected for destination.`):Ma.value.push(l))}},[n("li",null,v(e),1)],8,Sa)))),128)):u("",!0)],4),n("div",Va,[n("p",null,"Selected Destinations ("+v(Ma.value.length)+"):",1),n("div",Da,[0===Ma.value.length?(o(),i("div",xa," Click locations above to select. ")):u("",!0),(o(!0),i(x,null,D(Ma.value,(e=>(o(),w(Qa,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Ma.value=Ma.value.filter((e=>e!==l)),m.info("Destination location removed."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])]),Pa],512),[[U,"triplist"===le.value]])])],32)])),_:1},8,["active"])])),action:S((()=>[Ea.isForEverybody||"triplist"===le.value?(o(),w(f,{key:0,color:"primary",raised:"",loading:ee.value,disabled:ee.value||se.value,onClick:za},{default:S((()=>[d(" Create Coupon ")])),_:1},8,["loading","disabled"])):u("",!0)])),_:1},8,["open"])])),_:1},8,["active"])}}});"function"==typeof X&&X(Ua);export{Ua as default};
