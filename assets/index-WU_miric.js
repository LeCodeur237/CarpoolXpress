import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-Y56UMdgn.js";import{_ as t}from"./VLoader.vue_vue_type_style_index_0_lang-CbYSQEO1.js";import{_ as s}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-4rrBlE-A.js";import{_ as a}from"./VTags.vue_vue_type_script_setup_true_lang-HkKG9GI1.js";import{_ as i}from"./VTag.vue_vue_type_style_index_0_lang-BXCo8yno.js";import{_ as l}from"./VIconButton-CUCv5Ru5.js";import{_ as r}from"./VAvatar.vue_vue_type_style_index_0_lang-D2xYvs0s.js";import{_ as o}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-bvwFgOti.js";import{_ as c}from"./VButton.vue_vue_type_style_index_0_lang-7AzKEDfl.js";import{e as n,E as u,D as d,r as m,Q as v,w as p,o as g,t as y,v as _,x as f,A as h,m as b,Y as k,a4 as D,j as w,R as A,S as x,H as P,I as j,J as $,z as C,a6 as I,y as N,L as M,a7 as V,a1 as U,a2 as q,a8 as F}from"./index-D0hxrqC2.js";import{_ as S,a as R}from"./search-1-dark-DV4mRi9_.js";import{u as z}from"./viewWrapper-Bt2ctQXZ.js";import{u as T}from"./defaultResource-Cajrc19W.js";import{D as L}from"./datetime-xmklhC0O.js";import{u as O}from"./useNotyf-NZFZ9G1y.js";import{b as B}from"./route-block-B_A1xBdJ.js";import{_ as E}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./VFlex.vue_vue_type_style_index_0_lang-BNMWLBeL.js";import"./useFetch-Bhw7oTLc.js";import"./notyf-C-d_IrqK.js";const G=e=>(U("data-v-4ac1f3e8"),e=e(),q(),e),H={class:"list-view-toolbar"},W={class:"is-viewmode_toggler"},J=[G((()=>f("i",{class:"iconify","aria-hidden":"true","data-icon":"material-symbols-light:event-list-outline-rounded"},null,-1)))],Q=[G((()=>f("i",{class:"iconify","aria-hidden":"true","data-icon":"material-symbols-light:grid-view-outline"},null,-1)))],X={class:"search-widget ml-4",style:{width:"250px"}},Y={class:"field"},K={class:"control"},Z=["disabled"],ee=[G((()=>f("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:search"},null,-1)))],te={class:"is-profile_tabs"},se=["onClick"],ae={class:"buttons"},ie={class:"page-content-inner"},le={class:"card-grid card-grid-v3"},re=G((()=>f("img",{class:"light-image",src:S,alt:""},null,-1))),oe=G((()=>f("img",{class:"dark-image",src:R,alt:""},null,-1))),ce={class:"card-grid-item"},ne={class:"dark-inverted"},ue={class:"description"},de={class:"light-text"},me={class:"light-text"},ve={class:"is-flex gap-2 is-justify-content-center is-buttons"},pe={key:1,class:"is-list_view"},ge=G((()=>f("div",{class:"is-list_header"},[f("div",{class:"is-list_header-item",style:{width:"35%"}}," # "),f("div",{class:"is-list_header-item",style:{width:"15%"}}," Contact "),f("div",{class:"is-list_header-item",style:{width:"10%"}}," Status "),f("div",{class:"is-list_header-item",style:{width:"30%"}})],-1))),ye={class:"is-list_line"},_e={class:"is-list_line-item is-user",style:{width:"35%"}},fe=["onClick"],he={class:"is-user_metadata"},be={class:"dark-inverted"},ke={class:"is-list_line-item",style:{width:"15%"}},De={class:"light-text"},we={class:"light-text"},Ae={class:"is-list_line-item",style:{width:"10%"}},xe={class:"is-list_line-item is-actions",style:{width:"30%"}},Pe={class:"card-grid-item"},je={class:"dark-inverted"},$e={class:"description"},Ce={class:"light-text"},Ie={class:"light-text"},Ne={class:"light-text mt-4"},Me={class:"is-flex gap-2 is-justify-content-center is-buttons"},Ve=n({__name:"index",setup(n){const U=z(),q=T(),S=u(),R=d(),B=m(!1),E=m(!1),G=m(null),Ve=m([]),Ue=["Pending","Drivers","Passengers","Rejected"],qe=m("Pending"),Fe=m(""),Se=O(),Re=m("list"),ze=m({page:1,itemsPerPage:6,totalItems:0,totalPages:0}),Te=v((()=>Ve.value.filter((e=>{const t=Array.isArray(e.userDocuments)&&e.userDocuments.some((e=>"1"===e.status)),s=Array.isArray(e.userDocuments)&&e.userDocuments.some((e=>"2"===e.status)),a=Array.isArray(e.userDocuments)&&e.userDocuments.some((e=>"0"===e.status));switch(qe.value){case"Rejected":return a;case"Drivers":return t;case"Pending":return s;case"Passengers":return!t;default:return!0}})))),Le=async()=>{try{B.value=!0;let e=`/User/GetAllUsers?pageNumber=${Math.max(1,ze.value.page)}&pageSize=${ze.value.itemsPerPage}`;Fe.value&&(e+=`&search=${encodeURIComponent(Fe.value)}`);const t=await q.list(e,!0);if(t&&Array.isArray(t.data)){const e=t.data.map((async e=>{const t=await Oe(e.id);return t&&t.length>0?{...e,userDocuments:t}:{...e,userDocuments:null}}));Ve.value=await Promise.all(e),ze.value.totalItems=t.total,ze.value.totalPages=Math.ceil(t.total/ze.value.itemsPerPage)}else Ve.value=[],ze.value.totalItems=0,ze.value.totalPages=0}catch(e){console.error("An error has occurred: ",e),Ve.value=[],ze.value.totalItems=0,ze.value.totalPages=0,Se.error("Failed to load users.")}finally{B.value=!1}},Oe=async e=>{try{const t=`/UserDocument/GetByUserId?userid=${e}`;return await q.list(t)}catch(t){return Se.error(`Failed to load documents for user ${e}.`),null}},Be=async(e,t)=>{if(e)try{await q.editStatut(`/User/UserActivation?userId=${e}&isActive=${t}`)?(Se.success("User status updated successfully!"),await Le()):Se.error("Failed to update user status. Please try again.")}catch(s){console.error("Error updating user status:",s);const e=s.response?.data?.message||s.message||"Unknown error";Se.error(`Error updating status: ${e}`)}else Se.error("Invalid User ID provided.")},Ee=F((async()=>{ze.value.page=1;const e={...S.query,page:"1"};Fe.value?e.search=Fe.value:delete e.search,R.push({query:e})}),500),Ge=e=>{R.push({query:{...S.query,page:e.toString()}})};return p((()=>S.query),(async(e,t)=>{const s=e.page?parseInt(e.page):1,a=e.search||"";let i=!1;ze.value.page!==s&&(ze.value.page=s,i=!0),Fe.value!==a&&(Fe.value=a,i=!0),(i||e!==t&&!t)&&await Le()}),{immediate:!0,deep:!0}),p(Fe,(()=>{Ee()})),g((async()=>{U.setPageTitle("List of Carpoolers")})),(n,u)=>{const d=c,m=o,v=r,p=l,g=i,U=a,q=s,F=t,S=e;return y(),_("div",null,[f("div",H,[f("div",W,[f("span",{class:h(["is-viewmode","list"===b(Re)&&"is-active"]),onClick:u[0]||(u[0]=e=>Re.value="list")},J,2),f("span",{class:h(["is-viewmode","grid"===b(Re)&&"is-active"]),onClick:u[1]||(u[1]=e=>Re.value="grid")},Q,2)]),f("div",X,[f("div",Y,[f("div",K,[k(f("input",{"onUpdate:modelValue":u[2]||(u[2]=e=>w(Fe)?Fe.value=e:null),type:"text",class:"input",placeholder:"Rechercher..."},null,512),[[D,b(Fe)]]),f("button",{class:"search-button",disabled:b(Fe).length<1},ee,8,Z)])])]),f("ul",te,[(y(),_(A,null,x(Ue,((e,t)=>f("li",{key:t,class:h([e===b(qe)&&"is-active_tab","is-p_tab"]),onClick:t=>qe.value=e},N(e),11,se))),64))]),f("div",ae,[P(d,{color:"primary",icon:"feather:refresh-ccw",elevated:"",onClick:Le},{default:j((()=>[M(" Refresh ")])),_:1})])]),f("div",ie,[P(F,{active:b(B)},{default:j((()=>[f("div",le,[P(m,{class:h([0!==b(Te).length&&"is-hidden"]),title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n            search terms or filters you've entered. Please try different criteria.",larger:""},{image:j((()=>[re,oe])),_:1},8,["class"]),P(V,{name:"list",tag:"div",class:"columns is-multiline is-flex-tablet-p is-half-tablet-p"},{default:j((()=>["grid"===b(Re)?(y(!0),_(A,{key:0},x(b(Te),(e=>(y(),_("div",{key:e.id,class:"column is-4"},[f("div",ce,[P(v,{size:"large",initials:`${e.userDetail?.lastName?.[0]||""}${e.userDetail?.firstName?.[0]||""}`,squared:""},null,8,["initials"]),f("h3",ne,N(`${e.userDetail?.lastName||""} ${e.userDetail?.firstName||""}`.trim()),1),f("p",null,[M(" Account created : "),f("b",null,N(b(L).fromISO(e.creationDate).toFormat("MMMM dd, yyyy hh:mm a")),1)]),f("div",ue,[f("p",de,N(e?.email),1),f("p",me,N(e?.phoneNumber),1)]),f("div",ve,[P(d,{color:"info",icon:"material-symbols-light:visibility-outline",elevated:"",to:`/app/carpoolers/${e.id}`},{default:j((()=>[M(" View Profile ")])),_:2},1032,["to"]),P(p,{style:{background:"var(--danger) !important",color:"#fff"},color:"danger",disabled:"",squared:"",icon:"material-symbols-light:restore-from-trash-outline",title:"Delete (disabled)"}),e.isActive?(y(),$(p,{key:0,icon:"lucide:circle-slash-2",color:"danger",title:"Deactivate profile",onClick:t=>Be(e.id,!1)},null,8,["onClick"])):C("",!0),e.isActive?C("",!0):(y(),$(p,{key:1,icon:"lucide:circle",color:"success",title:"Activate profile",onClick:t=>Be(e.id,!0)},null,8,["onClick"]))])])])))),128)):(y(),_("div",pe,[ge,(y(!0),_(A,null,x(b(Te),(e=>(y(),_("div",{key:e.id,class:""},[f("div",ye,[f("div",_e,[f("div",{style:{cursor:"pointer"},onClick:()=>{G.value=e,E.value=!0}},[P(v,{size:"large",initials:`${e.userDetail?.lastName?.[0]||""}${e.userDetail?.firstName?.[0]||""}`,badge:e.badge,squared:""},null,8,["initials","badge"])],8,fe),f("div",he,[f("h3",be,N(`${e.userDetail?.lastName||""} ${e.userDetail?.firstName||""}`.trim()),1),f("p",null,[M(" Account created : "),f("b",null,N(b(L).fromISO(e.creationDate).toFormat("MMMM dd, yyyy")),1)])])]),f("div",ke,[f("p",De,N(e?.email),1),f("p",we,N(e?.phoneNumber),1)]),f("div",Ae,[P(U,null,{default:j((()=>[e.isActive?C("",!0):(y(),$(g,{key:0,color:"danger",label:"Deactivated",rounded:""})),e.isActive?(y(),$(g,{key:1,color:"success",label:"Active",rounded:""})):C("",!0)])),_:2},1024)]),f("div",xe,[P(d,{color:"info",icon:"material-symbols-light:visibility-outline",elevated:"",to:`/app/carpoolers/${e.id}`},{default:j((()=>[M(" View Profile ")])),_:2},1032,["to"]),P(p,{style:{background:"var(--danger) !important",color:"#fff"},color:"danger",disabled:"",squared:"",icon:"material-symbols-light:restore-from-trash-outline",title:"Delete (disabled)"}),e.isActive?(y(),$(p,{key:0,icon:"lucide:circle-slash-2",color:"danger",title:"Deactivate profile",onClick:t=>Be(e.id,!1)},null,8,["onClick"])):C("",!0),e.isActive?C("",!0):(y(),$(p,{key:1,icon:"lucide:circle",color:"success",title:"Activate profile",onClick:t=>Be(e.id,!0)},null,8,["onClick"]))])])])))),128))]))])),_:1}),P(q,{"item-per-page":b(ze).itemsPerPage,"total-items":b(ze).totalItems,"current-page":b(ze).page,"max-links-displayed":4,"no-router":"","onUpdate:currentPage":Ge},null,8,["item-per-page","total-items","current-page"])])])),_:1},8,["active"])]),(y(),$(I,{to:"body"},[b(E)&&b(G)?(y(),$(S,{key:0,open:b(E),"onUpdate:open":u[5]||(u[5]=e=>w(E)?E.value=e:null),title:"User Details",size:"medium",nobg:"",noheader:"",noaction:"",onClose:u[6]||(u[6]=()=>E.value=!1)},{content:j((()=>[f("div",Pe,[P(v,{size:"big",initials:`${b(G).userDetail?.lastName?.[0]||""}${b(G).userDetail?.firstName?.[0]||""}`,badge:b(G).badge,squared:""},null,8,["initials","badge"]),f("h3",je,N(`${b(G).userDetail?.lastName||""} ${b(G).userDetail?.firstName||""}`.trim()),1),f("p",null,[M(" Account created : "),f("b",null,N(b(L).fromISO(b(G).creationDate).toFormat("MMMM dd, yyyy hh:mm a")),1)]),f("div",$e,[f("p",Ce,N(b(G)?.email),1),f("p",Ie,N(b(G)?.phoneNumber),1),f("em",Ne,[M(" I'm "),f("b",null,N(!0===b(G)?.isCodeVerified?"a carpooler":"just a client"),1)])]),f("div",Me,[P(d,{color:"info",icon:"material-symbols-light:visibility-outline",elevated:"",to:`/app/carpoolers/${b(G).id}`},{default:j((()=>[M(" View Profile ")])),_:1},8,["to"]),P(p,{style:{background:"var(--danger) !important",color:"#fff"},color:"danger",disabled:"",squared:"",icon:"material-symbols-light:restore-from-trash-outline",title:"Delete (disabled)"}),!0===b(G).isActive?(y(),$(p,{key:0,icon:"lucide:circle-slash-2",color:"danger",title:"Deactivate profile",onClick:u[3]||(u[3]=e=>Be(b(G).id,!1))})):C("",!0),!0!==b(G).isActive?(y(),$(p,{key:1,icon:"lucide:circle",color:"success",title:"Activate profile",onClick:u[4]||(u[4]=e=>Be(b(G).id,!0))})):C("",!0)])])])),action:j((()=>[])),_:1},8,["open"])):C("",!0)]))])}}});"function"==typeof B&&B(Ve);const Ue=E(Ve,[["__scopeId","data-v-4ac1f3e8"]]);export{Ue as default};
