import{_ as e}from"./VLoader.vue_vue_type_style_index_0_lang-BZ9hFhMK.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-CvENM6EH.js";import{_ as s}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-SOiQ5egb.js";import{_ as i}from"./VButton.vue_vue_type_style_index_0_lang-ChQG4uz7.js";import{e as l,r as a,Q as r,o as n,t as o,v as d,x as u,Y as c,a4 as m,m as h,j as v,R as y,S as p,H as _,I as f,A as g,y as w,L as x,J as P}from"./index-BmU4ZD6R.js";import{_ as b,a as j}from"./search-1-dark-DV4mRi9_.js";import{u as D}from"./viewWrapper-Ca5MwF68.js";import{u as R}from"./defaultResource-D_X989iq.js";import{_ as C}from"./VTag.vue_vue_type_style_index_0_lang-2VCV-lGe.js";import{f as k}from"./common-CvuSpKng.js";import{D as z}from"./datetime-xmklhC0O.js";import{b as N}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useNotyf-C4Q0if2M.js";import"./notyf-CBduEkA9.js";import"./useFetch-BNEmLZ4H.js";const A={class:"list-view-toolbar"},I={class:"search-widget",style:{width:"300px"}},S={class:"field"},E={class:"control"},F=["disabled"],O=[u("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:search"},null,-1)],T={class:"is-profile_tabs"},V=["onClick"],J={class:"buttons"},L={class:"page-content-inner"},M=u("img",{class:"light-image",src:b,alt:""},null,-1),U=u("img",{class:"dark-image",src:j,alt:""},null,-1),W={key:1,class:"is-list_view"},Y=u("div",{class:"is-list_header"},[u("div",{class:"is-list_header-item",style:{width:"15%"}}," Driver "),u("div",{class:"is-list_header-item",style:{width:"10%"}}," Itinerary "),u("div",{class:"is-list_header-item",style:{width:"10%"}}," DateTime "),u("div",{class:"is-list_header-item",style:{width:"5%"}}," Nbr "),u("div",{class:"is-list_header-item",style:{width:"10%"}}," Type "),u("div",{class:"is-list_header-item",style:{width:"10%"}}," PT "),u("div",{class:"is-list_header-item",style:{width:"5%"}}," Canc? "),u("div",{class:"is-list_header-item",style:{width:"5%"}}," Paid? "),u("div",{class:"is-list_header-item",style:{width:"5%"}}," Fund? "),u("div",{class:"is-list_header-item",style:{width:"12%","text-align":"center"}}," Profit "),u("div",{class:"is-list_header-item",style:{width:"10%"}}," Due Date ")],-1),$={class:"is-list_line-item is-user",style:{width:"15%"}},B={class:"is-user_metadata"},G={class:"has-text-primary is-underlined"},H={class:"is-list_line-item",style:{width:"10%"}},Q={class:"is-list_line-item",style:{width:"10%"}},q={class:"is-list_line-item",style:{width:"5%"}},K={class:"is-list_line-item",style:{width:"10%"}},X={style:{"font-size":"0.75rem"}},Z={class:"is-list_line-item",style:{width:"10%"}},ee={style:{"font-size":"0.85rem"}},te={class:"is-list_line-item",style:{width:"5%"}},se={style:{"font-size":"0.75rem"}},ie={class:"is-list_line-item",style:{width:"5%"}},le=u("small",{style:{"font-size":"0.75rem"}},"soon",-1),ae={class:"is-list_line-item",style:{width:"5%"}},re=u("small",{style:{"font-size":"0.75rem"}},"soon",-1),ne={class:"is-list_line-item",style:{width:"12%","text-align":"center"}},oe={style:{"font-size":"0.85rem","text-align":"center"},class:"ml-2"},de={class:"is-list_line-item",style:{width:"10%"}},ue=l({__name:"index",setup(l){const b=D(),j=R(),N=["All","Pending","Completed","Canceled"],ue=a(""),ce=a(!1),me=a({currentPage:1,perPage:9,total:0}),he=a("All"),ve=a([]),ye=e=>{const t=z.fromISO(e).plus({hours:6});return z.now()>t},pe=e=>{me.value.currentPage=e},_e=r((()=>{let e=ve.value.filter((e=>e.user)).filter((e=>"All"===he.value||("Pending"===he.value?"1"===e.status&&!ye(e.travelingDate):"Completed"===he.value?"2"===e.status||ye(e.travelingDate):"Canceled"===he.value?"0"===e.status:void 0)));!ue.value||ue.value.length<1||(e=e.filter((e=>e.user?.userDetail?.firstName?.match(new RegExp(ue.value,"i"))||e.user?.userDetail?.lastName?.match(new RegExp(ue.value,"i"))||e.user?.email?.match(new RegExp(ue.value,"i"))||e.departurePoint?.city?.match(new RegExp(ue.value,"i"))||e.departurePoint?.address?.match(new RegExp(ue.value,"i"))||e.destinationPoint?.city?.match(new RegExp(ue.value,"i"))||e.destinationPoint?.address?.match(new RegExp(ue.value,"i"))))),me.value.total=e.length;const t=(me.value.currentPage-1)*me.value.perPage,s=t+me.value.perPage;return e.slice(t,s)})),fe=e=>e.listOfReservations?k(e.listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,t)=>e+t.totalAmount),0)):k(0);return n((async()=>{b.setPageTitle("List of Journeys"),await(async()=>{try{ce.value=!0;const e=await j.list("/DriverJourney/GetAllJourney");if(me.value.total=e.length,e){const t=await Promise.all(e.map((async e=>{const t=await j.list(`/User/FindUserById?userid=${e.userId}`);return{...e,user:t}})));ve.value=t}}catch(e){console.error("An error has occurred: ",e)}finally{ce.value=!1}})()})),(l,a)=>{const r=i,n=s,b=t,j=e;return o(),d("div",null,[u("div",A,[u("div",I,[u("div",S,[u("div",E,[c(u("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>v(ue)?ue.value=e:null),type:"text",class:"input",placeholder:"Rechercher..."},null,512),[[m,h(ue)]]),u("button",{class:"search-button",disabled:h(ue).length<1},O,8,F)])])]),u("ul",T,[(o(),d(y,null,p(N,((e,t)=>u("li",{key:t,class:g([e===h(he)&&"is-active_tab","is-p_tab"]),onClick:t=>he.value=e},w(e),11,V))),64))]),u("div",J,[_(r,{color:"primary",icon:"feather:refresh-ccw",elevated:"",rounded:""},{default:f((()=>[x(" Refresh ")])),_:1})])]),_(j,{active:h(ce)},{default:f((()=>[u("div",L,[0===h(_e).length?(o(),P(n,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n              filter terms you've entered. Please try different filter terms or\n              criteria.",larger:""},{image:f((()=>[M,U])),_:1})):(o(),d("div",W,[Y,(o(!0),d(y,null,p(h(_e),(e=>{return o(),d("div",{key:e.id,class:"is-list_line"},[u("div",$,[u("div",B,[u("h3",null,w(`${e.user?.userDetail?.lastName} ${e.user?.userDetail?.firstName}`),1),u("p",null,w((t=e.user?.email,s=18,t?t.length>s?t.slice(0,s)+"...":t:"")),1),u("p",G,w(e.user?.phoneNumber),1)])]),u("div",H,[u("p",null,"from "+w(e?.departurePoint?.city??"City"),1),u("p",null,"to "+w(e?.destinationPoint?.city??"City"),1)]),u("div",Q,[u("p",null,w(h(z).fromISO(e.travelingDate).toFormat("dd/MM/yy")),1),u("p",null,[u("small",null,[u("b",null,w(h(z).fromISO(e.travelingDate).toFormat("hh:mm a")),1)])])]),u("div",q,[u("span",null,w(e.maxSeats-e.avalableSeets),1)]),u("div",K,[_(C,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:e.isPaiementCash?"success":"info"},{default:f((()=>[u("small",X,w(e.isPaiementCash?"cash":"in-app"),1)])),_:2},1032,["color"])]),u("div",Z,[u("b",ee,w(fe(e)),1)]),u("div",te,[_(C,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"1"===e.status?"success":"warning"},{default:f((()=>[u("small",se,w("1"===e.status?"No":"Yes"),1)])),_:2},1032,["color"])]),u("div",ie,[_(C,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"warning"},{default:f((()=>[le])),_:1})]),u("div",ae,[_(C,{size:"tiny",style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"warning"},{default:f((()=>[re])),_:1})]),u("div",ne,[_(C,{color:fe(e).length>1?"success":"danger",size:"tiny"},{default:f((()=>[u("b",oe,w(fe(e)?h(k)(e.listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,t)=>e+t.totalAmount),0)):h(k)(0)),1)])),_:2},1032,["color"])]),u("div",de,[u("p",null,[u("b",null,w(h(z).fromISO(e.travelingDate).plus({days:5}).toFormat("dd/MM/yy")),1)])])]);var t,s})),128))])),_(b,{"current-page":h(me).currentPage,"onUpdate:currentPage":[a[1]||(a[1]=e=>h(me).currentPage=e),pe],"item-per-page":h(me).perPage,"total-items":h(me).total,"max-links-displayed":7,"no-router":""},null,8,["current-page","item-per-page","total-items"])])])),_:1},8,["active"])])}}});"function"==typeof N&&N(ue);export{ue as default};
