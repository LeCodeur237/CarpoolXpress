import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-BvL6dH9m.js";import{_ as s}from"./VIconButton-C6tnjQ2g.js";import{_ as i}from"./VLoader.vue_vue_type_style_index_0_lang-BZ9hFhMK.js";import{_ as t}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-CvENM6EH.js";import{_ as a}from"./VAvatar.vue_vue_type_style_index_0_lang--Bh0WskI.js";import{_ as l}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-SOiQ5egb.js";import{_ as r}from"./VButton.vue_vue_type_style_index_0_lang-ChQG4uz7.js";import{e as n,r as d,Q as o,w as u,o as c,t as m,v as p,x as v,A as h,m as _,Y as f,a4 as y,j as g,R as w,S as P,H as b,I as x,J as C,z as D,a5 as j,y as k,L as N,a7 as R}from"./index-BmU4ZD6R.js";import{_ as V,a as A}from"./search-1-dark-DV4mRi9_.js";import{u as $}from"./viewWrapper-Ca5MwF68.js";import{u as z}from"./defaultResource-D_X989iq.js";import{_ as O}from"./VTag.vue_vue_type_style_index_0_lang-2VCV-lGe.js";import{f as S,r as E}from"./common-CvuSpKng.js";import{D as U}from"./datetime-xmklhC0O.js";import{b as I}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./useNotyf-C4Q0if2M.js";import"./notyf-CBduEkA9.js";import"./useFetch-BNEmLZ4H.js";const F={class:"list-view-toolbar"},T={class:"is-viewmode_toggler"},J=[v("i",{class:"iconify","aria-hidden":"true","data-icon":"material-symbols-light:event-list-outline-rounded"},null,-1)],L=[v("i",{class:"iconify","aria-hidden":"true","data-icon":"material-symbols-light:grid-view-outline"},null,-1)],q={class:"search-widget ml-4",style:{width:"300px"}},B={class:"field"},M={class:"control"},W=["disabled"],G=[v("i",{"aria-hidden":"true",class:"iconify","data-icon":"feather:search"},null,-1)],Y={class:"is-profile_tabs"},H=["onClick"],Q={class:"buttons"},K={class:"page-content-inner"},X=v("img",{class:"light-image",src:V,alt:""},null,-1),Z=v("img",{class:"dark-image",src:A,alt:""},null,-1),ee={key:0,class:"is-trips_container is-grid grid-cols-3 gap-4"},se={class:"is-tc_head"},ie={class:"is-tch_meta"},te={class:"has-text-primary is-underlined"},ae={class:"is-tc_body"},le={class:"is-dest_elt"},re=v("i",{class:"iconify has-text-primary","aria-hidden":"true","data-icon":"solar:map-point-bold-duotone"},null,-1),ne={class:"is-dest_details"},de={class:"is-dest_elt"},oe=v("i",{class:"iconify has-text-success","aria-hidden":"true","data-icon":"solar:map-point-bold-duotone"},null,-1),ue={class:"is-dest_details"},ce=v("div",{class:"is-dest_elt_divider"},null,-1),me={class:"is-tc_footer"},pe={class:"is-tcf_l"},ve=v("i",{class:"iconify","data-icon":"solar:chair-2-line-duotone","aria-hidden":"true"},null,-1),he={class:"is-tcf_r"},_e=v("small",null,"Profit",-1),fe={style:{"font-size":"0.95rem"},class:"ml-2"},ye={key:1,class:"is-list_view"},ge=v("div",{class:"is-list_header"},[v("div",{class:"is-list_header-item",style:{width:"25%"}}," # "),v("div",{class:"is-list_header-item",style:{width:"15%"}}," From "),v("div",{class:"is-list_header-item",style:{width:"15%"}}," To "),v("div",{class:"is-list_header-item",style:{width:"15%"}}," Traveling Date "),v("div",{class:"is-list_header-item",style:{width:"10%"}}," Seats "),v("div",{class:"is-list_header-item",style:{width:"10%"}}," PU "),v("div",{class:"is-list_header-item",style:{width:"10%"}}," Profit ")],-1),we={class:"is-list_line-item is-user",style:{width:"25%"}},Pe=["onClick"],be={class:"is-user_metadata"},xe={class:"has-text-primary is-underlined"},Ce={class:"is-list_line-item",style:{width:"15%"}},De={class:"is-list_line-item",style:{width:"15%"}},je={class:"is-list_line-item",style:{width:"15%"}},ke={class:"is-list_line-item",style:{width:"10%"}},Ne={class:"is-list_line-item",style:{width:"10%"}},Re={style:{"font-size":"0.95rem"},class:"ml-2"},Ve={class:"is-list_line-item",style:{width:"10%"}},Ae={style:{"font-size":"0.95rem"},class:"ml-2"},$e={class:"is-trip_elt"},ze={class:"is-tc_head"},Oe={class:"is-tch_meta"},Se={class:"has-text-primary is-underlined"},Ee={class:"is-tc_body"},Ue={class:"is-dest_elt"},Ie=v("i",{class:"iconify has-text-primary","aria-hidden":"true","data-icon":"solar:map-point-bold-duotone"},null,-1),Fe={class:"is-dest_details"},Te={class:"is-dest_elt"},Je=v("i",{class:"iconify has-text-success","aria-hidden":"true","data-icon":"solar:map-point-bold-duotone"},null,-1),Le={class:"is-dest_details"},qe=v("div",{class:"is-dest_elt_divider"},null,-1),Be={class:"is-tc_footer"},Me={class:"is-tcf_l"},We=v("i",{class:"iconify","data-icon":"solar:chair-2-line-duotone","aria-hidden":"true"},null,-1),Ge={class:"is-tcf_r"},Ye=v("small",null,"Profit",-1),He={style:{"font-size":"0.95rem"},class:"ml-2"},Qe=n({__name:"index",setup(n){const V=$(),A=z(),I=["All","Pending","Completed","Canceled"],Qe=d(""),Ke=d(!1),Xe=d(!1),Ze=d("list"),es=d({currentPage:1,perPage:9,total:0}),ss=d("All"),is=d(),ts=d([]),as=e=>{const s=U.fromISO(e).plus({hours:6});return U.now()>s},ls=e=>{es.value.currentPage=e},rs=o((()=>{let e=ts.value.filter((e=>e.user)).filter((e=>"All"===ss.value||("Pending"===ss.value?"1"===e.status&&!as(e.travelingDate):"Completed"===ss.value?"2"===e.status||as(e.travelingDate):"Canceled"===ss.value?"0"===e.status:void 0)));!Qe.value||Qe.value.length<1||(e=e.filter((e=>e.user?.userDetail?.firstName?.match(new RegExp(Qe.value,"i"))||e.user?.userDetail?.lastName?.match(new RegExp(Qe.value,"i"))||e.user?.email?.match(new RegExp(Qe.value,"i"))||e.departurePoint?.city?.match(new RegExp(Qe.value,"i"))||e.departurePoint?.address?.match(new RegExp(Qe.value,"i"))||e.destinationPoint?.city?.match(new RegExp(Qe.value,"i"))||e.destinationPoint?.address?.match(new RegExp(Qe.value,"i"))||e.travelingDate?.match(new RegExp(Qe.value,"i"))))),es.value.total=e.length;const s=(es.value.currentPage-1)*es.value.perPage,i=s+es.value.perPage;return e.slice(s,i)})),ns=async()=>{try{Ke.value=!0;const e=await A.list("/DriverJourney/GetAllJourney");if(es.value.total=e.length,e){const s=await Promise.all(e.map((async e=>{const s=await A.list(`/User/FindUserById?userid=${e.userId}`);return{...e,user:s}})));ts.value=s}}catch(e){console.error("An error has occurred: ",e)}finally{Ke.value=!1}},ds=R((async()=>{es.value.currentPage=1,await ns()}),500);return u(Qe,(()=>{ds()})),u(ss,(()=>{es.value.currentPage=1,ds()})),c((async()=>{V.setPageTitle("List of Journeys"),await ns()})),(n,d)=>{const o=r,u=l,c=a,R=t,V=i,A=s,$=e;return m(),p("div",null,[v("div",F,[v("div",T,[v("span",{class:h(["is-viewmode","list"===_(Ze)&&"is-active"]),onClick:d[0]||(d[0]=e=>Ze.value="list")},J,2),v("span",{class:h(["is-viewmode","grid"===_(Ze)&&"is-active"]),onClick:d[1]||(d[1]=e=>Ze.value="grid")},L,2)]),v("div",q,[v("div",B,[v("div",M,[f(v("input",{"onUpdate:modelValue":d[2]||(d[2]=e=>g(Qe)?Qe.value=e:null),type:"text",class:"input",placeholder:"Rechercher..."},null,512),[[y,_(Qe)]]),v("button",{class:"search-button",disabled:_(Qe).length<1},G,8,W)])])]),v("ul",Y,[(m(),p(w,null,P(I,((e,s)=>v("li",{key:s,class:h([e===_(ss)&&"is-active_tab","is-p_tab"]),onClick:s=>ss.value=e},k(e),11,H))),64))]),v("div",Q,[b(o,{color:"primary",icon:"feather:refresh-ccw",elevated:"",rounded:""},{default:x((()=>[N(" Refresh ")])),_:1})])]),b(V,{active:_(Ke)},{default:x((()=>[v("div",K,[0===_(rs).length?(m(),C(u,{key:0,title:"We couldn't find any matching results.",subtitle:"Too bad. Looks like we couldn't find any matching results for the\n              filter terms you've entered. Please try different filter terms or\n              criteria.",larger:""},{image:x((()=>[X,Z])),_:1})):(m(),p(w,{key:1},["grid"===_(Ze)?(m(),p("div",ee,[(m(!0),p(w,null,P(_(rs),(e=>(m(),p("div",{key:e.id,class:"is-trip_elt"},[v("div",se,[b(c,{squared:"",size:"big",picture:`data:image/jpeg;base64,${e.user?.profilePhoto?.photo}`,initials:`${e.user?.userDetail?.lastName[0]}${e.user?.userDetail?.firstName[0]}`},null,8,["picture","initials"]),v("div",ie,[v("h3",null,k(`${e.user?.userDetail?.lastName} ${e.user?.userDetail?.firstName}`),1),v("span",null,k(e.user?.email),1),v("span",te,k(e.user?.phoneNumber),1),b(O,{size:"tiny",color:e.user?.isCodeVerified?"success":"danger",style:{width:"fit-content","line-height":"1.6"}},{default:x((()=>[N(k(e.user?.isCodeVerified?"Verified":"Not Verified"),1)])),_:2},1032,["color"])])]),v("div",ae,[v("div",le,[re,v("div",ne,[v("h4",null,k(e?.departurePoint?.city??"City"),1),v("span",null,k(e?.departurePoint?.address??"Address"),1)])]),v("div",de,[oe,v("div",ue,[v("h4",null,k(e?.destinationPoint?.city??"City"),1),v("span",null,k(e?.destinationPoint?.address??"Address"),1)])]),ce]),v("div",me,[v("div",pe,[ve,v("span",null,k(e.avalableSeets)+" available seat(s)",1)]),v("div",he,[b(O,{style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"primary"},{default:x((()=>[_e,v("b",fe,k(e.listOfReservations?_(S)(e.listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,s)=>e+s.totalAmount),0)):_(S)(0)),1)])),_:2},1024),v("span",null,k(_(E)(e.travelingDate)),1)])])])))),128))])):(m(),p("div",ye,[ge,(m(!0),p(w,null,P(_(rs),(e=>(m(),p("div",{key:e.id,class:"is-list_line"},[v("div",we,[v("div",{onClick:()=>{is.value=e,Xe.value=!0}},[b(c,{squared:"",size:"medium",picture:`data:image/jpeg;base64,${e.user?.profilePhoto?.photo}`,initials:`${e.user?.userDetail?.lastName[0]}${e.user?.userDetail?.firstName[0]}`},null,8,["picture","initials"])],8,Pe),v("div",be,[v("h3",null,k(`${e.user?.userDetail?.lastName} ${e.user?.userDetail?.firstName}`),1),v("p",null,k(e.user?.email),1),v("p",xe,k(e.user?.phoneNumber),1)])]),v("div",Ce,[v("p",null,k(e?.departurePoint?.city??"City"),1),v("span",null,k(e?.departurePoint?.address??"Address"),1)]),v("div",De,[v("p",null,k(e?.destinationPoint?.city??"City"),1),v("span",null,k(e?.destinationPoint?.address??"Address"),1)]),v("div",je,[v("span",null,k(_(U).fromISO(e.travelingDate).toFormat("dd/MM/yy, hh:mm a")),1)]),v("div",ke,[v("p",null,k(e.listOfReservations?.length??0)+" / "+k(e.avalableSeets),1)]),v("div",Ne,[v("b",Re,k(_(S)(e.amountPerSeet)),1)]),v("div",Ve,[b(O,{style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"success"},{default:x((()=>[v("b",Ae,k(e.listOfReservations?_(S)(e.listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,s)=>e+s.totalAmount),0)):_(S)(0)),1)])),_:2},1024)])])))),128))])),b(R,{"current-page":_(es).currentPage,"onUpdate:currentPage":[d[3]||(d[3]=e=>_(es).currentPage=e),ls],"item-per-page":_(es).perPage,"total-items":_(es).total,"max-links-displayed":7,"no-router":""},null,8,["current-page","item-per-page","total-items"])],64))])])),_:1},8,["active"]),(m(),C(j,{to:"body"},[_(Xe)?(m(),C($,{key:0,open:_(Xe),"onUpdate:open":d[5]||(d[5]=e=>g(Xe)?Xe.value=e:null),title:"User Details",size:"large",nobg:"",noaction:"",noheader:"",onClose:d[6]||(d[6]=()=>Xe.value=!1)},{content:x((()=>[v("div",$e,[v("div",ze,[b(c,{squared:"",size:"big",picture:`data:image/jpeg;base64,${_(is).user?.profilePhoto?.photo}`,initials:`${_(is).user?.userDetail?.lastName[0]}${_(is).user?.userDetail?.firstName[0]}`},null,8,["picture","initials"]),v("div",Oe,[v("h3",null,k(`${_(is).user?.userDetail?.lastName} ${_(is).user?.userDetail?.firstName}`),1),v("span",null,k(_(is).user?.email),1),v("span",Se,k(_(is).user?.phoneNumber),1),b(A,{icon:"feather:x",circle:"",class:"modal-close-button",onClick:d[4]||(d[4]=e=>Xe.value=!1)}),b(O,{size:"tiny",color:_(is).user?.isCodeVerified?"success":"danger",style:{width:"fit-content","line-height":"1.6"}},{default:x((()=>[N(k(_(is).user?.isCodeVerified?"Verified":"Not Verified"),1)])),_:1},8,["color"])])]),v("div",Ee,[v("div",Ue,[Ie,v("div",Fe,[v("h4",null,k(_(is)?.departurePoint?.city??"City"),1),v("span",null,k(_(is)?.departurePoint?.address??"Address"),1)])]),v("div",Te,[Je,v("div",Le,[v("h4",null,k(_(is)?.destinationPoint?.city??"City"),1),v("span",null,k(_(is)?.destinationPoint?.address??"Address"),1)])]),qe]),v("div",Be,[v("div",Me,[We,v("span",null,k(_(is).avalableSeets)+" available seat(s)",1)]),v("div",Ge,[b(O,{style:{width:"fit-content","line-height":"1.6",display:"flex"},color:"primary"},{default:x((()=>[Ye,v("b",He,k(_(is).listOfReservations?_(S)(_(is).listOfReservations?.filter((e=>"1"==e.isCanceled)).reduce(((e,s)=>e+s.totalAmount),0)):_(S)(0)),1)])),_:1}),v("span",null,k(_(E)(_(is).travelingDate)),1)])])])])),action:x((()=>[])),_:1},8,["open"])):D("",!0)]))])}}});"function"==typeof I&&I(Qe);export{Qe as default};
