import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-BvL6dH9m.js";import{_ as a}from"./VLoader.vue_vue_type_style_index_0_lang-BZ9hFhMK.js";import{e as l,Q as t,t as o,v as i,A as r,m as s,x as n,z as u,M as c,L as d,y as v,an as m,ao as p,r as f,Y as h,a4 as y,j as g,f as _,o as b,w as C,G as k,J as w,I as S,H as V,S as x,R as D,a6 as P,aq as U,ar as A,K as L}from"./index-BmU4ZD6R.js";import{_ as N}from"./VIcon.vue_vue_type_script_setup_true_lang-CtUU6kqT.js";import{_ as M}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-3qq82m-G.js";import{u as E,_ as B}from"./VControl-p2ZM4MbM.js";import{_ as O,a as T}from"./VOption.vue_vue_type_style_index_0_lang-_AUsGs7v.js";import{_ as I}from"./VInput.vue_vue_type_script_setup_true_lang-DScCmNrG.js";import{_ as j}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-CvENM6EH.js";import{a as F,_ as R}from"./VFlexTable.vue_vue_type_style_index_0_lang-l2Dfpy__.js";import{_ as $}from"./VIconButton-C6tnjQ2g.js";import{_ as G}from"./VTag.vue_vue_type_style_index_0_lang-2VCV-lGe.js";import{_ as W}from"./VAvatarStack.vue_vue_type_script_setup_true_lang-B_wxigAz.js";import{_ as z}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-SOiQ5egb.js";import{_ as q}from"./VButtons.vue_vue_type_script_setup_true_lang-CCRhqst-.js";import{_ as H}from"./VButton.vue_vue_type_style_index_0_lang-ChQG4uz7.js";import{_ as J}from"./VField.vue_vue_type_script_setup_true_lang-DaS4v5xb.js";import{u as K}from"./viewWrapper-Ca5MwF68.js";import{u as Q}from"./defaultResource-D_X989iq.js";import{D as Y}from"./datetime-xmklhC0O.js";import{u as Z}from"./useNotyf-C4Q0if2M.js";import{b as X}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./VAvatar.vue_vue_type_style_index_0_lang--Bh0WskI.js";import"./useFetch-BNEmLZ4H.js";import"./notyf-CBduEkA9.js";const ee=["data-icon"],ae={key:1,class:"snack-media"},le=["src"],te={class:"snack-text"},oe={class:"snack-action"},ie=l({__name:"VSnack",props:{title:{},icon:{default:void 0},image:{default:void 0},placeholder:{default:"https://via.placeholder.com/50x50"},color:{default:void 0},size:{default:void 0},solid:{type:Boolean},white:{type:Boolean}},setup(e){const a=e;function l(e){e.target.src=a.placeholder}const m=t((()=>a.icon&&-1!==a.icon.indexOf(":")));return(e,t)=>(o(),i("div",{class:r(["snack",[a.white&&"is-white",a.size&&`is-${a.size}`]])},[a.icon?(o(),i("div",{key:0,class:r(["snack-media is-icon",[a.color&&`is-${a.color}`,a.solid&&"is-solid"]])},[s(m)?(o(),i("i",{key:0,"aria-hidden":"true",class:"iconify snack-icon","data-icon":e.icon},null,8,ee)):(o(),i("i",{key:1,"aria-hidden":"true",class:r(["snack-icon",a.icon])},null,2))],2)):a.image?(o(),i("div",ae,[n("img",{class:"avatar",src:a.image,alt:"",onErrorOnce:l},null,40,le)])):u("",!0),n("span",te,[c(e.$slots,"title",{},(()=>[d(v(a.title),1)]))]),n("span",oe,[c(e.$slots,"default")])],2))}}),re=["id","name"],se=l({__name:"VTextarea",props:m({raw:{type:Boolean},autogrow:{type:Boolean}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=p(e,"modelValue"),l=e,{field:n,id:u}=E({create:!1,help:"VTextarea"}),c=f(),d=t({get:()=>n?.value?n.value.value:a.value,set(e){n?.value&&n.value.setValue(e),a.value=e}});function v(){c.value&&l.autogrow&&(c.value.style.height="auto",c.value.style.height=c.value.scrollHeight+"px")}const m=t((()=>l.raw?[]:["textarea"]));return(e,a)=>h((o(),i("textarea",{id:s(u),ref_key:"textareaRef",ref:c,"onUpdate:modelValue":a[0]||(a[0]=e=>g(d)?d.value=e:null),class:r(s(m)),name:s(u),onChange:a[1]||(a[1]=(...e)=>s(n)?.handleChange&&s(n)?.handleChange(...e)),onBlur:a[2]||(a[2]=(...e)=>s(n)?.handleBlur&&s(n)?.handleBlur(...e)),onInput:v},null,42,re)),[[y,s(d)]])}}),ne=["Abbotsford","Airdrie","Ajax","Alma","Amos","Aurora","Barrie","Beaconsfield","Belleville","Blainville","Boisbriand","Boucherville","Bradford West Gwillimbury","Brampton","Brandon","Brantford","Brockville","Brossard","Burlington","Burnaby","Caledon","Calgary","Cambridge","Campbell River","Camrose","Candiac","Cape Breton","Chambly","Charlottetown","Châteauguay","Chatham-Kent","Chilliwack","Clarence-Rockland","Clarington","Cobourg","Cochrane","Coquitlam","Cornwall","Côte Saint-Luc","Courtenay","Cranbrook","Dartmouth","Delta","Deux-Montagnes","Dieppe","Dollard-des-Ormeaux","Dorval","Drummondville","Duncan","East Gwillimbury","Edmonton","Edmundston","Etobicoke","Fort Erie","Fort McMurray","Fort Saskatchewan","Fort St. John","Fredericton","Gatineau","Georgina","Glace Bay","Granby","Grande Prairie","Greater Sudbury","Grimsby","Guelph","Halifax","Halton Hills","Hamilton","Huntsville","Innisfil","Joliette","Kamloops","Kawartha Lakes","Kelowna","Kenora","Kingston","Kirkland","Kitchener","La Prairie","Lachute","Lacombe","Ladysmith","Lake Country","Langford","Langley (City)","Langley (District)","Laval","Leamington","Leduc","Lethbridge","Lévis","Lincoln","Lloydminster","London","Longueuil","Magog","Maple Ridge","Markham","Mascouche","Medicine Hat","Midland","Milton","Mirabel","Miramichi","Mississauga","Moncton","Mont-Royal","Mont-Saint-Hilaire","Montreal","Moose Jaw","Mount Pearl","Nanaimo","New Glasgow","New Tecumseth","New Westminster","Newmarket","Niagara Falls","Norfolk County","North Battleford","North Bay","North Cowichan","North Vancouver (City)","North Vancouver (District)","Oak Bay","Oakville","Okotoks","Orangeville","Orillia","Oshawa","Ottawa","Owen Sound","Parksville","Pembroke","Penticton","Peterborough","Pickering","Pitt Meadows","Pointe-Claire","Port Alberni","Port Colborne","Port Coquitlam","Port Moody","Powell River","Prince Albert","Prince Edward County","Prince George","Prince Rupert","Quinte West","Quebec City","Red Deer","Regina","Repentigny","Richmond","Richmond Hill","Rimouski","Rivière-du-Loup","Rouyn-Noranda","Saguenay","Saint-Augustin-de-Desmaures","Saint-Basile-le-Grand","Saint-Bruno-de-Montarville","Saint-Constant","Saint-Eustache","Saint-Georges","Saint-Hyacinthe","Saint-Jean-sur-Richelieu","Saint-Jérôme","Saint John","Saint-Lambert","Saint-Lazare","Sainte-Adèle","Sainte-Anne-des-Plaines","Sainte-Catherine","Sainte-Julie","Sainte-Marthe-sur-le-Lac","Sainte-Thérèse","Salaberry-de-Valleyfield","Salmon Arm","Sarnia","Saskatoon","Sault Ste. Marie","Scarborough","Sept-Îles","Shawinigan","Sherbrooke","Sherwood Park","Sorel-Tracy","Spruce Grove","St. Albert","St. Catharines","St. John's","St. Thomas","Stratford","Strathcona County","Strathroy-Caradoc","Summerside","Surrey","Swift Current","Sydney","Tecumseh","Terrebonne","Thorold","Thunder Bay","Timmins","Toronto","Trois-Rivières","Truro","Val-d'Or","Vancouver","Varennes","Vaudreuil-Dorion","Vaughan","Vernon","Victoria","Victoriaville","Waterloo","Welland","West Kelowna","West Vancouver","Westmount","Weyburn","Whitby","White Rock","Whitchurch-Stouffville","Williams Lake","Windsor","Winnipeg","Wood Buffalo","Woodstock","Yellowknife","Yorkton"],ue=[];for(let Pa=0;Pa<256;++Pa)ue.push((Pa+256).toString(16).slice(1));let ce;const de=new Uint8Array(16);const ve={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function me(e,a,l){if(ve.randomUUID&&!a&&!e)return ve.randomUUID();const t=(e=e||{}).random??e.rng?.()??function(){if(!ce){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ce=crypto.getRandomValues.bind(crypto)}return ce(de)}();if(t.length<16)throw new Error("Random bytes length must be >= 16");return t[6]=15&t[6]|64,t[8]=63&t[8]|128,function(e,a=0){return(ue[e[a+0]]+ue[e[a+1]]+ue[e[a+2]]+ue[e[a+3]]+"-"+ue[e[a+4]]+ue[e[a+5]]+"-"+ue[e[a+6]]+ue[e[a+7]]+"-"+ue[e[a+8]]+ue[e[a+9]]+"-"+ue[e[a+10]]+ue[e[a+11]]+ue[e[a+12]]+ue[e[a+13]]+ue[e[a+14]]+ue[e[a+15]]).toLowerCase()}(t)}const pe={style:{"margin-top":"1rem","margin-bottom":"4rem"}},fe={class:"list-flex-toolbar flex-list-v1"},he={class:"page-content-inner",style:{"margin-top":"5rem"}},ye={class:"flex-list-wrapper flex-list-v1"},ge=n("img",{class:"light-image",src:"/assets/search-7-BRepkZ0T.svg",alt:"",style:{"max-width":"280px"}},null,-1),_e=n("img",{class:"dark-image",src:"/assets/search-7-dark-Cu_2bQnD.svg",alt:"",style:{"max-width":"280px"}},null,-1),be={class:"item-name dark-inverted"},Ce={key:1,class:"light-text"},ke={key:2,class:"light-text"},we={class:"light-text"},Se={class:"light-text"},Ve=n("br",null,null,-1),xe={class:"modal-form"},De={class:"modal-nav"},Pe=n("h3",{class:"modal-step-title"}," Coupon Information ",-1),Ue={class:"columns is-multiline"},Ae={class:"column is-6"},Le={class:"column is-6"},Ne={class:"modal-nav"},Me=n("h3",{class:"modal-step-title"}," Select Users (Passengers) ",-1),Ee={class:"row mt-4"},Be={class:"col-12 mb-4"},Oe={class:"userSelection"},Te=n("p",null,"Available Passengers:",-1),Ie={key:0,class:"list-placeholder"},je={key:1,class:"list-placeholder"},Fe=["onClick"],Re={key:3,class:"list-placeholder"},$e={class:"col-12"},Ge={class:"userSelection"},We={class:"userlist scrollable-list selected-items-list"},ze={key:0,class:"list-placeholder"},qe={class:"modal-nav"},He=n("h3",{class:"modal-step-title"}," Select Drivers ",-1),Je={class:"row mt-4"},Ke={class:"col-12"},Qe={class:"userSelection"},Ye=n("p",null,"Available Drivers:",-1),Ze={key:0,class:"list-placeholder"},Xe={key:1,class:"list-placeholder"},ea=["onClick"],aa={key:3,class:"list-placeholder"},la={class:"col-12"},ta={class:"userSelection"},oa={class:"userlist scrollable-list selected-items-list"},ia={key:0,class:"list-placeholder"},ra={class:"modal-nav"},sa=n("h3",{class:"modal-step-title"}," Select Applicable Trip Locations ",-1),na=n("div",{style:{width:"40px"}},null,-1),ua={class:"rower mt-4"},ca={class:"col-6"},da={class:"userSelection"},va=n("p",null,"Departure Towns/Cities:",-1),ma={key:0,class:"list-placeholder"},pa=["onClick"],fa={class:"userSelection mt-4"},ha={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},ya={key:0,class:"list-placeholder"},ga={class:"col-6"},_a={class:"userSelection"},ba=n("p",null,"Destination Towns/Cities:",-1),Ca={key:0,class:"list-placeholder"},ka=["onClick"],wa={class:"userSelection mt-4"},Sa={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},Va={key:0,class:"list-placeholder"},xa=n("p",{class:"help is-info mt-4 has-text-centered"},[d(" The coupon will apply if the trip starts in a selected departure location "),n("b",null,"OR"),d(" ends in a selected destination location. Leave a list empty to not restrict by it. ")],-1),Da=l({__name:"voucher",setup(l){const s=K(),c=Q(),m=Z(),p=f(""),g=f([]),E=f(!1),X=f(!1),ee=f(!1),ae=f({page:1,itemsPerPage:5,totalItems:0,totalPages:0}),le=f("index"),te=f([]),oe=f([]),re=f(!1),ue=f([...ne].sort()),ce=f(""),de=f(""),ve=f(""),Da=f(""),Pa=f([]),Ua=f([]),Aa=f([]),La=f([]),Na=_({couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Ma=t((()=>{const e=ce.value.toLowerCase().trim();return e?te.value.filter((a=>(a.email??"").toLowerCase().includes(e))):te.value})),Ea=t((()=>{const e=de.value.toLowerCase().trim();return e?oe.value.filter((a=>(a.email??"").toLowerCase().includes(e))):oe.value})),Ba=t((()=>{if(!p.value)return g.value;const e=p.value.toLowerCase().trim();return e?g.value.filter((a=>a.couponCode?.toLowerCase().includes(e)||a.description?.toLowerCase().includes(e)||a.discount.toString().includes(e))):g.value})),Oa=t((()=>{const e=ve.value.toLowerCase().trim();return e?ue.value.filter((a=>a.toLowerCase().includes(e))):ue.value})),Ta=t((()=>{const e=Da.value.toLowerCase().trim();return e?ue.value.filter((a=>a.toLowerCase().includes(e))):ue.value})),Ia=()=>{Object.assign(Na,{couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Pa.value=[],Ua.value=[],Aa.value=[],La.value=[],ce.value="",de.value="",ve.value="",Da.value="",le.value="index"},ja=()=>{Ia(),E.value=!0,Na.isForEverybody||0!==te.value.length||$a()},Fa=()=>{E.value=!1,Ia()},Ra=e=>{le.value=e},$a=async()=>{if(!(te.value.length>0&&oe.value.length>0||re.value)){re.value=!0;try{const e=await c.list("/User/GetAllUsers",!0);e&&Array.isArray(e.data)?(te.value=e.data,oe.value=e.data):m.warning("Could not fetch user/driver list for selection.")}catch(e){console.error("Error fetching data for select inputs:",e),m.error("Could not load data needed for coupon targeting.")}finally{re.value=!1}}},Ga=async()=>{ee.value=!0;try{if(!Na.couponCode.trim()||!Na.description.trim()||Na.discount<=0)return m.error("Please fill in code, description, and provide a valid positive discount."),void(ee.value=!1);if(!Na.startDate||!Na.endDate)return m.error("Please select both start and end dates."),void(ee.value=!1);if(Na.startDate>=Na.endDate)return m.error("End date must be after start date."),void(ee.value=!1);if(Na.maxNumberOfUsePerUser<=0||Na.maxNumberOfUse<=0)return m.error("Usage limits must be positive numbers."),void(ee.value=!1);if(!Na.isForEverybody&&0===Pa.value.length&&0===Ua.value.length)return m.error("Please select at least one user, driver, or trip when not applying to everybody."),void(ee.value=!1);const e={couponCode:Na.couponCode.trim(),description:Na.description.trim(),isDiscountPourcentage:Na.isDiscountPourcentage,discount:Na.discount,startDate:Na.startDate,endDate:Na.endDate,maxNumberOfUsePerUser:Na.maxNumberOfUsePerUser,maxNumberOfUse:Na.maxNumberOfUse,isForEverybody:Na.isForEverybody,...Na.isForEverybody?{userList:[],driverEmailList:[],couponTripList:[],passengerEmailList:[]}:{userList:Pa.value,driverEmailList:Ua.value,couponTripList:(()=>{const e=[],a=Aa.value,l=La.value;if(a.length>0&&l.length>0)for(const t of a)for(const a of l)e.push({departureTown:t,destinationTown:a});return e})(),passengerEmailList:[]}},a=await c.add("/Coupon/CreateCoupon",e);a?(m.success(`Coupon "${Na.couponCode}" created successfully!`),ae.value.page=1,await Wa(),Fa()):(m.error("Failed to create coupon. API response indicated failure."),console.warn("Coupon creation API call returned falsy or unexpected response:",a))}catch(e){console.error("Error creating coupon:",e);const a=e?.response?.data?.errors?JSON.stringify(e.response.data.errors):e?.response?.data?.message||e.message||"Unknown error";m.error(`Failed to create coupon: ${a}`)}finally{ee.value=!1}},Wa=async()=>{X.value=!0;try{const e=`/Coupon/GetAllCoupon?pageNumber=${ae.value.page}&pageSize=${ae.value.itemsPerPage}`,a=await c.list(e,!0);a&&Array.isArray(a.data)?(g.value=a.data,ae.value.totalItems=a.total,ae.value.totalPages=Math.ceil(a.total/ae.value.itemsPerPage)):(g.value=[],ae.value.totalItems=0,ae.value.totalPages=0,console.warn("Received invalid response for coupons:",a),m.warning("Could not fetch coupons or data format is incorrect."))}catch(e){console.error("Error fetching coupons:",e),m.error(`Failed to load coupons: ${e.message||"Unknown error"}`),g.value=[],ae.value.totalItems=0,ae.value.totalPages=0}finally{X.value=!1}},za=async e=>{ae.value.page=e,await Wa()},qa=e=>{if(!e)return"N/A";try{const a=e instanceof Date?Y.fromJSDate(e):Y.fromISO(e);return a.isValid?a.toFormat("dd MMM yyyy"):"Invalid Date"}catch(a){return console.warn("Date formatting error:",a),"Invalid Date"}};b((async()=>{s.setPageTitle("Voucher & Coupons"),await Wa()})),C((()=>Na.isForEverybody),(e=>{e||0!==te.value.length||$a(),e&&(Pa.value=[],Ua.value=[],Aa.value=[],La.value=[],le.value="index")}));const Ha={couponCode:{label:"Coupon code",grow:!0,sortable:!0},appliesTo:{label:"Applies To",align:"center"},discount:{label:"Discount",align:"center"},dates:{label:"Validity",align:"center"},status:{label:"Status",align:"center"},actions:{label:"Actions",align:"end"}};return(l,t)=>{const s=B,c=J,f=H,g=q,_=z,b=F,C=W,K=G,Q=$,Y=k("Tippy"),Z=R,te=j,oe=I,ne=O,ue=T,Ia=se,$a=M,Wa=N,Ja=ie,Ka=a,Qa=e;return o(),w(Ka,{size:"xl",active:X.value&&!ee.value,class:"full-height",overlay:!0},{default:S((()=>[n("div",pe,[n("div",fe,[V(c,null,{default:S((()=>[V(s,{icon:"feather:search"},{default:S((()=>[h(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,p.value]])])),_:1})])),_:1}),V(g,null,{default:S((()=>[V(f,{color:"primary",icon:"fas fa-plus",elevated:"",onClick:ja},{default:S((()=>[d(" Add coupon ")])),_:1}),V(f,{color:"warning",icon:"fas fa-print",elevated:"",disabled:""},{default:S((()=>[d(" Print ")])),_:1})])),_:1})])]),n("div",he,[n("div",ye,[X.value||Ba.value.length?u("",!0):(o(),w(_,{key:0,title:"No coupons found.",subtitle:"No coupons matched your search criteria, or no coupons have been created yet."},{image:S((()=>[ge,_e])),action:S((()=>[p.value?(o(),w(f,{key:0,color:"primary",outlined:"",onClick:t[1]||(t[1]=e=>p.value="")},{default:S((()=>[d(" Clear Search ")])),_:1})):u("",!0),V(f,{color:"primary",icon:"lucide:plus",raised:"",class:r({"ml-2":p.value}),onClick:ja},{default:S((()=>[d(" Add Coupon ")])),_:1},8,["class"])])),_:1})),Ba.value.length?(o(),w(Z,{key:1,data:Ba.value,columns:Ha,rounded:"",reactive:""},{body:S((()=>[V(P,{name:"list",tag:"div",class:"flex-list-inner"},{default:S((()=>[(o(!0),i(D,null,x(Ba.value,(e=>(o(),i("div",{key:e.id,class:"flex-table-item"},[V(b,{column:{media:!0,grow:!0},"data-th":"Coupon Code",style:{"padding-left":"1.5%"}},{default:S((()=>[n("span",be,v(e.couponCode),1)])),_:2},1024),V(b,{column:Ha.appliesTo,"data-th":"Applies To"},{default:S((()=>{return[!e.isForEverybody&&e.userList?.length>0?(o(),w(C,{key:0,limit:3,size:"small",avatars:(a=e.userList,a&&Array.isArray(a)&&0!==a.length?a.map((e=>({initials:`${e.firstName?.[0]??""}${e.lastName?.[0]??""}`.toUpperCase()}))):[])},null,8,["avatars"])):e.isForEverybody?(o(),i("span",Ce,"All Users")):(o(),i("span",ke,"-"))];var a})),_:2},1032,["column"]),V(b,{column:Ha.discount,"data-th":"Discount"},{default:S((()=>[n("span",we,v(e.discount)+v(e.isDiscountPourcentage?"%":"$"),1)])),_:2},1032,["column"]),V(b,{column:Ha.dates,"data-th":"Validity"},{default:S((()=>[n("span",Se,[d(v(qa(e.startDate))+" ",1),Ve,d(" "+v(qa(e.endDate)),1)])])),_:2},1032,["column"]),V(b,{column:Ha.status,"data-th":"Status"},{default:S((()=>[V(K,{color:e.isActive?"success":"danger",label:e.isActive?"Active":"Inactive",rounded:""},null,8,["color","label"])])),_:2},1032,["column"]),V(b,{column:Ha.actions,"data-th":"Actions"},{default:S((()=>[V(g,null,{default:S((()=>[V(Y,{style:{"margin-right":"1px"}},{content:S((()=>[d(" View coupon detail ")])),default:S((()=>[V(Q,{icon:"lucide:eye",color:"info",disabled:"",title:"View detail (not implemented)"})])),_:1}),V(Y,{style:{"margin-left":"1px"}},{content:S((()=>[d(v(e.isActive?"Deactivate coupon":"Activate coupon"),1)])),default:S((()=>[V(Q,{icon:e.isActive?"lucide:circle-slash-2":"lucide:circle",color:e.isActive?"danger":"success",disabled:"",title:e.isActive?"Deactivate coupon (not implemented)":"Activate coupon (not implemented)"},null,8,["icon","color","title"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["column"])])))),128))])),_:1})])),_:1},8,["data"])):u("",!0),!X.value&&ae.value.totalItems>ae.value.itemsPerPage?(o(),w(te,{key:2,"current-page":ae.value.page,"onUpdate:currentPage":[t[2]||(t[2]=e=>ae.value.page=e),za],"item-per-page":ae.value.itemsPerPage,"total-items":ae.value.totalItems,"max-links-displayed":3,"no-router":""},null,8,["current-page","item-per-page","total-items"])):u("",!0)])]),V(Qa,{open:E.value,size:"large",actions:"center",title:"Create a new coupon",noclose:"",onClose:Fa},{content:S((()=>[V(Ka,{active:ee.value||re.value,card:"regular"},{default:S((()=>[n("form",{onSubmit:L(Ga,["prevent"])},[n("div",xe,[h(n("div",null,[n("div",De,[Pe,V(Q,{icon:"lucide:move-right",circle:"",disabled:Na.isForEverybody,onClick:t[3]||(t[3]=e=>Ra("userlist"))},null,8,["disabled"])]),n("div",Ue,[n("div",Ae,[V(c,{label:"Coupon code *"},{default:S((()=>[V(s,null,{default:S((()=>[V(oe,{modelValue:Na.couponCode,"onUpdate:modelValue":t[4]||(t[4]=e=>Na.couponCode=e),modelModifiers:{trim:!0},placeholder:"e.g., SUMMER20",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Type of discount *"},{default:S((()=>[V(s,null,{default:S((()=>[V(ue,{modelValue:Na.isDiscountPourcentage,"onUpdate:modelValue":t[5]||(t[5]=e=>Na.isDiscountPourcentage=e)},{default:S((()=>[V(ne,{value:!0},{default:S((()=>[d(" Percentage ")])),_:1}),V(ne,{value:!1},{default:S((()=>[d(" Amount ")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Discount Value *"},{default:S((()=>[V(s,null,{default:S((()=>[V(oe,{modelValue:Na.discount,"onUpdate:modelValue":t[6]||(t[6]=e=>Na.discount=e),modelModifiers:{number:!0},type:"number",placeholder:Na.isDiscountPourcentage?"e.g., 10":"e.g., 5.00",min:"0.01",step:"any",required:""},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),V(c,{label:"Start date *"},{default:S((()=>[V(s,{icon:"lucide:calendar-days"},{default:S((()=>[V(oe,{modelValue:Na.startDate,"onUpdate:modelValue":t[7]||(t[7]=e=>Na.startDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"End date *"},{default:S((()=>[V(s,{icon:"lucide:calendar-days"},{default:S((()=>[V(oe,{modelValue:Na.endDate,"onUpdate:modelValue":t[8]||(t[8]=e=>Na.endDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",Le,[V(c,{label:"Description *"},{default:S((()=>[V(s,null,{default:S((()=>[V(Ia,{modelValue:Na.description,"onUpdate:modelValue":t[9]||(t[9]=e=>Na.description=e),modelModifiers:{trim:!0},placeholder:"Brief description...",rows:"4",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Max uses per user *"},{default:S((()=>[V(s,{icon:"lucide:user-check"},{default:S((()=>[V(oe,{modelValue:Na.maxNumberOfUsePerUser,"onUpdate:modelValue":t[10]||(t[10]=e=>Na.maxNumberOfUsePerUser=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 1",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Max total uses *"},{default:S((()=>[V(s,{icon:"lucide:tag"},{default:S((()=>[V(oe,{modelValue:Na.maxNumberOfUse,"onUpdate:modelValue":t[11]||(t[11]=e=>Na.maxNumberOfUse=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 100",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(c,{label:"Applies To"},{default:S((()=>[V(s,null,{default:S((()=>[V($a,{modelValue:Na.isForEverybody,"onUpdate:modelValue":t[12]||(t[12]=e=>Na.isForEverybody=e),label:"Apply to all users",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})])])],512),[[U,"index"===le.value]]),h(n("div",null,[n("div",Ne,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[13]||(t[13]=e=>Ra("index"))}),Me,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[14]||(t[14]=e=>Ra("driverlist"))})]),n("div",Ee,[n("div",Be,[n("div",Oe,[Te,V(c,{class:"mb-3",style:{width:"100%"}},{default:S((()=>[V(s,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:ce.value,"onUpdate:modelValue":t[15]||(t[15]=e=>ce.value=e),placeholder:"Search by email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:A({display:ce.value.length>0?"block":"none"})},[re.value?(o(),i("div",Ie," Loading... ")):0===Ma.value.length?(o(),i("div",je,' No passengers found matching "'+v(ce.value)+'". ',1)):u("",!0),ce.value.length>0?(o(!0),i(D,{key:2},x(Ma.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.id)try{if(Pa.value.some((a=>a.userId===e.id)))return void m.info(`${e.userDetail?.firstName??"User"} is already selected.`);const a={id:e.id,userId:e.userDetail?.userId,firstName:e.userDetail?.firstName??"",lastName:e.userDetail?.lastName??"",email:e.email??"",phoneNumber:e.phoneNumber??"",couponCode:Na.couponCode,discount:Na.discount,maxPersonalUseNumber:Na.maxNumberOfUsePerUser,currentPersonalUsesNumber:0,couponStartDate:Na.startDate,couponEndDate:Na.endDate,couponId:me()};Pa.value.push(a),ce.value=""}catch(a){m.error("An error occurred while selecting the user."),console.error("Error in selectUser:",a)}else m.error("Cannot select invalid user data.")})(e)},[n("li",null,v(e.email),1)],8,Fe)))),128)):re.value?u("",!0):(o(),i("div",Re," Start typing to search for passengers. "))],4)])]),n("div",$e,[n("div",Ge,[n("p",null,"Passengers Selected ("+v(Pa.value.length)+"):",1),n("div",We,[0===Pa.value.length?(o(),i("div",ze," Click passengers on the left to select. ")):u("",!0),(o(!0),i(D,null,x(Pa.value,(e=>(o(),w(Ja,{key:e.userId,title:e.email,white:"",icon:"fas fa-user",onClick:a=>{var l;(l=e.userId)&&(Pa.value=Pa.value.filter((e=>e.userId!==l)),m.info("User removed from selection."))}},{default:S((()=>[V(Wa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[U,"userlist"===le.value]]),h(n("div",null,[n("div",qe,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[16]||(t[16]=e=>Ra("userlist"))}),He,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[17]||(t[17]=e=>Ra("triplist"))})]),n("div",Je,[n("div",Ke,[n("div",Qe,[Ye,V(c,{class:"mb-3"},{default:S((()=>[V(s,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:de.value,"onUpdate:modelValue":t[18]||(t[18]=e=>de.value=e),placeholder:"Search by email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:A({display:de.value.length>0?"block":"none"})},[re.value?(o(),i("div",Ze," Loading... ")):0===Ea.value.length?(o(),i("div",Xe,' No drivers found matching "'+v(de.value)+'". ',1)):u("",!0),de.value.length>0?(o(!0),i(D,{key:2},x(Ea.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.email)try{const a=e.email;if(Ua.value.includes(a))return void m.info(`${e.userDetail?.firstName??"Driver"} is already selected.`);Ua.value.push(a),de.value=""}catch(a){m.error("An error occurred while selecting the driver."),console.error("Error in selectDriver:",a)}else m.error("Cannot select invalid driver data (missing email).")})(e)},[n("li",null,v(e.email),1)],8,ea)))),128)):re.value?u("",!0):(o(),i("div",aa," Start typing to search for passengers. "))],4)])]),n("div",la,[n("div",ta,[n("p",null,"Drivers Selected ("+v(Ua.value.length)+"):",1),n("div",oa,[0===Ua.value.length?(o(),i("div",ia," Click drivers on the left to select. ")):u("",!0),(o(!0),i(D,null,x(Ua.value,((e,a)=>(o(),w(Ja,{key:a,title:e,white:"",icon:"fas fa-user",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Ua.value=Ua.value.filter((e=>e!==l)),m.info("Driver removed from selection."))}},{default:S((()=>[V(Wa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[U,"driverlist"===le.value]]),h(n("div",null,[n("div",ra,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[19]||(t[19]=e=>Ra("driverlist"))}),sa,na]),n("div",ua,[n("div",ca,[n("div",da,[va,V(c,{class:"mb-3"},{default:S((()=>[V(s,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:ve.value,"onUpdate:modelValue":t[20]||(t[20]=e=>ve.value=e),placeholder:"Search departure..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:A({display:ve.value.length>0?"block":"none"})},[0===Oa.value.length?(o(),i("div",ma,' No locations found matching "'+v(ve.value)+'". ',1)):u("",!0),ve.value.length>0?(o(!0),i(D,{key:1},x(Oa.value,(e=>(o(),i("ul",{key:`dep-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(Aa.value.length>=1?m.info("Only one town can be added"):Aa.value.includes(l)?m.info(`${l} is already selected for departure.`):(Aa.value.push(l),ve.value=""))}},[n("li",null,v(e),1)],8,pa)))),128)):u("",!0)],4),n("div",fa,[n("p",null,"Selected Departures ("+v(Aa.value.length)+"):",1),n("div",ha,[0===Aa.value.length?(o(),i("div",ya," Click locations above to select. ")):u("",!0),(o(!0),i(D,null,x(Aa.value,(e=>(o(),w(Ja,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Aa.value=Aa.value.filter((e=>e!==l)),m.info("Departure location removed."))}},{default:S((()=>[V(Wa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])]),n("div",ga,[n("div",_a,[ba,V(c,{class:"mb-3"},{default:S((()=>[V(s,{icon:"feather:search"},{default:S((()=>[V(oe,{modelValue:Da.value,"onUpdate:modelValue":t[21]||(t[21]=e=>Da.value=e),placeholder:"Search destination..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:A({display:Da.value.length>0?"block":"none"})},[0===Ta.value.length?(o(),i("div",Ca,' No locations found matching "'+v(Da.value)+'". ',1)):u("",!0),Da.value.length>0?(o(!0),i(D,{key:1},x(Ta.value,(e=>(o(),i("ul",{key:`dest-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(La.value.length>=1?m.info("Only one town can be added"):La.value.includes(l)?m.info(`${l} is already selected for destination.`):(La.value.push(l),Da.value=""))}},[n("li",null,v(e),1)],8,ka)))),128)):u("",!0)],4),n("div",wa,[n("p",null,"Selected Destinations ("+v(La.value.length)+"):",1),n("div",Sa,[0===La.value.length?(o(),i("div",Va," Click locations above to select. ")):u("",!0),(o(!0),i(D,null,x(La.value,(e=>(o(),w(Ja,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(La.value=La.value.filter((e=>e!==l)),m.info("Destination location removed."))}},{default:S((()=>[V(Wa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])]),xa],512),[[U,"triplist"===le.value]])])],32)])),_:1},8,["active"])])),action:S((()=>[Na.isForEverybody||"triplist"===le.value?(o(),w(f,{key:0,color:"primary",raised:"",loading:ee.value,disabled:ee.value||re.value,onClick:Ga},{default:S((()=>[d(" Create Coupon ")])),_:1},8,["loading","disabled"])):u("",!0)])),_:1},8,["open"])])),_:1},8,["active"])}}});"function"==typeof X&&X(Da);export{Da as default};
