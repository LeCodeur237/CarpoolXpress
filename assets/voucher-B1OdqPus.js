import{_ as e}from"./VModal.vue_vue_type_style_index_0_lang-BxprIClF.js";import{_ as a}from"./VLoader.vue_vue_type_style_index_0_lang-z6CWX0dI.js";import{e as l,Q as t,t as o,v as i,A as s,m as r,x as n,z as u,M as c,L as d,y as v,am as m,an as p,r as f,Y as h,a4 as y,j as g,f as _,o as b,w as C,G as k,J as w,I as S,H as V,S as x,R as D,a6 as P,ap as N,aq as U,K as L}from"./index-DCVzCXGO.js";import{_ as A}from"./VIcon.vue_vue_type_script_setup_true_lang-C0d72aUG.js";import{_ as M}from"./VSwitchBlock.vue_vue_type_style_index_0_lang-BidnNFJG.js";import{u as B,_ as E}from"./VControl-CsOLD0Mp.js";import{_ as T,a as O}from"./VOption.vue_vue_type_style_index_0_lang-12FAAbxV.js";import{_ as j}from"./VInput.vue_vue_type_script_setup_true_lang-mIaEB-6s.js";import{_ as F}from"./VFlexPagination.vue_vue_type_script_setup_true_lang-DRRY7dtM.js";import{a as I,_ as R}from"./VFlexTable.vue_vue_type_style_index_0_lang-Cm_KVmI6.js";import{_ as $}from"./VIconButton-D-6bh6HX.js";import{_ as G}from"./VTag.vue_vue_type_style_index_0_lang-EAZmVvoA.js";import{_ as W}from"./VAvatarStack.vue_vue_type_script_setup_true_lang-B8AKK83m.js";import{_ as z}from"./VPlaceholderPage.vue_vue_type_style_index_0_lang-B_FLCEd8.js";import{_ as q}from"./VButtons.vue_vue_type_script_setup_true_lang-BRkjIdnO.js";import{_ as H}from"./VButton.vue_vue_type_style_index_0_lang-BOJu42_j.js";import{_ as J}from"./VField.vue_vue_type_script_setup_true_lang-CWrb41Pw.js";import{u as K}from"./viewWrapper-B2fmsTqy.js";import{u as Q}from"./defaultResource-BKcbMEp6.js";import{D as Y}from"./datetime-xmklhC0O.js";import{u as Z}from"./useNotyf-1WfirvEN.js";import{b as X}from"./route-block-B_A1xBdJ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";import"./VAvatar.vue_vue_type_style_index_0_lang-DpyihaF2.js";import"./useFetch-DTVXwznz.js";import"./notyf-CueL1e6X.js";const ee=["data-icon"],ae={key:1,class:"snack-media"},le=["src"],te={class:"snack-text"},oe={class:"snack-action"},ie=l({__name:"VSnack",props:{title:{},icon:{default:void 0},image:{default:void 0},placeholder:{default:"https://via.placeholder.com/50x50"},color:{default:void 0},size:{default:void 0},solid:{type:Boolean},white:{type:Boolean}},setup(e){const a=e;function l(e){e.target.src=a.placeholder}const m=t((()=>a.icon&&-1!==a.icon.indexOf(":")));return(e,t)=>(o(),i("div",{class:s(["snack",[a.white&&"is-white",a.size&&`is-${a.size}`]])},[a.icon?(o(),i("div",{key:0,class:s(["snack-media is-icon",[a.color&&`is-${a.color}`,a.solid&&"is-solid"]])},[r(m)?(o(),i("i",{key:0,"aria-hidden":"true",class:"iconify snack-icon","data-icon":e.icon},null,8,ee)):(o(),i("i",{key:1,"aria-hidden":"true",class:s(["snack-icon",a.icon])},null,2))],2)):a.image?(o(),i("div",ae,[n("img",{class:"avatar",src:a.image,alt:"",onErrorOnce:l},null,40,le)])):u("",!0),n("span",te,[c(e.$slots,"title",{},(()=>[d(v(a.title),1)]))]),n("span",oe,[c(e.$slots,"default")])],2))}}),se=["id","name"],re=l({__name:"VTextarea",props:m({raw:{type:Boolean},autogrow:{type:Boolean}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=p(e,"modelValue"),l=e,{field:n,id:u}=B({create:!1,help:"VTextarea"}),c=f(),d=t({get:()=>n?.value?n.value.value:a.value,set(e){n?.value&&n.value.setValue(e),a.value=e}});function v(){c.value&&l.autogrow&&(c.value.style.height="auto",c.value.style.height=c.value.scrollHeight+"px")}const m=t((()=>l.raw?[]:["textarea"]));return(e,a)=>h((o(),i("textarea",{id:r(u),ref_key:"textareaRef",ref:c,"onUpdate:modelValue":a[0]||(a[0]=e=>g(d)?d.value=e:null),class:s(r(m)),name:r(u),onChange:a[1]||(a[1]=(...e)=>r(n)?.handleChange&&r(n)?.handleChange(...e)),onBlur:a[2]||(a[2]=(...e)=>r(n)?.handleBlur&&r(n)?.handleBlur(...e)),onInput:v},null,42,se)),[[y,r(d)]])}}),ne=["Abbotsford","Airdrie","Ajax","Alma","Amos","Aurora","Barrie","Beaconsfield","Belleville","Blainville","Boisbriand","Boucherville","Bradford West Gwillimbury","Brampton","Brandon","Brantford","Brockville","Brossard","Burlington","Burnaby","Caledon","Calgary","Cambridge","Campbell River","Camrose","Candiac","Cape Breton","Chambly","Charlottetown","Châteauguay","Chatham-Kent","Chilliwack","Clarence-Rockland","Clarington","Cobourg","Cochrane","Coquitlam","Cornwall","Côte Saint-Luc","Courtenay","Cranbrook","Dartmouth","Delta","Deux-Montagnes","Dieppe","Dollard-des-Ormeaux","Dorval","Drummondville","Duncan","East Gwillimbury","Edmonton","Edmundston","Etobicoke","Fort Erie","Fort McMurray","Fort Saskatchewan","Fort St. John","Fredericton","Gatineau","Georgina","Glace Bay","Granby","Grande Prairie","Greater Sudbury","Grimsby","Guelph","Halifax","Halton Hills","Hamilton","Huntsville","Innisfil","Joliette","Kamloops","Kawartha Lakes","Kelowna","Kenora","Kingston","Kirkland","Kitchener","La Prairie","Lachute","Lacombe","Ladysmith","Lake Country","Langford","Langley (City)","Langley (District)","Laval","Leamington","Leduc","Lethbridge","Lévis","Lincoln","Lloydminster","London","Longueuil","Magog","Maple Ridge","Markham","Mascouche","Medicine Hat","Midland","Milton","Mirabel","Miramichi","Mississauga","Moncton","Mont-Royal","Mont-Saint-Hilaire","Montreal","Moose Jaw","Mount Pearl","Nanaimo","New Glasgow","New Tecumseth","New Westminster","Newmarket","Niagara Falls","Norfolk County","North Battleford","North Bay","North Cowichan","North Vancouver (City)","North Vancouver (District)","Oak Bay","Oakville","Okotoks","Orangeville","Orillia","Oshawa","Ottawa","Owen Sound","Parksville","Pembroke","Penticton","Peterborough","Pickering","Pitt Meadows","Pointe-Claire","Port Alberni","Port Colborne","Port Coquitlam","Port Moody","Powell River","Prince Albert","Prince Edward County","Prince George","Prince Rupert","Quinte West","Quebec City","Red Deer","Regina","Repentigny","Richmond","Richmond Hill","Rimouski","Rivière-du-Loup","Rouyn-Noranda","Saguenay","Saint-Augustin-de-Desmaures","Saint-Basile-le-Grand","Saint-Bruno-de-Montarville","Saint-Constant","Saint-Eustache","Saint-Georges","Saint-Hyacinthe","Saint-Jean-sur-Richelieu","Saint-Jérôme","Saint John","Saint-Lambert","Saint-Lazare","Sainte-Adèle","Sainte-Anne-des-Plaines","Sainte-Catherine","Sainte-Julie","Sainte-Marthe-sur-le-Lac","Sainte-Thérèse","Salaberry-de-Valleyfield","Salmon Arm","Sarnia","Saskatoon","Sault Ste. Marie","Scarborough","Sept-Îles","Shawinigan","Sherbrooke","Sherwood Park","Sorel-Tracy","Spruce Grove","St. Albert","St. Catharines","St. John's","St. Thomas","Stratford","Strathcona County","Strathroy-Caradoc","Summerside","Surrey","Swift Current","Sydney","Tecumseh","Terrebonne","Thorold","Thunder Bay","Timmins","Toronto","Trois-Rivières","Truro","Val-d'Or","Vancouver","Varennes","Vaudreuil-Dorion","Vaughan","Vernon","Victoria","Victoriaville","Waterloo","Welland","West Kelowna","West Vancouver","Westmount","Weyburn","Whitby","White Rock","Whitchurch-Stouffville","Williams Lake","Windsor","Winnipeg","Wood Buffalo","Woodstock","Yellowknife","Yorkton"],ue={style:{"margin-top":"1rem","margin-bottom":"4rem"}},ce={class:"list-flex-toolbar flex-list-v1"},de={class:"page-content-inner",style:{"margin-top":"5rem"}},ve={class:"flex-list-wrapper flex-list-v1"},me=n("img",{class:"light-image",src:"/assets/search-7-BRepkZ0T.svg",alt:"",style:{"max-width":"280px"}},null,-1),pe=n("img",{class:"dark-image",src:"/assets/search-7-dark-Cu_2bQnD.svg",alt:"",style:{"max-width":"280px"}},null,-1),fe={class:"item-name dark-inverted"},he={key:1,class:"light-text"},ye={key:2,class:"light-text"},ge={class:"light-text"},_e={class:"light-text"},be=n("br",null,null,-1),Ce={class:"modal-form"},ke={class:"modal-nav"},we=n("h3",{class:"modal-step-title"}," Coupon Information ",-1),Se={class:"columns is-multiline"},Ve={class:"column is-6"},xe={class:"column is-6"},De={class:"modal-nav"},Pe=n("h3",{class:"modal-step-title"}," Select Users (Passengers) ",-1),Ne={class:"row mt-4"},Ue={class:"col-12 mb-4"},Le={class:"userSelection"},Ae=n("p",null,"Available Passengers:",-1),Me={key:0,class:"list-placeholder"},Be={key:1,class:"list-placeholder"},Ee=["onClick"],Te={class:"list-item-email"},Oe={key:3,class:"list-placeholder"},je={class:"col-12"},Fe={class:"userSelection"},Ie={class:"userlist scrollable-list selected-items-list"},Re={key:0,class:"list-placeholder"},$e={class:"modal-nav"},Ge=n("h3",{class:"modal-step-title"}," Select Drivers ",-1),We={class:"row mt-4"},ze={class:"col-12"},qe={class:"userSelection"},He=n("p",null,"Available Drivers:",-1),Je={key:0,class:"list-placeholder"},Ke={key:1,class:"list-placeholder"},Qe=["onClick"],Ye={class:"list-item-email"},Ze={key:3,class:"list-placeholder"},Xe={class:"col-12"},ea={class:"userSelection"},aa={class:"userlist scrollable-list selected-items-list"},la={key:0,class:"list-placeholder"},ta={class:"modal-nav"},oa=n("h3",{class:"modal-step-title"}," Select Applicable Trip Locations ",-1),ia=n("div",{style:{width:"40px"}},null,-1),sa={class:"rower mt-4"},ra={class:"col-6"},na={class:"userSelection"},ua=n("p",null,"Departure Towns/Cities:",-1),ca={key:0,class:"list-placeholder"},da=["onClick"],va={class:"userSelection mt-4"},ma={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},pa={key:0,class:"list-placeholder"},fa={class:"col-6"},ha={class:"userSelection"},ya=n("p",null,"Destination Towns/Cities:",-1),ga={key:0,class:"list-placeholder"},_a=["onClick"],ba={class:"userSelection mt-4"},Ca={class:"userlist scrollable-list selected-items-list",style:{height:"120px"}},ka={key:0,class:"list-placeholder"},wa=n("p",{class:"help is-info mt-4 has-text-centered"},[d(" The coupon will apply if the trip starts in a selected departure location "),n("b",null,"OR"),d(" ends in a selected destination location. Leave a list empty to not restrict by it. ")],-1),Sa=l({__name:"voucher",setup(l){const r=crypto.randomUUID(),c=K(),m=Q(),p=Z(),g=f(""),B=f([]),X=f(!1),ee=f(!1),ae=f(!1),le=f({page:1,itemsPerPage:5,totalItems:0,totalPages:0}),te=f("index"),oe=f([]),se=f([]),Sa=f(!1),Va=f([...ne].sort()),xa=f(""),Da=f(""),Pa=f(""),Na=f(""),Ua=f([]),La=f([]),Aa=f([]),Ma=f([]),Ba=_({couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Ea=t((()=>{const e=xa.value.toLowerCase().trim();return e?oe.value.filter((a=>{if(!0===a.isCodeVerified)return!1;const l=`${a.userDetail?.firstName??""} ${a.userDetail?.lastName??""}`.toLowerCase(),t=(a.email??"").toLowerCase();return l.includes(e)||t.includes(e)})):oe.value})),Ta=t((()=>{const e=Da.value.toLowerCase().trim();return e?se.value.filter((a=>{if(!0!==a.isCodeVerified)return!1;const l=`${a.userDetail?.firstName??""} ${a.userDetail?.lastName??""}`.toLowerCase(),t=(a.email??"").toLowerCase();return l.includes(e)||t.includes(e)})):se.value})),Oa=t((()=>{if(!g.value)return B.value;const e=g.value.toLowerCase().trim();return e?B.value.filter((a=>a.couponCode?.toLowerCase().includes(e)||a.description?.toLowerCase().includes(e)||a.discount.toString().includes(e))):B.value})),ja=t((()=>{const e=Pa.value.toLowerCase().trim();return e?Va.value.filter((a=>a.toLowerCase().includes(e))):Va.value})),Fa=t((()=>{const e=Na.value.toLowerCase().trim();return e?Va.value.filter((a=>a.toLowerCase().includes(e))):Va.value})),Ia=()=>{Object.assign(Ba,{couponCode:"",description:"",isDiscountPourcentage:!0,discount:0,startDate:"",endDate:"",maxNumberOfUsePerUser:1,maxNumberOfUse:100,isForEverybody:!0}),Ua.value=[],La.value=[],Aa.value=[],Ma.value=[],xa.value="",Da.value="",Pa.value="",Na.value="",te.value="index"},Ra=()=>{Ia(),X.value=!0,Ba.isForEverybody||0!==oe.value.length||Wa()},$a=()=>{X.value=!1,Ia()},Ga=e=>{te.value=e},Wa=async()=>{if(!(oe.value.length>0&&se.value.length>0||Sa.value)){Sa.value=!0;try{const e=await m.list("/User/GetAllUsers",!0);e&&Array.isArray(e.data)?(oe.value=e.data,se.value=e.data):p.warning("Could not fetch user/driver list for selection.")}catch(e){console.error("Error fetching data for select inputs:",e),p.error("Could not load data needed for coupon targeting.")}finally{Sa.value=!1}}},za=async()=>{ae.value=!0;try{if(!Ba.couponCode.trim()||!Ba.description.trim()||Ba.discount<=0)return p.error("Please fill in code, description, and provide a valid positive discount."),void(ae.value=!1);if(!Ba.startDate||!Ba.endDate)return p.error("Please select both start and end dates."),void(ae.value=!1);if(Ba.startDate>=Ba.endDate)return p.error("End date must be after start date."),void(ae.value=!1);if(Ba.maxNumberOfUsePerUser<=0||Ba.maxNumberOfUse<=0)return p.error("Usage limits must be positive numbers."),void(ae.value=!1);if(!Ba.isForEverybody&&0===Ua.value.length&&0===La.value.length)return p.error("Please select at least one user, driver, or trip when not applying to everybody."),void(ae.value=!1);const e={couponCode:Ba.couponCode.trim(),description:Ba.description.trim(),isDiscountPourcentage:Ba.isDiscountPourcentage,discount:Ba.discount,startDate:Ba.startDate,endDate:Ba.endDate,maxNumberOfUsePerUser:Ba.maxNumberOfUsePerUser,maxNumberOfUse:Ba.maxNumberOfUse,isForEverybody:Ba.isForEverybody,...Ba.isForEverybody?{userList:[],driverEmailList:[],couponTripList:[],passengerEmailList:[]}:{userList:Ua.value,driverEmailList:La.value,couponTripList:(()=>{const e=[],a=Aa.value,l=Ma.value;if(a.length>0&&l.length>0)for(const t of a)for(const a of l)e.push({departureTown:t,destinationTown:a});return e})(),passengerEmailList:[]}},a=await m.add("/Coupon/CreateCoupon",e);a?(p.success(`Coupon "${Ba.couponCode}" created successfully!`),le.value.page=1,await qa(),$a()):(p.error("Failed to create coupon. API response indicated failure."),console.warn("Coupon creation API call returned falsy or unexpected response:",a))}catch(e){console.error("Error creating coupon:",e);const a=e?.response?.data?.errors?JSON.stringify(e.response.data.errors):e?.response?.data?.message||e.message||"Unknown error";p.error(`Failed to create coupon: ${a}`)}finally{ae.value=!1}},qa=async()=>{ee.value=!0;try{const e=`/Coupon/GetAllCoupon?pageNumber=${le.value.page}&pageSize=${le.value.itemsPerPage}`,a=await m.list(e,!0);a&&Array.isArray(a.data)?(B.value=a.data,le.value.totalItems=a.total,le.value.totalPages=Math.ceil(a.total/le.value.itemsPerPage),console.log("Total items set to:",le.value.totalItems)):(B.value=[],le.value.totalItems=0,le.value.totalPages=0,console.warn("Received invalid response for coupons:",a),p.warning("Could not fetch coupons or data format is incorrect."))}catch(e){console.error("Error fetching coupons:",e),p.error(`Failed to load coupons: ${e.message||"Unknown error"}`),B.value=[],le.value.totalItems=0,le.value.totalPages=0}finally{ee.value=!1}},Ha=async e=>{le.value.page=e,await qa()},Ja=e=>{if(!e)return"N/A";try{const a=e instanceof Date?Y.fromJSDate(e):Y.fromISO(e);return a.isValid?a.toFormat("dd MMM yyyy"):"Invalid Date"}catch(a){return console.warn("Date formatting error:",a),"Invalid Date"}};b((async()=>{c.setPageTitle("Voucher & Coupons"),await qa()})),C((()=>Ba.isForEverybody),(e=>{e||0!==oe.value.length||Wa(),e&&(Ua.value=[],La.value=[],Aa.value=[],Ma.value=[],te.value="index")}));const Ka={couponCode:{label:"Coupon code",grow:!0,sortable:!0},appliesTo:{label:"Applies To",align:"center"},discount:{label:"Discount",align:"center"},dates:{label:"Validity",align:"center"},status:{label:"Status",align:"center"},actions:{label:"Actions",align:"end"}};return(l,t)=>{const c=E,m=J,f=H,_=q,b=z,C=I,B=W,K=G,Q=$,Y=k("Tippy"),Z=R,oe=F,se=j,ne=T,Va=O,Ia=re,Wa=M,qa=A,Qa=ie,Ya=a,Za=e;return o(),w(Ya,{size:"xl",active:ee.value&&!ae.value,class:"full-height",overlay:!0},{default:S((()=>[n("div",ue,[n("div",ce,[V(m,null,{default:S((()=>[V(c,{icon:"feather:search"},{default:S((()=>[h(n("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),class:"input custom-text-filter",placeholder:"Search..."},null,512),[[y,g.value]])])),_:1})])),_:1}),V(_,null,{default:S((()=>[V(f,{color:"primary",icon:"fas fa-plus",elevated:"",onClick:Ra},{default:S((()=>[d(" Add coupon ")])),_:1}),V(f,{color:"warning",icon:"fas fa-print",elevated:"",disabled:""},{default:S((()=>[d(" Print ")])),_:1})])),_:1})])]),n("div",de,[n("div",ve,[ee.value||Oa.value.length?u("",!0):(o(),w(b,{key:0,title:"No coupons found.",subtitle:"No coupons matched your search criteria, or no coupons have been created yet."},{image:S((()=>[me,pe])),action:S((()=>[g.value?(o(),w(f,{key:0,color:"primary",outlined:"",onClick:t[1]||(t[1]=e=>g.value="")},{default:S((()=>[d(" Clear Search ")])),_:1})):u("",!0),V(f,{color:"primary",icon:"lucide:plus",raised:"",class:s({"ml-2":g.value}),onClick:Ra},{default:S((()=>[d(" Add Coupon ")])),_:1},8,["class"])])),_:1})),Oa.value.length?(o(),w(Z,{key:1,data:Oa.value,columns:Ka,rounded:"",reactive:""},{body:S((()=>[V(P,{name:"list",tag:"div",class:"flex-list-inner"},{default:S((()=>[(o(!0),i(D,null,x(Oa.value,(e=>(o(),i("div",{key:e.id,class:"flex-table-item"},[V(C,{column:{media:!0,grow:!0},"data-th":"Coupon Code",style:{"padding-left":"1.5%"}},{default:S((()=>[n("span",fe,v(e.couponCode),1)])),_:2},1024),V(C,{column:Ka.appliesTo,"data-th":"Applies To"},{default:S((()=>{return[!e.isForEverybody&&e.userList?.length>0?(o(),w(B,{key:0,limit:3,size:"small",avatars:(a=e.userList,a&&Array.isArray(a)&&0!==a.length?a.map((e=>({initials:`${e.firstName?.[0]??""}${e.lastName?.[0]??""}`.toUpperCase()}))):[])},null,8,["avatars"])):e.isForEverybody?(o(),i("span",he,"All Users")):(o(),i("span",ye,"-"))];var a})),_:2},1032,["column"]),V(C,{column:Ka.discount,"data-th":"Discount"},{default:S((()=>[n("span",ge,v(e.discount)+v(e.isDiscountPourcentage?"%":"$"),1)])),_:2},1032,["column"]),V(C,{column:Ka.dates,"data-th":"Validity"},{default:S((()=>[n("span",_e,[d(v(Ja(e.startDate))+" ",1),be,d(" "+v(Ja(e.endDate)),1)])])),_:2},1032,["column"]),V(C,{column:Ka.status,"data-th":"Status"},{default:S((()=>[V(K,{color:e.isActive?"success":"danger",label:e.isActive?"Active":"Inactive",rounded:""},null,8,["color","label"])])),_:2},1032,["column"]),V(C,{column:Ka.actions,"data-th":"Actions"},{default:S((()=>[V(_,null,{default:S((()=>[V(Y,{style:{"margin-right":"1px"}},{content:S((()=>[d(" View coupon detail ")])),default:S((()=>[V(Q,{icon:"lucide:eye",color:"info",disabled:"",title:"View detail (not implemented)"})])),_:1}),V(Y,{style:{"margin-left":"1px"}},{content:S((()=>[d(v(e.isActive?"Deactivate coupon":"Activate coupon"),1)])),default:S((()=>[V(Q,{icon:e.isActive?"lucide:circle-slash-2":"lucide:circle",color:e.isActive?"danger":"success",disabled:"",title:e.isActive?"Deactivate coupon (not implemented)":"Activate coupon (not implemented)"},null,8,["icon","color","title"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["column"])])))),128))])),_:1})])),_:1},8,["data"])):u("",!0),!ee.value&&le.value.totalItems>le.value.itemsPerPage?(o(),w(oe,{key:2,"current-page":le.value.page,"onUpdate:currentPage":[t[2]||(t[2]=e=>le.value.page=e),Ha],"item-per-page":le.value.itemsPerPage,"total-items":le.value.totalItems,"max-links-displayed":3,"no-router":""},null,8,["current-page","item-per-page","total-items"])):u("",!0)])]),V(Za,{open:X.value,size:"large",actions:"center",title:"Create a new coupon",noclose:"",onClose:$a},{content:S((()=>[V(Ya,{active:ae.value||Sa.value,card:"regular"},{default:S((()=>[n("form",{onSubmit:L(za,["prevent"])},[n("div",Ce,[h(n("div",null,[n("div",ke,[we,V(Q,{icon:"lucide:move-right",circle:"",disabled:Ba.isForEverybody,onClick:t[3]||(t[3]=e=>Ga("userlist"))},null,8,["disabled"])]),n("div",Se,[n("div",Ve,[V(m,{label:"Coupon code *"},{default:S((()=>[V(c,null,{default:S((()=>[V(se,{modelValue:Ba.couponCode,"onUpdate:modelValue":t[4]||(t[4]=e=>Ba.couponCode=e),modelModifiers:{trim:!0},placeholder:"e.g., SUMMER20",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"Type of discount *"},{default:S((()=>[V(c,null,{default:S((()=>[V(Va,{modelValue:Ba.isDiscountPourcentage,"onUpdate:modelValue":t[5]||(t[5]=e=>Ba.isDiscountPourcentage=e)},{default:S((()=>[V(ne,{value:!0},{default:S((()=>[d(" Percentage ")])),_:1}),V(ne,{value:!1},{default:S((()=>[d(" Amount ")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"Discount Value *"},{default:S((()=>[V(c,null,{default:S((()=>[V(se,{modelValue:Ba.discount,"onUpdate:modelValue":t[6]||(t[6]=e=>Ba.discount=e),modelModifiers:{number:!0},type:"number",placeholder:Ba.isDiscountPourcentage?"e.g., 10":"e.g., 5.00",min:"0.01",step:"any",required:""},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),V(m,{label:"Start date *"},{default:S((()=>[V(c,{icon:"lucide:calendar-days"},{default:S((()=>[V(se,{modelValue:Ba.startDate,"onUpdate:modelValue":t[7]||(t[7]=e=>Ba.startDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"End date *"},{default:S((()=>[V(c,{icon:"lucide:calendar-days"},{default:S((()=>[V(se,{modelValue:Ba.endDate,"onUpdate:modelValue":t[8]||(t[8]=e=>Ba.endDate=e),type:"date",required:""},null,8,["modelValue"])])),_:1})])),_:1})]),n("div",xe,[V(m,{label:"Description *"},{default:S((()=>[V(c,null,{default:S((()=>[V(Ia,{modelValue:Ba.description,"onUpdate:modelValue":t[9]||(t[9]=e=>Ba.description=e),modelModifiers:{trim:!0},placeholder:"Brief description...",rows:"4",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"Max uses per user *"},{default:S((()=>[V(c,{icon:"lucide:user-check"},{default:S((()=>[V(se,{modelValue:Ba.maxNumberOfUsePerUser,"onUpdate:modelValue":t[10]||(t[10]=e=>Ba.maxNumberOfUsePerUser=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 1",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"Max total uses *"},{default:S((()=>[V(c,{icon:"lucide:tag"},{default:S((()=>[V(se,{modelValue:Ba.maxNumberOfUse,"onUpdate:modelValue":t[11]||(t[11]=e=>Ba.maxNumberOfUse=e),modelModifiers:{number:!0},type:"number",placeholder:"e.g., 100",min:"1",step:"1",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V(m,{label:"Applies To"},{default:S((()=>[V(c,null,{default:S((()=>[V(Wa,{modelValue:Ba.isForEverybody,"onUpdate:modelValue":t[12]||(t[12]=e=>Ba.isForEverybody=e),label:"Apply to all users",color:"primary"},null,8,["modelValue"])])),_:1})])),_:1})])])],512),[[N,"index"===te.value]]),h(n("div",null,[n("div",De,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[13]||(t[13]=e=>Ga("index"))}),Pe,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[14]||(t[14]=e=>Ga("driverlist"))})]),n("div",Ne,[n("div",Ue,[n("div",Le,[Ae,V(m,{class:"mb-3",style:{width:"100%"}},{default:S((()=>[V(c,{icon:"feather:search"},{default:S((()=>[V(se,{modelValue:xa.value,"onUpdate:modelValue":t[15]||(t[15]=e=>xa.value=e),placeholder:"Search by name or email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:U({display:xa.value.length>0?"block":"none"})},[Sa.value?(o(),i("div",Me," Loading... ")):0===Ea.value.length?(o(),i("div",Be,' No passengers found matching "'+v(xa.value)+'". ',1)):u("",!0),xa.value.length>0?(o(!0),i(D,{key:2},x(Ea.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.id)try{const a=Ua.value.some((a=>a.userId===e.id));if(xa.value="",a)return void p.info(`${e.userDetail?.firstName??"User"} is already selected.`);const l={id:e.id,userId:e.userDetail?.userId,firstName:e.userDetail?.firstName??"",lastName:e.userDetail?.lastName??"",email:e.email??"",phoneNumber:e.phoneNumber??"",couponCode:Ba.couponCode,discount:Ba.discount,maxPersonalUseNumber:Ba.maxNumberOfUsePerUser,currentPersonalUsesNumber:0,couponStartDate:Ba.startDate,couponEndDate:Ba.endDate,couponId:r};Ua.value.push(l)}catch(a){p.error("An error occurred while selecting the user."),console.error("Error in selectUser:",a)}else p.error("Cannot select invalid user data.")})(e)},[n("li",null,[d(v(e.userDetail?.firstName)+" "+v(e.userDetail?.lastName)+" ",1),n("span",Te,"("+v(e.email)+")",1)])],8,Ee)))),128)):Sa.value?u("",!0):(o(),i("div",Oe," Start typing to search for passengers. "))],4)])]),n("div",je,[n("div",Fe,[n("p",null,"Passengers Selected ("+v(Ua.value.length)+"):",1),n("div",Ie,[0===Ua.value.length?(o(),i("div",Re," Click passengers on the left to select. ")):u("",!0),(o(!0),i(D,null,x(Ua.value,(e=>(o(),w(Qa,{key:e.userId,title:e.email,white:"",icon:"fas fa-user",onClick:a=>{var l;(l=e.userId)&&(Ua.value=Ua.value.filter((e=>e.userId!==l)),p.info("User removed from selection."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[N,"userlist"===te.value]]),h(n("div",null,[n("div",$e,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[16]||(t[16]=e=>Ga("userlist"))}),Ge,V(Q,{icon:"lucide:move-right",circle:"",onClick:t[17]||(t[17]=e=>Ga("triplist"))})]),n("div",We,[n("div",ze,[n("div",qe,[He,V(m,{class:"mb-3"},{default:S((()=>[V(c,{icon:"feather:search"},{default:S((()=>[V(se,{modelValue:Da.value,"onUpdate:modelValue":t[18]||(t[18]=e=>Da.value=e),placeholder:"Search by name or email..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:U({display:Da.value.length>0?"block":"none"})},[Sa.value?(o(),i("div",Je," Loading... ")):0===Ta.value.length?(o(),i("div",Ke,' No drivers found matching "'+v(Da.value)+'". ',1)):u("",!0),Da.value.length>0?(o(!0),i(D,{key:2},x(Ta.value,(e=>(o(),i("ul",{key:e.id,class:"list-item",onClick:a=>(e=>{if(e&&e.email)try{const a=e.email;if(La.value.includes(a))return void p.info(`${e.userDetail?.firstName??"Driver"} is already selected.`);La.value.push(a)}catch(a){p.error("An error occurred while selecting the driver."),console.error("Error in selectDriver:",a)}else p.error("Cannot select invalid driver data (missing email).")})(e)},[n("li",null,[d(v(e.userDetail?.firstName)+" "+v(e.userDetail?.lastName)+" ",1),n("span",Ye,"("+v(e.email)+")",1)])],8,Qe)))),128)):Sa.value?u("",!0):(o(),i("div",Ze," Start typing to search for passengers. "))],4)])]),n("div",Xe,[n("div",ea,[n("p",null,"Drivers Selected ("+v(La.value.length)+"):",1),n("div",aa,[0===La.value.length?(o(),i("div",la," Click drivers on the left to select. ")):u("",!0),(o(!0),i(D,null,x(La.value,((e,a)=>(o(),w(Qa,{key:a,title:e,white:"",icon:"fas fa-user",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(La.value=La.value.filter((e=>e!==l)),p.info("Driver removed from selection."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])],512),[[N,"driverlist"===te.value]]),h(n("div",null,[n("div",ta,[V(Q,{icon:"lucide:move-left",circle:"",onClick:t[19]||(t[19]=e=>Ga("driverlist"))}),oa,ia]),n("div",sa,[n("div",ra,[n("div",na,[ua,V(m,{class:"mb-3"},{default:S((()=>[V(c,{icon:"feather:search"},{default:S((()=>[V(se,{modelValue:Pa.value,"onUpdate:modelValue":t[20]||(t[20]=e=>Pa.value=e),placeholder:"Search departure..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:U({display:Pa.value.length>0?"block":"none"})},[0===ja.value.length?(o(),i("div",ca,' No locations found matching "'+v(Pa.value)+'". ',1)):u("",!0),Pa.value.length>0?(o(!0),i(D,{key:1},x(ja.value,(e=>(o(),i("ul",{key:`dep-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(Aa.value.length>=1?p.info("Only one town can be added"):Aa.value.includes(l)?p.info(`${l} is already selected for departure.`):Aa.value.push(l))}},[n("li",null,v(e),1)],8,da)))),128)):u("",!0)],4),n("div",va,[n("p",null,"Selected Departures ("+v(Aa.value.length)+"):",1),n("div",ma,[0===Aa.value.length?(o(),i("div",pa," Click locations above to select. ")):u("",!0),(o(!0),i(D,null,x(Aa.value,(e=>(o(),w(Qa,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Aa.value=Aa.value.filter((e=>e!==l)),p.info("Departure location removed."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])]),n("div",fa,[n("div",ha,[ya,V(m,{class:"mb-3"},{default:S((()=>[V(c,{icon:"feather:search"},{default:S((()=>[V(se,{modelValue:Na.value,"onUpdate:modelValue":t[21]||(t[21]=e=>Na.value=e),placeholder:"Search destination..."},null,8,["modelValue"])])),_:1})])),_:1}),n("div",{class:"userlist scrollable-list",style:U({display:Na.value.length>0?"block":"none"})},[0===Fa.value.length?(o(),i("div",ga,' No locations found matching "'+v(Na.value)+'". ',1)):u("",!0),Na.value.length>0?(o(!0),i(D,{key:1},x(Fa.value,(e=>(o(),i("ul",{key:`dest-${e}`,class:"list-item",onClick:a=>{var l;(l=e)&&(Ma.value.length>=1?p.info("Only one town can be added"):Ma.value.includes(l)?p.info(`${l} is already selected for destination.`):Ma.value.push(l))}},[n("li",null,v(e),1)],8,_a)))),128)):u("",!0)],4),n("div",ba,[n("p",null,"Selected Destinations ("+v(Ma.value.length)+"):",1),n("div",Ca,[0===Ma.value.length?(o(),i("div",ka," Click locations above to select. ")):u("",!0),(o(!0),i(D,null,x(Ma.value,(e=>(o(),w(Qa,{key:`sel-dep-${e}`,title:e,white:"",icon:"fas fa-location-arrow",class:"font-size:6px",onClick:a=>{var l;(l=e)&&(Ma.value=Ma.value.filter((e=>e!==l)),p.info("Destination location removed."))}},{default:S((()=>[V(qa,{icon:"lucide:x"})])),_:2},1032,["title","onClick"])))),128))])])])])]),wa],512),[[N,"triplist"===te.value]])])],32)])),_:1},8,["active"])])),action:S((()=>[Ba.isForEverybody||"triplist"===te.value?(o(),w(f,{key:0,color:"primary",raised:"",loading:ae.value,disabled:ae.value||Sa.value,onClick:za},{default:S((()=>[d(" Create Coupon ")])),_:1},8,["loading","disabled"])):u("",!0)])),_:1},8,["open"])])),_:1},8,["active"])}}});"function"==typeof X&&X(Sa);export{Sa as default};
